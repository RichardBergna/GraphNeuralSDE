[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.4
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 10.871038, Loss 2.066130, forward nfe 76, backward nfe 0, Train: 0.3429, Val: 0.2015, Test: 0.2365, Best time: 1.0000
Epoch: 002, Runtime 9.760396, Loss 2.241835, forward nfe 372, backward nfe 0, Train: 0.5214, Val: 0.4757, Test: 0.5005, Best time: 1.0000
Epoch: 003, Runtime 9.529906, Loss 2.083012, forward nfe 668, backward nfe 0, Train: 0.5214, Val: 0.5265, Test: 0.5452, Best time: 2.0000
Epoch: 004, Runtime 9.270713, Loss 2.040838, forward nfe 964, backward nfe 0, Train: 0.5643, Val: 0.5559, Test: 0.5614, Best time: 1.0000
Epoch: 005, Runtime 9.339592, Loss 1.951375, forward nfe 1260, backward nfe 0, Train: 0.7286, Val: 0.6228, Test: 0.6355, Best time: 1.0000
Epoch: 006, Runtime 9.705462, Loss 2.046372, forward nfe 1556, backward nfe 0, Train: 0.7214, Val: 0.6647, Test: 0.6690, Best time: 4.0000
Epoch: 007, Runtime 9.572213, Loss 2.034180, forward nfe 1852, backward nfe 0, Train: 0.7214, Val: 0.6647, Test: 0.6690, Best time: 18.2948
Epoch: 008, Runtime 10.694454, Loss 1.930432, forward nfe 2148, backward nfe 0, Train: 0.7214, Val: 0.6647, Test: 0.6690, Best time: 18.2948
Epoch: 009, Runtime 10.570394, Loss 1.854892, forward nfe 2444, backward nfe 0, Train: 0.7214, Val: 0.6647, Test: 0.6690, Best time: 18.2948
Epoch: 010, Runtime 11.207085, Loss 1.713560, forward nfe 2740, backward nfe 0, Train: 0.7214, Val: 0.6647, Test: 0.6690, Best time: 18.2948
Epoch: 011, Runtime 11.808913, Loss 1.561211, forward nfe 3036, backward nfe 0, Train: 0.7857, Val: 0.6949, Test: 0.6995, Best time: 14.0000
Epoch: 012, Runtime 11.052865, Loss 1.465313, forward nfe 3332, backward nfe 0, Train: 0.8643, Val: 0.7522, Test: 0.7452, Best time: 9.0000
Epoch: 013, Runtime 10.997092, Loss 1.290052, forward nfe 3628, backward nfe 0, Train: 0.8714, Val: 0.7566, Test: 0.7645, Best time: 13.0000
Epoch: 014, Runtime 10.916516, Loss 1.206990, forward nfe 3924, backward nfe 0, Train: 0.8714, Val: 0.7566, Test: 0.7645, Best time: 18.2948
Epoch: 015, Runtime 11.319341, Loss 1.130970, forward nfe 4220, backward nfe 0, Train: 0.8714, Val: 0.7566, Test: 0.7645, Best time: 18.2948
Epoch: 016, Runtime 11.306298, Loss 1.005441, forward nfe 4516, backward nfe 0, Train: 0.8714, Val: 0.7566, Test: 0.7645, Best time: 18.2948
Epoch: 017, Runtime 11.346687, Loss 0.925415, forward nfe 4812, backward nfe 0, Train: 0.8714, Val: 0.7566, Test: 0.7645, Best time: 18.2948
Epoch: 018, Runtime 11.968668, Loss 0.894282, forward nfe 5108, backward nfe 0, Train: 0.9071, Val: 0.7603, Test: 0.7665, Best time: 19.0000
Epoch: 019, Runtime 11.016319, Loss 0.790775, forward nfe 5404, backward nfe 0, Train: 0.9286, Val: 0.7676, Test: 0.7736, Best time: 12.0000
Epoch: 020, Runtime 10.918782, Loss 0.713297, forward nfe 5700, backward nfe 0, Train: 0.9286, Val: 0.7676, Test: 0.7736, Best time: 18.2948
Epoch: 021, Runtime 11.524250, Loss 0.659608, forward nfe 5996, backward nfe 0, Train: 0.9357, Val: 0.7757, Test: 0.7838, Best time: 36.0000
Epoch: 022, Runtime 11.015604, Loss 0.555173, forward nfe 6292, backward nfe 0, Train: 0.9357, Val: 0.7779, Test: 0.7888, Best time: 34.0000
Epoch: 023, Runtime 10.885739, Loss 0.613757, forward nfe 6588, backward nfe 0, Train: 0.9429, Val: 0.7809, Test: 0.7970, Best time: 18.2948
Epoch: 024, Runtime 10.705420, Loss 0.525820, forward nfe 6884, backward nfe 0, Train: 0.9429, Val: 0.7809, Test: 0.7970, Best time: 18.2948
Epoch: 025, Runtime 11.221852, Loss 0.495101, forward nfe 7180, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 026, Runtime 10.711108, Loss 0.488648, forward nfe 7476, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 027, Runtime 11.108945, Loss 0.401200, forward nfe 7772, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 028, Runtime 11.076433, Loss 0.497583, forward nfe 8068, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 029, Runtime 11.071991, Loss 0.420896, forward nfe 8364, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 030, Runtime 11.259748, Loss 0.445730, forward nfe 8660, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 031, Runtime 10.826348, Loss 0.440222, forward nfe 8956, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 032, Runtime 10.973163, Loss 0.471468, forward nfe 9252, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 033, Runtime 11.019431, Loss 0.362289, forward nfe 9548, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 034, Runtime 11.001882, Loss 0.490695, forward nfe 9844, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 035, Runtime 11.025875, Loss 0.424135, forward nfe 10140, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 036, Runtime 11.297955, Loss 0.325089, forward nfe 10436, backward nfe 0, Train: 0.9357, Val: 0.7875, Test: 0.7970, Best time: 18.2948
Epoch: 037, Runtime 11.893190, Loss 0.423006, forward nfe 10732, backward nfe 0, Train: 0.9786, Val: 0.7890, Test: 0.7980, Best time: 35.0000
Epoch: 038, Runtime 11.333891, Loss 0.306726, forward nfe 11028, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 48.0000
Epoch: 039, Runtime 11.182837, Loss 0.391304, forward nfe 11324, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 040, Runtime 11.587434, Loss 0.379006, forward nfe 11620, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 041, Runtime 11.522129, Loss 0.342489, forward nfe 11916, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 042, Runtime 11.590168, Loss 0.310143, forward nfe 12212, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 043, Runtime 12.021950, Loss 0.283264, forward nfe 12508, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 044, Runtime 11.907241, Loss 0.332538, forward nfe 12804, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 045, Runtime 12.042223, Loss 0.279399, forward nfe 13100, backward nfe 0, Train: 0.9857, Val: 0.7941, Test: 0.8030, Best time: 18.2948
Epoch: 046, Runtime 12.455462, Loss 0.301251, forward nfe 13396, backward nfe 0, Train: 0.9929, Val: 0.8044, Test: 0.8132, Best time: 54.8843
Epoch: 047, Runtime 11.298368, Loss 0.255382, forward nfe 13692, backward nfe 0, Train: 0.9929, Val: 0.8074, Test: 0.8091, Best time: 54.0000
Epoch: 048, Runtime 11.096679, Loss 0.279152, forward nfe 13988, backward nfe 0, Train: 0.9929, Val: 0.8074, Test: 0.8091, Best time: 18.2948
Epoch: 049, Runtime 11.479132, Loss 0.319940, forward nfe 14284, backward nfe 0, Train: 0.9929, Val: 0.8074, Test: 0.8091, Best time: 18.2948
Epoch: 050, Runtime 11.488018, Loss 0.295860, forward nfe 14580, backward nfe 0, Train: 0.9929, Val: 0.8074, Test: 0.8091, Best time: 18.2948
Epoch: 051, Runtime 11.543885, Loss 0.242167, forward nfe 14876, backward nfe 0, Train: 0.9929, Val: 0.8074, Test: 0.8091, Best time: 18.2948
Epoch: 052, Runtime 11.914098, Loss 0.309651, forward nfe 15172, backward nfe 0, Train: 0.9929, Val: 0.8074, Test: 0.8091, Best time: 18.2948
Epoch: 053, Runtime 12.087264, Loss 0.216185, forward nfe 15468, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 54.0000
Epoch: 054, Runtime 11.138099, Loss 0.348199, forward nfe 15764, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 055, Runtime 11.551220, Loss 0.200356, forward nfe 16060, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 056, Runtime 11.579805, Loss 0.247669, forward nfe 16356, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 057, Runtime 11.562312, Loss 0.277190, forward nfe 16652, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 058, Runtime 11.992602, Loss 0.283310, forward nfe 16948, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 059, Runtime 11.900329, Loss 0.214203, forward nfe 17244, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 060, Runtime 11.940774, Loss 0.374771, forward nfe 17540, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 061, Runtime 12.228264, Loss 0.295749, forward nfe 17836, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 062, Runtime 12.138850, Loss 0.268602, forward nfe 18132, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 063, Runtime 12.252661, Loss 0.247140, forward nfe 18428, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 064, Runtime 12.611211, Loss 0.232126, forward nfe 18724, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 065, Runtime 12.551296, Loss 0.226742, forward nfe 19020, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 066, Runtime 12.522122, Loss 0.191561, forward nfe 19316, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 067, Runtime 12.831288, Loss 0.359907, forward nfe 19612, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 068, Runtime 12.864067, Loss 0.222549, forward nfe 19908, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 069, Runtime 12.770472, Loss 0.235999, forward nfe 20204, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 070, Runtime 13.052844, Loss 0.237753, forward nfe 20500, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 071, Runtime 12.976064, Loss 0.252610, forward nfe 20796, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 072, Runtime 12.354044, Loss 0.202578, forward nfe 21092, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 073, Runtime 12.419483, Loss 0.281286, forward nfe 21388, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 074, Runtime 12.322797, Loss 0.276594, forward nfe 21684, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 075, Runtime 12.333375, Loss 0.229418, forward nfe 21980, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 076, Runtime 12.536095, Loss 0.174754, forward nfe 22276, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 077, Runtime 12.460928, Loss 0.256800, forward nfe 22572, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 078, Runtime 12.542857, Loss 0.208797, forward nfe 22868, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 079, Runtime 12.545597, Loss 0.184026, forward nfe 23164, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 080, Runtime 12.270536, Loss 0.166002, forward nfe 23460, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 081, Runtime 12.100784, Loss 0.208171, forward nfe 23756, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 082, Runtime 12.178435, Loss 0.330951, forward nfe 24052, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 083, Runtime 12.278367, Loss 0.229844, forward nfe 24348, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 084, Runtime 12.003843, Loss 0.180213, forward nfe 24644, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 085, Runtime 11.470884, Loss 0.198284, forward nfe 24940, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 086, Runtime 11.000354, Loss 0.244778, forward nfe 25236, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 087, Runtime 10.939572, Loss 0.254014, forward nfe 25532, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 088, Runtime 11.106909, Loss 0.209760, forward nfe 25828, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 089, Runtime 12.261524, Loss 0.232964, forward nfe 26124, backward nfe 0, Train: 0.9714, Val: 0.8147, Test: 0.8213, Best time: 18.2948
Epoch: 090, Runtime 12.596165, Loss 0.311155, forward nfe 26420, backward nfe 0, Train: 0.9786, Val: 0.8154, Test: 0.8447, Best time: 54.8843
Epoch: 091, Runtime 10.053426, Loss 0.234563, forward nfe 26716, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 54.0000
Epoch: 092, Runtime 9.918086, Loss 0.255412, forward nfe 27012, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 093, Runtime 10.297957, Loss 0.189084, forward nfe 27308, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 094, Runtime 10.182879, Loss 0.198671, forward nfe 27604, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 095, Runtime 10.279413, Loss 0.161913, forward nfe 27900, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 096, Runtime 10.629334, Loss 0.231744, forward nfe 28196, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 097, Runtime 10.521946, Loss 0.215007, forward nfe 28492, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 098, Runtime 10.579051, Loss 0.216861, forward nfe 28788, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
Epoch: 099, Runtime 10.896980, Loss 0.149229, forward nfe 29084, backward nfe 0, Train: 0.9929, Val: 0.8206, Test: 0.8528, Best time: 18.2948
best val accuracy 0.820588 with test accuracy 0.852792 at epoch 91 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8507614213197969
Entropy Threshold: 2 Test accuracy: 0.8619289340101522
Entropy Threshold: 1.6 Test accuracy: 0.8609406952965235
Entropy Threshold: 1.5 Test accuracy: 0.8635897435897436
Entropy Threshold: 1.4 Test accuracy: 0.8686131386861314
Entropy Threshold: 1.3 Test accuracy: 0.8771186440677966
Entropy Threshold: 1.2 Test accuracy: 0.8794402583423035
Entropy Threshold: 1.1 Test accuracy: 0.8851203501094091
Entropy Threshold: 0.9 Test accuracy: 0.9016203703703703
Entropy Threshold: 0.8 Test accuracy: 0.9021479713603818
Entropy Threshold: 0.7 Test accuracy: 0.9105590062111801
Entropy Threshold: 0.6 Test accuracy: 0.925974025974026
Entropy Threshold: 0.5 Test accuracy: 0.9198369565217391
Entropy Threshold: 0.4 Test accuracy: 0.9274537695590327
Entropy Threshold: 0.3 Test accuracy: 0.9354354354354354
Entropy Threshold: 0.2 Test accuracy: 0.9437299035369775
Entropy Threshold: 0.1 Test accuracy: 0.9594843462246777
