[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.6
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.092255, Loss 2.088760, forward nfe 76, backward nfe 0, Train: 0.4286, Val: 0.4412, Test: 0.3878, Best time: 1.0000
Epoch: 002, Runtime 9.995130, Loss 2.771420, forward nfe 372, backward nfe 0, Train: 0.7571, Val: 0.6676, Test: 0.6142, Best time: 1.0000
Epoch: 003, Runtime 9.862080, Loss 2.236875, forward nfe 668, backward nfe 0, Train: 0.7571, Val: 0.6676, Test: 0.6142, Best time: 18.2948
Epoch: 004, Runtime 10.271938, Loss 2.202988, forward nfe 964, backward nfe 0, Train: 0.7571, Val: 0.6676, Test: 0.6142, Best time: 18.2948
Epoch: 005, Runtime 10.342426, Loss 2.066791, forward nfe 1260, backward nfe 0, Train: 0.7714, Val: 0.6713, Test: 0.6426, Best time: 6.0000
Epoch: 006, Runtime 10.781189, Loss 2.086022, forward nfe 1556, backward nfe 0, Train: 0.8143, Val: 0.7559, Test: 0.7269, Best time: 6.0000
Epoch: 007, Runtime 10.766180, Loss 2.026666, forward nfe 1852, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 5.0000
Epoch: 008, Runtime 11.034324, Loss 1.874460, forward nfe 2148, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 009, Runtime 11.654622, Loss 1.887705, forward nfe 2444, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 010, Runtime 11.698389, Loss 1.685268, forward nfe 2740, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 011, Runtime 11.681384, Loss 1.551335, forward nfe 3036, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 012, Runtime 12.140262, Loss 1.449888, forward nfe 3332, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 013, Runtime 12.045269, Loss 1.256613, forward nfe 3628, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 014, Runtime 12.085443, Loss 1.178722, forward nfe 3924, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 015, Runtime 12.505803, Loss 1.152601, forward nfe 4220, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 016, Runtime 12.428864, Loss 1.012280, forward nfe 4516, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 017, Runtime 12.444118, Loss 0.880215, forward nfe 4812, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 018, Runtime 12.743480, Loss 0.914700, forward nfe 5108, backward nfe 0, Train: 0.8500, Val: 0.7794, Test: 0.7462, Best time: 18.2948
Epoch: 019, Runtime 12.860541, Loss 0.860507, forward nfe 5404, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 020, Runtime 11.333261, Loss 0.774929, forward nfe 5700, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 021, Runtime 11.651913, Loss 0.771663, forward nfe 5996, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 022, Runtime 11.622286, Loss 0.748181, forward nfe 6292, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 023, Runtime 11.683500, Loss 0.636407, forward nfe 6588, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 024, Runtime 12.109706, Loss 0.629330, forward nfe 6884, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 025, Runtime 12.125344, Loss 0.548496, forward nfe 7180, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 026, Runtime 12.141415, Loss 0.549360, forward nfe 7476, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 027, Runtime 12.537382, Loss 0.456038, forward nfe 7772, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 028, Runtime 12.402417, Loss 0.583074, forward nfe 8068, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 029, Runtime 12.506288, Loss 0.412477, forward nfe 8364, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7777, Best time: 18.2948
Epoch: 030, Runtime 12.876248, Loss 0.466820, forward nfe 8660, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 031, Runtime 11.331133, Loss 0.423064, forward nfe 8956, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 032, Runtime 11.661686, Loss 0.475689, forward nfe 9252, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 033, Runtime 11.611094, Loss 0.414869, forward nfe 9548, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 034, Runtime 11.676004, Loss 0.451707, forward nfe 9844, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 035, Runtime 12.023910, Loss 0.450434, forward nfe 10140, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 036, Runtime 11.946426, Loss 0.524434, forward nfe 10436, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 037, Runtime 11.869815, Loss 0.488136, forward nfe 10732, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 038, Runtime 12.240264, Loss 0.455744, forward nfe 11028, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 039, Runtime 12.089217, Loss 0.473266, forward nfe 11324, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 040, Runtime 12.256590, Loss 0.436731, forward nfe 11620, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 041, Runtime 12.358596, Loss 0.388972, forward nfe 11916, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7848, Best time: 18.2948
Epoch: 042, Runtime 12.313800, Loss 0.397443, forward nfe 12212, backward nfe 0, Train: 0.9286, Val: 0.8096, Test: 0.7939, Best time: 18.2948
Epoch: 043, Runtime 10.601187, Loss 0.289765, forward nfe 12508, backward nfe 0, Train: 0.9286, Val: 0.8096, Test: 0.7939, Best time: 18.2948
Epoch: 044, Runtime 10.934584, Loss 0.365647, forward nfe 12804, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 045, Runtime 10.148308, Loss 0.404253, forward nfe 13100, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 046, Runtime 10.477215, Loss 0.389933, forward nfe 13396, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 047, Runtime 10.446770, Loss 0.371160, forward nfe 13692, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 048, Runtime 10.418753, Loss 0.530476, forward nfe 13988, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 049, Runtime 10.882932, Loss 0.356990, forward nfe 14284, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 050, Runtime 10.831725, Loss 0.353870, forward nfe 14580, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 051, Runtime 10.872830, Loss 0.288417, forward nfe 14876, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 052, Runtime 11.209337, Loss 0.369350, forward nfe 15172, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 053, Runtime 11.207792, Loss 0.311650, forward nfe 15468, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 054, Runtime 11.981330, Loss 0.256557, forward nfe 15764, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 055, Runtime 12.744864, Loss 0.288055, forward nfe 16060, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 056, Runtime 12.743414, Loss 0.307732, forward nfe 16356, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 057, Runtime 12.774920, Loss 0.298336, forward nfe 16652, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 058, Runtime 13.067978, Loss 0.330396, forward nfe 16948, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 059, Runtime 12.973859, Loss 0.294447, forward nfe 17244, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 060, Runtime 13.008272, Loss 0.249666, forward nfe 17540, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 061, Runtime 13.234953, Loss 0.242492, forward nfe 17836, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 062, Runtime 13.234583, Loss 0.268069, forward nfe 18132, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 063, Runtime 13.312917, Loss 0.265656, forward nfe 18428, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 064, Runtime 13.389879, Loss 0.272967, forward nfe 18724, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 065, Runtime 13.516547, Loss 0.224857, forward nfe 19020, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 066, Runtime 13.440696, Loss 0.318765, forward nfe 19316, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 067, Runtime 13.676256, Loss 0.289323, forward nfe 19612, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 068, Runtime 13.650453, Loss 0.274751, forward nfe 19908, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 069, Runtime 13.600635, Loss 0.218899, forward nfe 20204, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 070, Runtime 13.337188, Loss 0.334867, forward nfe 20500, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 071, Runtime 12.203961, Loss 0.306957, forward nfe 20796, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 072, Runtime 12.022151, Loss 0.238645, forward nfe 21092, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 073, Runtime 12.171929, Loss 0.233491, forward nfe 21388, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 074, Runtime 12.020088, Loss 0.310465, forward nfe 21684, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 075, Runtime 12.000853, Loss 0.256346, forward nfe 21980, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 076, Runtime 12.122267, Loss 0.222641, forward nfe 22276, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 077, Runtime 12.206176, Loss 0.244366, forward nfe 22572, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 078, Runtime 12.173182, Loss 0.254157, forward nfe 22868, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 079, Runtime 12.272114, Loss 0.224838, forward nfe 23164, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 080, Runtime 12.375451, Loss 0.230093, forward nfe 23460, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 081, Runtime 12.258499, Loss 0.253607, forward nfe 23756, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 082, Runtime 12.400812, Loss 0.239001, forward nfe 24052, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 083, Runtime 12.336385, Loss 0.273457, forward nfe 24348, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 084, Runtime 12.158573, Loss 0.175540, forward nfe 24644, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 085, Runtime 11.549830, Loss 0.203815, forward nfe 24940, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 086, Runtime 11.984365, Loss 0.280390, forward nfe 25236, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 087, Runtime 12.271563, Loss 0.272874, forward nfe 25532, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 088, Runtime 12.513536, Loss 0.283876, forward nfe 25828, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 089, Runtime 12.230067, Loss 0.216342, forward nfe 26124, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 090, Runtime 12.898671, Loss 0.218338, forward nfe 26420, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 091, Runtime 13.268395, Loss 0.222986, forward nfe 26716, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 092, Runtime 13.214806, Loss 0.248477, forward nfe 27012, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 093, Runtime 13.134734, Loss 0.162203, forward nfe 27308, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 094, Runtime 12.965829, Loss 0.114667, forward nfe 27604, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 095, Runtime 12.752781, Loss 0.237499, forward nfe 27900, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 096, Runtime 12.453946, Loss 0.276605, forward nfe 28196, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 097, Runtime 12.484092, Loss 0.201724, forward nfe 28492, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 098, Runtime 12.462201, Loss 0.282086, forward nfe 28788, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
Epoch: 099, Runtime 12.524610, Loss 0.190950, forward nfe 29084, backward nfe 0, Train: 0.9714, Val: 0.8140, Test: 0.8020, Best time: 18.2948
best val accuracy 0.813971 with test accuracy 0.802030 at epoch 44 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.817258883248731
Entropy Threshold: 2 Test accuracy: 0.8233502538071066
Entropy Threshold: 1.6 Test accuracy: 0.8194014447884417
Entropy Threshold: 1.5 Test accuracy: 0.8373557187827911
Entropy Threshold: 1.4 Test accuracy: 0.8397435897435898
Entropy Threshold: 1.3 Test accuracy: 0.8453947368421053
Entropy Threshold: 1.2 Test accuracy: 0.8617977528089887
Entropy Threshold: 1.1 Test accuracy: 0.8672150411280846
Entropy Threshold: 0.9 Test accuracy: 0.8852459016393442
Entropy Threshold: 0.8 Test accuracy: 0.8992042440318302
Entropy Threshold: 0.7 Test accuracy: 0.9081920903954802
Entropy Threshold: 0.6 Test accuracy: 0.9164133738601824
Entropy Threshold: 0.5 Test accuracy: 0.9243156199677939
Entropy Threshold: 0.4 Test accuracy: 0.9420035149384886
Entropy Threshold: 0.3 Test accuracy: 0.9473684210526315
Entropy Threshold: 0.2 Test accuracy: 0.9652173913043478
Entropy Threshold: 0.1 Test accuracy: 0.9665809768637532
