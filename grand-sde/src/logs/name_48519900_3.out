[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.5
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 19.852663, Loss 2.072901, forward nfe 76, backward nfe 0, Train: 0.6571, Val: 0.5301, Test: 0.5076, Best time: 2.0000
Epoch: 002, Runtime 20.873106, Loss 2.023430, forward nfe 372, backward nfe 0, Train: 0.7286, Val: 0.6581, Test: 0.6518, Best time: 3.0000
Epoch: 003, Runtime 19.363754, Loss 1.895446, forward nfe 668, backward nfe 0, Train: 0.7286, Val: 0.6581, Test: 0.6518, Best time: 18.2948
Epoch: 004, Runtime 19.672766, Loss 1.734316, forward nfe 964, backward nfe 0, Train: 0.7286, Val: 0.6581, Test: 0.6518, Best time: 18.2948
Epoch: 005, Runtime 19.655941, Loss 1.614393, forward nfe 1260, backward nfe 0, Train: 0.8429, Val: 0.6801, Test: 0.6497, Best time: 7.0000
Epoch: 006, Runtime 19.120714, Loss 1.440425, forward nfe 1556, backward nfe 0, Train: 0.9143, Val: 0.7721, Test: 0.7533, Best time: 10.0000
Epoch: 007, Runtime 19.074959, Loss 1.190937, forward nfe 1852, backward nfe 0, Train: 0.9286, Val: 0.8074, Test: 0.7827, Best time: 6.0000
Epoch: 008, Runtime 18.762521, Loss 0.979649, forward nfe 2148, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 12.0000
Epoch: 009, Runtime 18.715746, Loss 0.825097, forward nfe 2444, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 010, Runtime 19.508429, Loss 0.671850, forward nfe 2740, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 011, Runtime 19.375736, Loss 0.520079, forward nfe 3036, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 012, Runtime 19.925571, Loss 0.476713, forward nfe 3332, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 013, Runtime 20.727091, Loss 0.415404, forward nfe 3628, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 014, Runtime 21.267109, Loss 0.383373, forward nfe 3924, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 015, Runtime 21.394712, Loss 0.321976, forward nfe 4220, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 016, Runtime 22.203767, Loss 0.354310, forward nfe 4516, backward nfe 0, Train: 0.9143, Val: 0.8147, Test: 0.7817, Best time: 18.2948
Epoch: 017, Runtime 21.487224, Loss 0.321716, forward nfe 4812, backward nfe 0, Train: 0.9571, Val: 0.8154, Test: 0.8091, Best time: 36.0000
Epoch: 018, Runtime 19.158494, Loss 0.327443, forward nfe 5108, backward nfe 0, Train: 0.9500, Val: 0.8176, Test: 0.8203, Best time: 36.0000
Epoch: 019, Runtime 19.254137, Loss 0.325032, forward nfe 5404, backward nfe 0, Train: 0.9714, Val: 0.8184, Test: 0.8193, Best time: 41.0000
Epoch: 020, Runtime 18.520974, Loss 0.328164, forward nfe 5700, backward nfe 0, Train: 0.9643, Val: 0.8191, Test: 0.8254, Best time: 28.0000
Epoch: 021, Runtime 18.513847, Loss 0.329870, forward nfe 5996, backward nfe 0, Train: 0.9714, Val: 0.8228, Test: 0.8122, Best time: 12.0000
Epoch: 022, Runtime 18.469357, Loss 0.300871, forward nfe 6292, backward nfe 0, Train: 0.9500, Val: 0.8243, Test: 0.8183, Best time: 23.0000
Epoch: 023, Runtime 18.509370, Loss 0.319709, forward nfe 6588, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 23.0000
Epoch: 024, Runtime 18.244974, Loss 0.380955, forward nfe 6884, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 025, Runtime 18.869631, Loss 0.231044, forward nfe 7180, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 026, Runtime 18.726475, Loss 0.327768, forward nfe 7476, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 027, Runtime 18.846334, Loss 0.325892, forward nfe 7772, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 028, Runtime 19.605706, Loss 0.364966, forward nfe 8068, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 029, Runtime 19.407219, Loss 0.297084, forward nfe 8364, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 030, Runtime 19.684989, Loss 0.311498, forward nfe 8660, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 031, Runtime 20.462277, Loss 0.377608, forward nfe 8956, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 032, Runtime 20.137830, Loss 0.247625, forward nfe 9252, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 033, Runtime 20.377363, Loss 0.210947, forward nfe 9548, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 034, Runtime 20.825842, Loss 0.274280, forward nfe 9844, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 035, Runtime 20.720169, Loss 0.213980, forward nfe 10140, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 036, Runtime 20.752611, Loss 0.322648, forward nfe 10436, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 037, Runtime 21.237679, Loss 0.235825, forward nfe 10732, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 038, Runtime 21.190286, Loss 0.255825, forward nfe 11028, backward nfe 0, Train: 0.9571, Val: 0.8287, Test: 0.8213, Best time: 18.2948
Epoch: 039, Runtime 21.877025, Loss 0.276200, forward nfe 11324, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8193, Best time: 42.0000
Epoch: 040, Runtime 18.364411, Loss 0.252330, forward nfe 11620, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 33.0000
Epoch: 041, Runtime 18.170931, Loss 0.236498, forward nfe 11916, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 042, Runtime 18.942302, Loss 0.275030, forward nfe 12212, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 043, Runtime 18.751739, Loss 0.247221, forward nfe 12508, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 044, Runtime 18.607193, Loss 0.232296, forward nfe 12804, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 045, Runtime 19.437630, Loss 0.205213, forward nfe 13100, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 046, Runtime 19.168930, Loss 0.207371, forward nfe 13396, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 047, Runtime 19.456438, Loss 0.267978, forward nfe 13692, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 048, Runtime 20.190656, Loss 0.196939, forward nfe 13988, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 049, Runtime 20.043114, Loss 0.249172, forward nfe 14284, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 050, Runtime 20.013453, Loss 0.204352, forward nfe 14580, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 051, Runtime 20.805944, Loss 0.231836, forward nfe 14876, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 052, Runtime 20.546125, Loss 0.253826, forward nfe 15172, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 053, Runtime 20.558222, Loss 0.203026, forward nfe 15468, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 054, Runtime 21.212983, Loss 0.195533, forward nfe 15764, backward nfe 0, Train: 0.9857, Val: 0.8368, Test: 0.8335, Best time: 18.2948
Epoch: 055, Runtime 21.499199, Loss 0.251646, forward nfe 16060, backward nfe 0, Train: 0.9571, Val: 0.8382, Test: 0.8376, Best time: 52.0000
Epoch: 056, Runtime 17.948030, Loss 0.204173, forward nfe 16356, backward nfe 0, Train: 0.9571, Val: 0.8382, Test: 0.8376, Best time: 18.2948
Epoch: 057, Runtime 18.543612, Loss 0.176016, forward nfe 16652, backward nfe 0, Train: 0.9571, Val: 0.8382, Test: 0.8376, Best time: 18.2948
Epoch: 058, Runtime 18.423433, Loss 0.245563, forward nfe 16948, backward nfe 0, Train: 0.9571, Val: 0.8382, Test: 0.8376, Best time: 18.2948
Epoch: 059, Runtime 18.465944, Loss 0.162101, forward nfe 17244, backward nfe 0, Train: 0.9571, Val: 0.8382, Test: 0.8376, Best time: 18.2948
Epoch: 060, Runtime 19.439719, Loss 0.269388, forward nfe 17540, backward nfe 0, Train: 0.9571, Val: 0.8382, Test: 0.8376, Best time: 18.2948
Epoch: 061, Runtime 19.469546, Loss 0.238439, forward nfe 17836, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 28.0000
Epoch: 062, Runtime 17.837182, Loss 0.172031, forward nfe 18132, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 063, Runtime 18.586501, Loss 0.244172, forward nfe 18428, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 064, Runtime 18.497815, Loss 0.230923, forward nfe 18724, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 065, Runtime 18.409914, Loss 0.244965, forward nfe 19020, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 066, Runtime 18.443429, Loss 0.266618, forward nfe 19316, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 067, Runtime 15.547012, Loss 0.194385, forward nfe 19612, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 068, Runtime 14.063941, Loss 0.199867, forward nfe 19908, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 069, Runtime 14.509052, Loss 0.172435, forward nfe 20204, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 070, Runtime 14.700738, Loss 0.214488, forward nfe 20500, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 071, Runtime 14.594847, Loss 0.167612, forward nfe 20796, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 072, Runtime 15.087245, Loss 0.133819, forward nfe 21092, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 073, Runtime 15.042249, Loss 0.140581, forward nfe 21388, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 074, Runtime 14.953689, Loss 0.233405, forward nfe 21684, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 075, Runtime 15.512218, Loss 0.225789, forward nfe 21980, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 076, Runtime 15.913280, Loss 0.202843, forward nfe 22276, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 077, Runtime 16.071951, Loss 0.168277, forward nfe 22572, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 078, Runtime 16.704040, Loss 0.234432, forward nfe 22868, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 079, Runtime 16.422011, Loss 0.187525, forward nfe 23164, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 080, Runtime 16.517209, Loss 0.165018, forward nfe 23460, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 081, Runtime 16.792873, Loss 0.272733, forward nfe 23756, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 082, Runtime 16.919353, Loss 0.218040, forward nfe 24052, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 083, Runtime 16.873623, Loss 0.201476, forward nfe 24348, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 084, Runtime 16.992099, Loss 0.195098, forward nfe 24644, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 085, Runtime 17.063134, Loss 0.199982, forward nfe 24940, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 086, Runtime 16.932869, Loss 0.184325, forward nfe 25236, backward nfe 0, Train: 0.9857, Val: 0.8441, Test: 0.8376, Best time: 18.2948
Epoch: 087, Runtime 17.277044, Loss 0.183799, forward nfe 25532, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 48.0000
Epoch: 088, Runtime 14.041448, Loss 0.174699, forward nfe 25828, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 089, Runtime 14.388067, Loss 0.129265, forward nfe 26124, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 090, Runtime 14.477251, Loss 0.224248, forward nfe 26420, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 091, Runtime 14.586074, Loss 0.222578, forward nfe 26716, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 092, Runtime 15.523433, Loss 0.276038, forward nfe 27012, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 093, Runtime 16.526222, Loss 0.152552, forward nfe 27308, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 094, Runtime 17.204517, Loss 0.143658, forward nfe 27604, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 095, Runtime 17.813963, Loss 0.202525, forward nfe 27900, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 096, Runtime 17.611897, Loss 0.138906, forward nfe 28196, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 097, Runtime 17.707558, Loss 0.147707, forward nfe 28492, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 098, Runtime 17.997024, Loss 0.125468, forward nfe 28788, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
Epoch: 099, Runtime 18.216797, Loss 0.171542, forward nfe 29084, backward nfe 0, Train: 0.9714, Val: 0.8471, Test: 0.8365, Best time: 18.2948
best val accuracy 0.847059 with test accuracy 0.836548 at epoch 87 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8436548223350254
Entropy Threshold: 2 Test accuracy: 0.8467005076142132
Entropy Threshold: 1.6 Test accuracy: 0.8406091370558376
Entropy Threshold: 1.5 Test accuracy: 0.8428571428571429
Entropy Threshold: 1.4 Test accuracy: 0.8454452405322416
Entropy Threshold: 1.3 Test accuracy: 0.8490175801447777
Entropy Threshold: 1.2 Test accuracy: 0.8523908523908524
Entropy Threshold: 1.1 Test accuracy: 0.8568421052631578
Entropy Threshold: 0.9 Test accuracy: 0.865945945945946
Entropy Threshold: 0.8 Test accuracy: 0.8752759381898455
Entropy Threshold: 0.7 Test accuracy: 0.8844847112117781
Entropy Threshold: 0.6 Test accuracy: 0.9009433962264151
Entropy Threshold: 0.5 Test accuracy: 0.9092009685230025
Entropy Threshold: 0.4 Test accuracy: 0.9151061173533084
Entropy Threshold: 0.3 Test accuracy: 0.9254498714652957
Entropy Threshold: 0.2 Test accuracy: 0.9262295081967213
Entropy Threshold: 0.1 Test accuracy: 0.9441997063142438
