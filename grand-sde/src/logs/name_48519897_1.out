[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.01
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 5.231033, Loss 1.949844, forward nfe 76, backward nfe 0, Train: 0.8286, Val: 0.6654, Test: 0.6904, Best time: 5.0000
Epoch: 002, Runtime 4.540807, Loss 1.884447, forward nfe 372, backward nfe 0, Train: 0.8286, Val: 0.6654, Test: 0.6904, Best time: 18.2948
Epoch: 003, Runtime 4.835445, Loss 1.739937, forward nfe 668, backward nfe 0, Train: 0.8286, Val: 0.6654, Test: 0.6904, Best time: 18.2948
Epoch: 004, Runtime 5.209929, Loss 1.521149, forward nfe 964, backward nfe 0, Train: 0.8929, Val: 0.7360, Test: 0.7513, Best time: 14.0000
Epoch: 005, Runtime 5.204412, Loss 1.246365, forward nfe 1260, backward nfe 0, Train: 0.9357, Val: 0.7772, Test: 0.7970, Best time: 9.0000
Epoch: 006, Runtime 4.937491, Loss 0.927759, forward nfe 1556, backward nfe 0, Train: 0.9143, Val: 0.8088, Test: 0.8203, Best time: 49.0000
Epoch: 007, Runtime 4.966188, Loss 0.683531, forward nfe 1852, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 008, Runtime 4.860306, Loss 0.475809, forward nfe 2148, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 009, Runtime 4.903368, Loss 0.333796, forward nfe 2444, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 010, Runtime 4.778385, Loss 0.256878, forward nfe 2740, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 011, Runtime 4.956238, Loss 0.226014, forward nfe 3036, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 012, Runtime 5.067543, Loss 0.163715, forward nfe 3332, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 013, Runtime 5.021675, Loss 0.195767, forward nfe 3628, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8112, Best time: 18.2948
Epoch: 014, Runtime 5.194161, Loss 0.173379, forward nfe 3924, backward nfe 0, Train: 0.9643, Val: 0.8287, Test: 0.8112, Best time: 18.2948
Epoch: 015, Runtime 4.967541, Loss 0.155261, forward nfe 4220, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 42.0000
Epoch: 016, Runtime 4.860144, Loss 0.130650, forward nfe 4516, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 18.2948
Epoch: 017, Runtime 4.816848, Loss 0.135137, forward nfe 4812, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 18.2948
Epoch: 018, Runtime 4.897345, Loss 0.178240, forward nfe 5108, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 18.2948
Epoch: 019, Runtime 4.956292, Loss 0.196620, forward nfe 5404, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 18.2948
Epoch: 020, Runtime 5.044127, Loss 0.155088, forward nfe 5700, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 18.2948
Epoch: 021, Runtime 4.863102, Loss 0.176570, forward nfe 5996, backward nfe 0, Train: 0.9643, Val: 0.8316, Test: 0.8132, Best time: 18.2948
Epoch: 022, Runtime 5.152965, Loss 0.159605, forward nfe 6292, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 52.0000
Epoch: 023, Runtime 4.835164, Loss 0.196339, forward nfe 6588, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 024, Runtime 4.893177, Loss 0.158503, forward nfe 6884, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 025, Runtime 4.754476, Loss 0.164363, forward nfe 7180, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 026, Runtime 4.810562, Loss 0.186936, forward nfe 7476, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 027, Runtime 4.940767, Loss 0.171853, forward nfe 7772, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 028, Runtime 4.960319, Loss 0.178772, forward nfe 8068, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 029, Runtime 4.914551, Loss 0.107537, forward nfe 8364, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 030, Runtime 4.955732, Loss 0.206465, forward nfe 8660, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 031, Runtime 5.060394, Loss 0.155568, forward nfe 8956, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 032, Runtime 5.000905, Loss 0.134758, forward nfe 9252, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 033, Runtime 4.716070, Loss 0.195726, forward nfe 9548, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 034, Runtime 4.770252, Loss 0.115396, forward nfe 9844, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 035, Runtime 4.797322, Loss 0.170769, forward nfe 10140, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 036, Runtime 4.831993, Loss 0.114676, forward nfe 10436, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 037, Runtime 4.819556, Loss 0.117348, forward nfe 10732, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 038, Runtime 4.844022, Loss 0.137625, forward nfe 11028, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 039, Runtime 4.900367, Loss 0.099776, forward nfe 11324, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 040, Runtime 4.932556, Loss 0.160036, forward nfe 11620, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 041, Runtime 4.903784, Loss 0.110249, forward nfe 11916, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 042, Runtime 4.923948, Loss 0.116241, forward nfe 12212, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 043, Runtime 5.023300, Loss 0.112398, forward nfe 12508, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 044, Runtime 5.056782, Loss 0.122480, forward nfe 12804, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 045, Runtime 4.767045, Loss 0.116752, forward nfe 13100, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 046, Runtime 4.763500, Loss 0.086257, forward nfe 13396, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 047, Runtime 4.786520, Loss 0.150124, forward nfe 13692, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 048, Runtime 4.854954, Loss 0.128321, forward nfe 13988, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 049, Runtime 4.852150, Loss 0.131005, forward nfe 14284, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 050, Runtime 4.875937, Loss 0.107913, forward nfe 14580, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 051, Runtime 4.823453, Loss 0.083348, forward nfe 14876, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 052, Runtime 4.940768, Loss 0.140349, forward nfe 15172, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 053, Runtime 4.921856, Loss 0.107434, forward nfe 15468, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 054, Runtime 4.960531, Loss 0.130843, forward nfe 15764, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 055, Runtime 4.944284, Loss 0.110806, forward nfe 16060, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 056, Runtime 5.002617, Loss 0.102065, forward nfe 16356, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 057, Runtime 4.735635, Loss 0.098837, forward nfe 16652, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 058, Runtime 4.729683, Loss 0.122159, forward nfe 16948, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 059, Runtime 4.763446, Loss 0.091418, forward nfe 17244, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 060, Runtime 4.813191, Loss 0.107485, forward nfe 17540, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 061, Runtime 4.803547, Loss 0.103743, forward nfe 17836, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 062, Runtime 4.827689, Loss 0.107123, forward nfe 18132, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 063, Runtime 4.894911, Loss 0.126451, forward nfe 18428, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 064, Runtime 4.893362, Loss 0.082757, forward nfe 18724, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 065, Runtime 4.900438, Loss 0.145379, forward nfe 19020, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 066, Runtime 4.933663, Loss 0.113576, forward nfe 19316, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 067, Runtime 4.891994, Loss 0.094628, forward nfe 19612, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 068, Runtime 4.937097, Loss 0.097894, forward nfe 19908, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 069, Runtime 4.772382, Loss 0.134041, forward nfe 20204, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 070, Runtime 4.763081, Loss 0.088289, forward nfe 20500, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 071, Runtime 4.751807, Loss 0.101581, forward nfe 20796, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 072, Runtime 4.768060, Loss 0.157610, forward nfe 21092, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 073, Runtime 4.792867, Loss 0.124310, forward nfe 21388, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 074, Runtime 4.853279, Loss 0.133086, forward nfe 21684, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 075, Runtime 4.897949, Loss 0.090489, forward nfe 21980, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 076, Runtime 4.847752, Loss 0.128036, forward nfe 22276, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 077, Runtime 4.882555, Loss 0.115774, forward nfe 22572, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 078, Runtime 4.926402, Loss 0.081215, forward nfe 22868, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 079, Runtime 4.951885, Loss 0.098545, forward nfe 23164, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 080, Runtime 4.960208, Loss 0.094258, forward nfe 23460, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 081, Runtime 4.727484, Loss 0.100598, forward nfe 23756, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 082, Runtime 4.708797, Loss 0.118101, forward nfe 24052, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 083, Runtime 4.784311, Loss 0.088168, forward nfe 24348, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 084, Runtime 4.839056, Loss 0.090896, forward nfe 24644, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 085, Runtime 4.839968, Loss 0.092018, forward nfe 24940, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 086, Runtime 4.775096, Loss 0.123766, forward nfe 25236, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 087, Runtime 4.837335, Loss 0.110582, forward nfe 25532, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 088, Runtime 5.008999, Loss 0.075825, forward nfe 25828, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 089, Runtime 4.919152, Loss 0.092080, forward nfe 26124, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 090, Runtime 4.851273, Loss 0.088011, forward nfe 26420, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 091, Runtime 4.845649, Loss 0.067919, forward nfe 26716, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 092, Runtime 4.941495, Loss 0.089022, forward nfe 27012, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 093, Runtime 4.829904, Loss 0.150164, forward nfe 27308, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 094, Runtime 4.750724, Loss 0.087305, forward nfe 27604, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 095, Runtime 4.737991, Loss 0.127531, forward nfe 27900, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 096, Runtime 4.682927, Loss 0.116520, forward nfe 28196, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 097, Runtime 4.751800, Loss 0.079824, forward nfe 28492, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 098, Runtime 4.860113, Loss 0.086497, forward nfe 28788, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
Epoch: 099, Runtime 4.935319, Loss 0.096616, forward nfe 29084, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8234, Best time: 18.2948
best val accuracy 0.836765 with test accuracy 0.823350 at epoch 22 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.817258883248731
Entropy Threshold: 2 Test accuracy: 0.8192893401015229
Entropy Threshold: 1.6 Test accuracy: 0.8199389623601221
Entropy Threshold: 1.5 Test accuracy: 0.8190184049079755
Entropy Threshold: 1.4 Test accuracy: 0.8290422245108136
Entropy Threshold: 1.3 Test accuracy: 0.8302277432712215
Entropy Threshold: 1.2 Test accuracy: 0.8333333333333334
Entropy Threshold: 1.1 Test accuracy: 0.8370136698212408
Entropy Threshold: 0.9 Test accuracy: 0.8537117903930131
Entropy Threshold: 0.8 Test accuracy: 0.8601553829078802
Entropy Threshold: 0.7 Test accuracy: 0.87115165336374
Entropy Threshold: 0.6 Test accuracy: 0.8884934756820878
Entropy Threshold: 0.5 Test accuracy: 0.9057527539779682
Entropy Threshold: 0.4 Test accuracy: 0.9095541401273886
Entropy Threshold: 0.3 Test accuracy: 0.9154557463672391
Entropy Threshold: 0.2 Test accuracy: 0.919889502762431
Entropy Threshold: 0.1 Test accuracy: 0.9317147192716236
