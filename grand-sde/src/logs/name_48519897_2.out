[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.01
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 5.197530, Loss 1.947418, forward nfe 76, backward nfe 0, Train: 0.6286, Val: 0.6338, Test: 0.6305, Best time: 2.0000
Epoch: 002, Runtime 4.675328, Loss 1.901844, forward nfe 372, backward nfe 0, Train: 0.8429, Val: 0.7757, Test: 0.7635, Best time: 6.0000
Epoch: 003, Runtime 4.719844, Loss 1.751906, forward nfe 668, backward nfe 0, Train: 0.8429, Val: 0.7757, Test: 0.7635, Best time: 18.2948
Epoch: 004, Runtime 4.781224, Loss 1.537138, forward nfe 964, backward nfe 0, Train: 0.8429, Val: 0.7757, Test: 0.7635, Best time: 18.2948
Epoch: 005, Runtime 4.988033, Loss 1.272466, forward nfe 1260, backward nfe 0, Train: 0.8429, Val: 0.7757, Test: 0.7635, Best time: 18.2948
Epoch: 006, Runtime 5.146976, Loss 1.023890, forward nfe 1556, backward nfe 0, Train: 0.8786, Val: 0.7912, Test: 0.7827, Best time: 8.0000
Epoch: 007, Runtime 5.084616, Loss 0.780296, forward nfe 1852, backward nfe 0, Train: 0.8786, Val: 0.8235, Test: 0.8030, Best time: 52.0000
Epoch: 008, Runtime 5.165119, Loss 0.584714, forward nfe 2148, backward nfe 0, Train: 0.9071, Val: 0.8390, Test: 0.8122, Best time: 17.0000
Epoch: 009, Runtime 5.134997, Loss 0.463830, forward nfe 2444, backward nfe 0, Train: 0.9000, Val: 0.8456, Test: 0.8305, Best time: 24.0000
Epoch: 010, Runtime 4.808770, Loss 0.376876, forward nfe 2740, backward nfe 0, Train: 0.9071, Val: 0.8485, Test: 0.8274, Best time: 22.0000
Epoch: 011, Runtime 4.719575, Loss 0.344736, forward nfe 3036, backward nfe 0, Train: 0.9071, Val: 0.8485, Test: 0.8274, Best time: 18.2948
Epoch: 012, Runtime 4.830173, Loss 0.307942, forward nfe 3332, backward nfe 0, Train: 0.9071, Val: 0.8485, Test: 0.8274, Best time: 18.2948
Epoch: 013, Runtime 4.855578, Loss 0.291819, forward nfe 3628, backward nfe 0, Train: 0.9071, Val: 0.8485, Test: 0.8274, Best time: 18.2948
Epoch: 014, Runtime 5.080209, Loss 0.259427, forward nfe 3924, backward nfe 0, Train: 0.9500, Val: 0.8544, Test: 0.8437, Best time: 19.0000
Epoch: 015, Runtime 4.900035, Loss 0.262076, forward nfe 4220, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 29.0000
Epoch: 016, Runtime 4.815554, Loss 0.236915, forward nfe 4516, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 017, Runtime 4.760097, Loss 0.209653, forward nfe 4812, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 018, Runtime 4.826685, Loss 0.256034, forward nfe 5108, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 019, Runtime 4.872157, Loss 0.238181, forward nfe 5404, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 020, Runtime 5.037131, Loss 0.239517, forward nfe 5700, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 021, Runtime 4.959040, Loss 0.227203, forward nfe 5996, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 022, Runtime 4.923678, Loss 0.226876, forward nfe 6292, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 023, Runtime 5.016822, Loss 0.291329, forward nfe 6588, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 024, Runtime 5.130424, Loss 0.264616, forward nfe 6884, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 025, Runtime 4.944257, Loss 0.266357, forward nfe 7180, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 026, Runtime 4.754680, Loss 0.222463, forward nfe 7476, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 027, Runtime 4.790669, Loss 0.277782, forward nfe 7772, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 028, Runtime 4.882513, Loss 0.260203, forward nfe 8068, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 029, Runtime 4.830250, Loss 0.214634, forward nfe 8364, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 030, Runtime 4.824298, Loss 0.274555, forward nfe 8660, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 031, Runtime 4.927852, Loss 0.205023, forward nfe 8956, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 032, Runtime 4.939602, Loss 0.223008, forward nfe 9252, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 033, Runtime 4.921024, Loss 0.183344, forward nfe 9548, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 034, Runtime 4.954378, Loss 0.220484, forward nfe 9844, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 035, Runtime 5.030760, Loss 0.164068, forward nfe 10140, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 036, Runtime 5.049988, Loss 0.171461, forward nfe 10436, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 037, Runtime 5.000755, Loss 0.156880, forward nfe 10732, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 038, Runtime 4.777542, Loss 0.144181, forward nfe 11028, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 039, Runtime 4.784109, Loss 0.177583, forward nfe 11324, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 040, Runtime 4.816481, Loss 0.168527, forward nfe 11620, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 041, Runtime 4.800790, Loss 0.161756, forward nfe 11916, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 042, Runtime 4.881793, Loss 0.156988, forward nfe 12212, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 043, Runtime 4.906202, Loss 0.164380, forward nfe 12508, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 044, Runtime 4.937388, Loss 0.179940, forward nfe 12804, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 045, Runtime 4.942875, Loss 0.181111, forward nfe 13100, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 046, Runtime 4.936413, Loss 0.179259, forward nfe 13396, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 047, Runtime 4.979618, Loss 0.135814, forward nfe 13692, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 048, Runtime 5.001598, Loss 0.178062, forward nfe 13988, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 049, Runtime 5.005985, Loss 0.160470, forward nfe 14284, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 050, Runtime 4.808923, Loss 0.166964, forward nfe 14580, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 051, Runtime 4.707663, Loss 0.117335, forward nfe 14876, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 052, Runtime 4.788584, Loss 0.167491, forward nfe 15172, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 053, Runtime 4.824920, Loss 0.147567, forward nfe 15468, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 054, Runtime 4.883376, Loss 0.121450, forward nfe 15764, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 055, Runtime 4.883724, Loss 0.131453, forward nfe 16060, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 056, Runtime 4.901672, Loss 0.187894, forward nfe 16356, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 057, Runtime 4.919853, Loss 0.165769, forward nfe 16652, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 058, Runtime 4.894887, Loss 0.154999, forward nfe 16948, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 059, Runtime 4.976393, Loss 0.106492, forward nfe 17244, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 060, Runtime 4.987132, Loss 0.149865, forward nfe 17540, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 061, Runtime 4.940770, Loss 0.179173, forward nfe 17836, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 062, Runtime 4.778323, Loss 0.170528, forward nfe 18132, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 063, Runtime 4.741351, Loss 0.156345, forward nfe 18428, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 064, Runtime 4.728806, Loss 0.143809, forward nfe 18724, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 065, Runtime 4.755239, Loss 0.178829, forward nfe 19020, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 066, Runtime 4.774159, Loss 0.114727, forward nfe 19316, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 067, Runtime 4.785633, Loss 0.144096, forward nfe 19612, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 068, Runtime 4.846952, Loss 0.117496, forward nfe 19908, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 069, Runtime 4.834488, Loss 0.156626, forward nfe 20204, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 070, Runtime 4.912291, Loss 0.113892, forward nfe 20500, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 071, Runtime 4.883013, Loss 0.135272, forward nfe 20796, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 072, Runtime 4.896878, Loss 0.092742, forward nfe 21092, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 073, Runtime 4.948702, Loss 0.152644, forward nfe 21388, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 074, Runtime 4.769675, Loss 0.112282, forward nfe 21684, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 075, Runtime 4.744674, Loss 0.126762, forward nfe 21980, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 076, Runtime 4.701047, Loss 0.147113, forward nfe 22276, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 077, Runtime 4.740832, Loss 0.133115, forward nfe 22572, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 078, Runtime 4.845268, Loss 0.114096, forward nfe 22868, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 079, Runtime 4.882778, Loss 0.134317, forward nfe 23164, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 080, Runtime 4.939452, Loss 0.144870, forward nfe 23460, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 081, Runtime 4.824069, Loss 0.115185, forward nfe 23756, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 082, Runtime 4.857585, Loss 0.124673, forward nfe 24052, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 083, Runtime 4.945215, Loss 0.137752, forward nfe 24348, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 084, Runtime 4.975556, Loss 0.130268, forward nfe 24644, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 085, Runtime 4.921339, Loss 0.118903, forward nfe 24940, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 086, Runtime 4.680929, Loss 0.146127, forward nfe 25236, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 087, Runtime 4.690700, Loss 0.117672, forward nfe 25532, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 088, Runtime 4.808105, Loss 0.098375, forward nfe 25828, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 089, Runtime 4.766570, Loss 0.107149, forward nfe 26124, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 090, Runtime 4.788537, Loss 0.136756, forward nfe 26420, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 091, Runtime 4.735241, Loss 0.137792, forward nfe 26716, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 092, Runtime 4.848184, Loss 0.119190, forward nfe 27012, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 093, Runtime 4.889648, Loss 0.119056, forward nfe 27308, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 094, Runtime 4.927774, Loss 0.117844, forward nfe 27604, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 095, Runtime 4.883943, Loss 0.090190, forward nfe 27900, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 096, Runtime 4.852561, Loss 0.125763, forward nfe 28196, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 097, Runtime 4.907336, Loss 0.130582, forward nfe 28492, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 098, Runtime 4.829262, Loss 0.127026, forward nfe 28788, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
Epoch: 099, Runtime 4.796966, Loss 0.101506, forward nfe 29084, backward nfe 0, Train: 0.9500, Val: 0.8551, Test: 0.8538, Best time: 18.2948
best val accuracy 0.855147 with test accuracy 0.853807 at epoch 15 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8477157360406091
Entropy Threshold: 2 Test accuracy: 0.8436548223350254
Entropy Threshold: 1.6 Test accuracy: 0.8465447154471545
Entropy Threshold: 1.5 Test accuracy: 0.8470948012232415
Entropy Threshold: 1.4 Test accuracy: 0.8481141692150866
Entropy Threshold: 1.3 Test accuracy: 0.849539406345957
Entropy Threshold: 1.2 Test accuracy: 0.8528497409326425
Entropy Threshold: 1.1 Test accuracy: 0.8583333333333333
Entropy Threshold: 0.9 Test accuracy: 0.8719912472647703
Entropy Threshold: 0.8 Test accuracy: 0.8794642857142857
Entropy Threshold: 0.7 Test accuracy: 0.8930232558139535
Entropy Threshold: 0.6 Test accuracy: 0.9043583535108959
Entropy Threshold: 0.5 Test accuracy: 0.9257362355953905
Entropy Threshold: 0.4 Test accuracy: 0.9346666666666666
Entropy Threshold: 0.3 Test accuracy: 0.9386331938633193
Entropy Threshold: 0.2 Test accuracy: 0.9397944199706314
Entropy Threshold: 0.1 Test accuracy: 0.9469453376205788
