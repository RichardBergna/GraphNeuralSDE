[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.5
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.307389, Loss 2.121180, forward nfe 76, backward nfe 0, Train: 0.3929, Val: 0.3147, Test: 0.3371, Best time: 2.0000
Epoch: 002, Runtime 9.699589, Loss 2.569607, forward nfe 372, backward nfe 0, Train: 0.5214, Val: 0.3625, Test: 0.3787, Best time: 1.0000
Epoch: 003, Runtime 9.950513, Loss 2.064016, forward nfe 668, backward nfe 0, Train: 0.5786, Val: 0.3757, Test: 0.4071, Best time: 1.0000
Epoch: 004, Runtime 9.769119, Loss 1.996165, forward nfe 964, backward nfe 0, Train: 0.6286, Val: 0.4294, Test: 0.4701, Best time: 1.0000
Epoch: 005, Runtime 9.658880, Loss 2.000961, forward nfe 1260, backward nfe 0, Train: 0.7714, Val: 0.5904, Test: 0.6193, Best time: 5.0000
Epoch: 006, Runtime 9.874507, Loss 1.998954, forward nfe 1556, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 7.0000
Epoch: 007, Runtime 9.737731, Loss 1.874197, forward nfe 1852, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 18.2948
Epoch: 008, Runtime 10.873292, Loss 1.822635, forward nfe 2148, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 18.2948
Epoch: 009, Runtime 10.836735, Loss 1.707257, forward nfe 2444, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 18.2948
Epoch: 010, Runtime 11.659320, Loss 1.686821, forward nfe 2740, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 18.2948
Epoch: 011, Runtime 12.136574, Loss 1.555588, forward nfe 3036, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 18.2948
Epoch: 012, Runtime 12.072688, Loss 1.396719, forward nfe 3332, backward nfe 0, Train: 0.7714, Val: 0.6375, Test: 0.6396, Best time: 18.2948
Epoch: 013, Runtime 12.116274, Loss 1.301991, forward nfe 3628, backward nfe 0, Train: 0.8000, Val: 0.6625, Test: 0.6650, Best time: 8.0000
Epoch: 014, Runtime 11.475528, Loss 1.274312, forward nfe 3924, backward nfe 0, Train: 0.8286, Val: 0.7081, Test: 0.7005, Best time: 24.0000
Epoch: 015, Runtime 11.437543, Loss 1.172997, forward nfe 4220, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 17.0000
Epoch: 016, Runtime 11.314273, Loss 1.039034, forward nfe 4516, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 017, Runtime 11.702133, Loss 0.949088, forward nfe 4812, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 018, Runtime 11.616415, Loss 0.893370, forward nfe 5108, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 019, Runtime 11.714165, Loss 0.935430, forward nfe 5404, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 020, Runtime 12.007614, Loss 0.799631, forward nfe 5700, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 021, Runtime 11.864899, Loss 0.780261, forward nfe 5996, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 022, Runtime 11.954954, Loss 0.786258, forward nfe 6292, backward nfe 0, Train: 0.8143, Val: 0.7294, Test: 0.7239, Best time: 18.2948
Epoch: 023, Runtime 12.395120, Loss 0.686413, forward nfe 6588, backward nfe 0, Train: 0.8571, Val: 0.7338, Test: 0.7239, Best time: 18.2948
Epoch: 024, Runtime 11.182408, Loss 0.695769, forward nfe 6884, backward nfe 0, Train: 0.8571, Val: 0.7338, Test: 0.7239, Best time: 18.2948
Epoch: 025, Runtime 11.711478, Loss 0.723780, forward nfe 7180, backward nfe 0, Train: 0.8429, Val: 0.7346, Test: 0.7310, Best time: 18.2948
Epoch: 026, Runtime 11.372246, Loss 0.696736, forward nfe 7476, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7168, Best time: 18.2948
Epoch: 027, Runtime 11.072928, Loss 0.708435, forward nfe 7772, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7168, Best time: 18.2948
Epoch: 028, Runtime 11.581581, Loss 0.663871, forward nfe 8068, backward nfe 0, Train: 0.8643, Val: 0.7434, Test: 0.7299, Best time: 18.2948
Epoch: 029, Runtime 10.856160, Loss 0.612993, forward nfe 8364, backward nfe 0, Train: 0.8643, Val: 0.7434, Test: 0.7299, Best time: 18.2948
Epoch: 030, Runtime 11.267711, Loss 0.601673, forward nfe 8660, backward nfe 0, Train: 0.8643, Val: 0.7434, Test: 0.7299, Best time: 18.2948
Epoch: 031, Runtime 11.146752, Loss 0.672337, forward nfe 8956, backward nfe 0, Train: 0.9071, Val: 0.7456, Test: 0.7401, Best time: 18.2948
Epoch: 032, Runtime 10.729959, Loss 0.518822, forward nfe 9252, backward nfe 0, Train: 0.8714, Val: 0.7522, Test: 0.7492, Best time: 18.2948
Epoch: 033, Runtime 10.464004, Loss 0.535636, forward nfe 9548, backward nfe 0, Train: 0.8714, Val: 0.7522, Test: 0.7492, Best time: 18.2948
Epoch: 034, Runtime 10.727241, Loss 0.484742, forward nfe 9844, backward nfe 0, Train: 0.8714, Val: 0.7522, Test: 0.7492, Best time: 18.2948
Epoch: 035, Runtime 10.482672, Loss 0.496297, forward nfe 10140, backward nfe 0, Train: 0.8714, Val: 0.7522, Test: 0.7492, Best time: 18.2948
Epoch: 036, Runtime 10.489291, Loss 0.439262, forward nfe 10436, backward nfe 0, Train: 0.9143, Val: 0.7676, Test: 0.7594, Best time: 18.2948
Epoch: 037, Runtime 10.152467, Loss 0.530753, forward nfe 10732, backward nfe 0, Train: 0.9571, Val: 0.7779, Test: 0.7746, Best time: 18.2948
Epoch: 038, Runtime 10.082369, Loss 0.560185, forward nfe 11028, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 039, Runtime 9.927250, Loss 0.501869, forward nfe 11324, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 040, Runtime 10.275377, Loss 0.450098, forward nfe 11620, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 041, Runtime 10.278253, Loss 0.524330, forward nfe 11916, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 042, Runtime 10.317492, Loss 0.559121, forward nfe 12212, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 043, Runtime 10.735170, Loss 0.452231, forward nfe 12508, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 044, Runtime 10.601415, Loss 0.539433, forward nfe 12804, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 045, Runtime 11.675276, Loss 0.427079, forward nfe 13100, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 046, Runtime 12.493857, Loss 0.376292, forward nfe 13396, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 047, Runtime 12.349465, Loss 0.388159, forward nfe 13692, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 048, Runtime 12.431176, Loss 0.383697, forward nfe 13988, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 049, Runtime 12.657432, Loss 0.354599, forward nfe 14284, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 050, Runtime 12.680146, Loss 0.338113, forward nfe 14580, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 051, Runtime 12.674993, Loss 0.403913, forward nfe 14876, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 052, Runtime 12.974463, Loss 0.476600, forward nfe 15172, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 053, Runtime 12.925427, Loss 0.362534, forward nfe 15468, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 054, Runtime 12.930734, Loss 0.308185, forward nfe 15764, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 055, Runtime 13.233152, Loss 0.397546, forward nfe 16060, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 056, Runtime 13.145080, Loss 0.372301, forward nfe 16356, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 057, Runtime 13.188735, Loss 0.329485, forward nfe 16652, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 058, Runtime 13.245229, Loss 0.367724, forward nfe 16948, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 059, Runtime 13.300016, Loss 0.421606, forward nfe 17244, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 060, Runtime 13.259010, Loss 0.360328, forward nfe 17540, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 061, Runtime 13.511580, Loss 0.314927, forward nfe 17836, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 062, Runtime 13.562393, Loss 0.315407, forward nfe 18132, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 063, Runtime 13.614956, Loss 0.340226, forward nfe 18428, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 064, Runtime 13.595034, Loss 0.322388, forward nfe 18724, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 065, Runtime 13.685823, Loss 0.367802, forward nfe 19020, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 066, Runtime 13.550359, Loss 0.334224, forward nfe 19316, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 067, Runtime 13.657505, Loss 0.338329, forward nfe 19612, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 068, Runtime 13.665941, Loss 0.363298, forward nfe 19908, backward nfe 0, Train: 0.9071, Val: 0.7868, Test: 0.7797, Best time: 18.2948
Epoch: 069, Runtime 13.864706, Loss 0.353211, forward nfe 20204, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 070, Runtime 11.316597, Loss 0.334630, forward nfe 20500, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 071, Runtime 10.854252, Loss 0.261178, forward nfe 20796, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 072, Runtime 9.907068, Loss 0.331086, forward nfe 21092, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 073, Runtime 9.918216, Loss 0.319823, forward nfe 21388, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 074, Runtime 10.210198, Loss 0.272720, forward nfe 21684, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 075, Runtime 10.205541, Loss 0.312507, forward nfe 21980, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 076, Runtime 10.178518, Loss 0.302519, forward nfe 22276, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 077, Runtime 10.597080, Loss 0.338960, forward nfe 22572, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 078, Runtime 10.439910, Loss 0.265501, forward nfe 22868, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 079, Runtime 10.551519, Loss 0.308661, forward nfe 23164, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 080, Runtime 10.654440, Loss 0.330118, forward nfe 23460, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 081, Runtime 10.382639, Loss 0.237788, forward nfe 23756, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 082, Runtime 10.293665, Loss 0.348632, forward nfe 24052, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 083, Runtime 10.709314, Loss 0.227525, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 084, Runtime 10.711548, Loss 0.264794, forward nfe 24644, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 085, Runtime 10.507127, Loss 0.253514, forward nfe 24940, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 086, Runtime 10.287842, Loss 0.210301, forward nfe 25236, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 087, Runtime 10.263920, Loss 0.322801, forward nfe 25532, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 088, Runtime 10.464278, Loss 0.219212, forward nfe 25828, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 089, Runtime 10.525951, Loss 0.245439, forward nfe 26124, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 090, Runtime 10.404297, Loss 0.275118, forward nfe 26420, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 091, Runtime 10.519676, Loss 0.150411, forward nfe 26716, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 092, Runtime 10.577028, Loss 0.305948, forward nfe 27012, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 093, Runtime 10.547330, Loss 0.259234, forward nfe 27308, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 094, Runtime 10.350726, Loss 0.311628, forward nfe 27604, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 095, Runtime 10.594665, Loss 0.199075, forward nfe 27900, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 096, Runtime 10.534501, Loss 0.181034, forward nfe 28196, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 097, Runtime 10.623396, Loss 0.259161, forward nfe 28492, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 098, Runtime 11.698214, Loss 0.180532, forward nfe 28788, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
Epoch: 099, Runtime 11.741796, Loss 0.297957, forward nfe 29084, backward nfe 0, Train: 0.9429, Val: 0.7912, Test: 0.7695, Best time: 18.2948
best val accuracy 0.791176 with test accuracy 0.769543 at epoch 69 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.7939086294416243
Entropy Threshold: 2 Test accuracy: 0.7959390862944162
Entropy Threshold: 1.6 Test accuracy: 0.8
Entropy Threshold: 1.5 Test accuracy: 0.8024564994882293
Entropy Threshold: 1.4 Test accuracy: 0.8076525336091003
Entropy Threshold: 1.3 Test accuracy: 0.8067226890756303
Entropy Threshold: 1.2 Test accuracy: 0.8202368137782562
Entropy Threshold: 1.1 Test accuracy: 0.8255555555555556
Entropy Threshold: 0.9 Test accuracy: 0.8418549346016647
Entropy Threshold: 0.8 Test accuracy: 0.8523153942428036
Entropy Threshold: 0.7 Test accuracy: 0.866225165562914
Entropy Threshold: 0.6 Test accuracy: 0.879382889200561
Entropy Threshold: 0.5 Test accuracy: 0.8895522388059701
Entropy Threshold: 0.4 Test accuracy: 0.9009584664536742
Entropy Threshold: 0.3 Test accuracy: 0.9094076655052264
Entropy Threshold: 0.2 Test accuracy: 0.9191321499013807
Entropy Threshold: 0.1 Test accuracy: 0.9228915662650602
