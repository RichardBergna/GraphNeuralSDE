[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 8.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 12.475181, Loss 5.866819, forward nfe 76, backward nfe 0, Train: 0.3786, Val: 0.1934, Test: 0.2071, Best time: 52.0000
Epoch: 002, Runtime 12.234524, Loss 6.620061, forward nfe 372, backward nfe 0, Train: 0.7357, Val: 0.5588, Test: 0.5909, Best time: 14.0000
Epoch: 003, Runtime 11.699175, Loss 5.545060, forward nfe 668, backward nfe 0, Train: 0.7714, Val: 0.5838, Test: 0.5970, Best time: 4.0000
Epoch: 004, Runtime 11.869210, Loss 4.940193, forward nfe 964, backward nfe 0, Train: 0.7714, Val: 0.5838, Test: 0.5970, Best time: 18.2948
Epoch: 005, Runtime 12.523190, Loss 4.823985, forward nfe 1260, backward nfe 0, Train: 0.7714, Val: 0.5838, Test: 0.5970, Best time: 18.2948
Epoch: 006, Runtime 12.176588, Loss 4.421669, forward nfe 1556, backward nfe 0, Train: 0.7714, Val: 0.5838, Test: 0.5970, Best time: 18.2948
Epoch: 007, Runtime 12.549559, Loss 3.600659, forward nfe 1852, backward nfe 0, Train: 0.7286, Val: 0.5919, Test: 0.6000, Best time: 9.0000
Epoch: 008, Runtime 11.901847, Loss 3.595336, forward nfe 2148, backward nfe 0, Train: 0.7857, Val: 0.6228, Test: 0.6447, Best time: 10.0000
Epoch: 009, Runtime 12.007608, Loss 3.508069, forward nfe 2444, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 12.0000
Epoch: 010, Runtime 12.109036, Loss 2.998515, forward nfe 2740, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 011, Runtime 12.493930, Loss 2.782777, forward nfe 3036, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 012, Runtime 12.050447, Loss 2.699623, forward nfe 3332, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 013, Runtime 12.075133, Loss 2.840227, forward nfe 3628, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 014, Runtime 11.920357, Loss 2.233172, forward nfe 3924, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 015, Runtime 12.260643, Loss 2.258590, forward nfe 4220, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 016, Runtime 12.250159, Loss 2.238058, forward nfe 4516, backward nfe 0, Train: 0.8571, Val: 0.6912, Test: 0.6975, Best time: 18.2948
Epoch: 017, Runtime 12.725645, Loss 2.103962, forward nfe 4812, backward nfe 0, Train: 0.8143, Val: 0.7500, Test: 0.7431, Best time: 20.0000
Epoch: 018, Runtime 11.830581, Loss 2.175101, forward nfe 5108, backward nfe 0, Train: 0.8429, Val: 0.7662, Test: 0.7665, Best time: 25.0000
Epoch: 019, Runtime 12.184848, Loss 2.215757, forward nfe 5404, backward nfe 0, Train: 0.8857, Val: 0.7919, Test: 0.7898, Best time: 38.0000
Epoch: 020, Runtime 12.230272, Loss 2.044837, forward nfe 5700, backward nfe 0, Train: 0.8786, Val: 0.8044, Test: 0.7980, Best time: 23.0000
Epoch: 021, Runtime 11.807235, Loss 2.132115, forward nfe 5996, backward nfe 0, Train: 0.8714, Val: 0.8110, Test: 0.7980, Best time: 26.0000
Epoch: 022, Runtime 11.930794, Loss 2.093792, forward nfe 6292, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 15.0000
Epoch: 023, Runtime 11.794357, Loss 1.871018, forward nfe 6588, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 024, Runtime 12.181881, Loss 1.956083, forward nfe 6884, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 025, Runtime 11.853049, Loss 1.813310, forward nfe 7180, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 026, Runtime 12.306322, Loss 2.091790, forward nfe 7476, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 027, Runtime 11.932297, Loss 1.929794, forward nfe 7772, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 028, Runtime 12.144707, Loss 1.846604, forward nfe 8068, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 029, Runtime 12.307012, Loss 1.806266, forward nfe 8364, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 030, Runtime 12.625129, Loss 1.735089, forward nfe 8660, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 031, Runtime 12.911974, Loss 1.726995, forward nfe 8956, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 032, Runtime 12.832364, Loss 1.943597, forward nfe 9252, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 033, Runtime 13.104498, Loss 1.744745, forward nfe 9548, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 034, Runtime 13.703434, Loss 1.612652, forward nfe 9844, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 035, Runtime 13.596294, Loss 1.588073, forward nfe 10140, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 036, Runtime 13.893635, Loss 1.465137, forward nfe 10436, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 037, Runtime 13.612695, Loss 1.568466, forward nfe 10732, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 038, Runtime 13.998680, Loss 1.661413, forward nfe 11028, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 039, Runtime 14.024565, Loss 1.647623, forward nfe 11324, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 040, Runtime 13.999874, Loss 1.499848, forward nfe 11620, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 041, Runtime 14.036138, Loss 1.573998, forward nfe 11916, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 042, Runtime 14.138656, Loss 1.462805, forward nfe 12212, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 043, Runtime 14.714631, Loss 1.395922, forward nfe 12508, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 044, Runtime 14.636461, Loss 1.384302, forward nfe 12804, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 045, Runtime 15.516042, Loss 1.422644, forward nfe 13100, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 046, Runtime 15.253775, Loss 1.369146, forward nfe 13396, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 047, Runtime 15.758347, Loss 1.520609, forward nfe 13692, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 048, Runtime 15.358452, Loss 1.404206, forward nfe 13988, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 049, Runtime 16.217534, Loss 1.531207, forward nfe 14284, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 050, Runtime 15.557801, Loss 1.388280, forward nfe 14580, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 051, Runtime 16.103898, Loss 1.199057, forward nfe 14876, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 052, Runtime 15.646932, Loss 1.286365, forward nfe 15172, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 053, Runtime 15.982232, Loss 1.385039, forward nfe 15468, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 054, Runtime 15.591866, Loss 1.232765, forward nfe 15764, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 055, Runtime 15.929312, Loss 1.329557, forward nfe 16060, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 056, Runtime 15.553601, Loss 1.140256, forward nfe 16356, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 057, Runtime 16.346715, Loss 1.488523, forward nfe 16652, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 058, Runtime 16.192864, Loss 1.076292, forward nfe 16948, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 059, Runtime 16.693733, Loss 1.337299, forward nfe 17244, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 060, Runtime 16.387760, Loss 1.234145, forward nfe 17540, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 061, Runtime 16.669224, Loss 1.326391, forward nfe 17836, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 062, Runtime 16.351787, Loss 1.080782, forward nfe 18132, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 063, Runtime 16.612405, Loss 1.174050, forward nfe 18428, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 064, Runtime 16.649935, Loss 1.137562, forward nfe 18724, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 065, Runtime 17.153691, Loss 1.097368, forward nfe 19020, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 066, Runtime 16.982235, Loss 1.108512, forward nfe 19316, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 067, Runtime 17.204404, Loss 1.188776, forward nfe 19612, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 068, Runtime 17.178907, Loss 1.027020, forward nfe 19908, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 069, Runtime 17.309721, Loss 1.048252, forward nfe 20204, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 070, Runtime 17.749777, Loss 1.162784, forward nfe 20500, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 071, Runtime 17.980231, Loss 1.017014, forward nfe 20796, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 072, Runtime 18.339400, Loss 0.919107, forward nfe 21092, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 073, Runtime 18.454320, Loss 0.972284, forward nfe 21388, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 074, Runtime 18.324917, Loss 0.999793, forward nfe 21684, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 075, Runtime 18.366309, Loss 0.971310, forward nfe 21980, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 076, Runtime 18.512190, Loss 1.015275, forward nfe 22276, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 077, Runtime 18.601058, Loss 0.992893, forward nfe 22572, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 078, Runtime 18.492951, Loss 0.954300, forward nfe 22868, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 079, Runtime 18.327407, Loss 1.145694, forward nfe 23164, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 080, Runtime 18.721394, Loss 0.914858, forward nfe 23460, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 081, Runtime 18.956125, Loss 1.121614, forward nfe 23756, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 082, Runtime 19.385020, Loss 1.023448, forward nfe 24052, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 083, Runtime 19.245804, Loss 0.795938, forward nfe 24348, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 084, Runtime 20.098491, Loss 0.965221, forward nfe 24644, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 085, Runtime 20.961324, Loss 0.905823, forward nfe 24940, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 086, Runtime 28.551257, Loss 0.858693, forward nfe 25236, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 087, Runtime 28.324478, Loss 1.138863, forward nfe 25532, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 088, Runtime 21.929021, Loss 1.058566, forward nfe 25828, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 089, Runtime 21.485358, Loss 1.066782, forward nfe 26124, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 090, Runtime 21.781004, Loss 1.001206, forward nfe 26420, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 091, Runtime 21.521097, Loss 0.940296, forward nfe 26716, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 092, Runtime 21.570181, Loss 0.894455, forward nfe 27012, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 093, Runtime 21.304204, Loss 0.967841, forward nfe 27308, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 094, Runtime 21.483126, Loss 0.867165, forward nfe 27604, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 095, Runtime 21.311050, Loss 1.070926, forward nfe 27900, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 096, Runtime 21.199906, Loss 1.049806, forward nfe 28196, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 097, Runtime 21.886852, Loss 0.923729, forward nfe 28492, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 098, Runtime 22.030167, Loss 0.785614, forward nfe 28788, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
Epoch: 099, Runtime 19.726368, Loss 0.731337, forward nfe 29084, backward nfe 0, Train: 0.8857, Val: 0.8147, Test: 0.7980, Best time: 18.2948
best val accuracy 0.814706 with test accuracy 0.797970 at epoch 22 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.6588832487309645
Entropy Threshold: 2 Test accuracy: 0.6436548223350254
Entropy Threshold: 1.6 Test accuracy: 0.8805555555555555
Entropy Threshold: 1.5 Test accuracy: 0.9026845637583892
Entropy Threshold: 1.4 Test accuracy: 0.9148936170212766
Entropy Threshold: 1.3 Test accuracy: 0.9105263157894737
Entropy Threshold: 1.2 Test accuracy: 0.9403973509933775
Entropy Threshold: 1.1 Test accuracy: 0.9609375
Entropy Threshold: 0.9 Test accuracy: 0.9634146341463414
Entropy Threshold: 0.8 Test accuracy: 0.9552238805970149
Entropy Threshold: 0.7 Test accuracy: 0.9473684210526315
Entropy Threshold: 0.6 Test accuracy: 0.9565217391304348
Entropy Threshold: 0.5 Test accuracy: 0.975609756097561
Entropy Threshold: 0.4 Test accuracy: 0.9642857142857143
Entropy Threshold: 0.3 Test accuracy: 0.9444444444444444
Entropy Threshold: 0.2 Test accuracy: 0.9333333333333333
Entropy Threshold: 0.1 Test accuracy: 1.0
