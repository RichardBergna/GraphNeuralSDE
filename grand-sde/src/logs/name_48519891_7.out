[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 5.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 16.750588, Loss 4.577889, forward nfe 76, backward nfe 0, Train: 0.5000, Val: 0.4721, Test: 0.4690, Best time: 1.0000
Epoch: 002, Runtime 17.458036, Loss 4.887146, forward nfe 372, backward nfe 0, Train: 0.6429, Val: 0.5279, Test: 0.5056, Best time: 8.0000
Epoch: 003, Runtime 16.926558, Loss 3.576771, forward nfe 668, backward nfe 0, Train: 0.6429, Val: 0.5279, Test: 0.5056, Best time: 18.2948
Epoch: 004, Runtime 17.725102, Loss 3.473696, forward nfe 964, backward nfe 0, Train: 0.7214, Val: 0.5757, Test: 0.5574, Best time: 4.0000
Epoch: 005, Runtime 16.821892, Loss 3.087367, forward nfe 1260, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 5.0000
Epoch: 006, Runtime 16.396074, Loss 2.796065, forward nfe 1556, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 007, Runtime 17.587863, Loss 2.830815, forward nfe 1852, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 008, Runtime 16.879405, Loss 2.647301, forward nfe 2148, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 009, Runtime 17.482939, Loss 2.437354, forward nfe 2444, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 010, Runtime 16.847575, Loss 2.244118, forward nfe 2740, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 011, Runtime 16.857924, Loss 2.240659, forward nfe 3036, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 012, Runtime 17.213931, Loss 2.021946, forward nfe 3332, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 013, Runtime 17.490334, Loss 2.031293, forward nfe 3628, backward nfe 0, Train: 0.7286, Val: 0.6426, Test: 0.5878, Best time: 18.2948
Epoch: 014, Runtime 18.347462, Loss 1.890537, forward nfe 3924, backward nfe 0, Train: 0.7571, Val: 0.6434, Test: 0.6294, Best time: 1.0000
Epoch: 015, Runtime 16.488445, Loss 1.793966, forward nfe 4220, backward nfe 0, Train: 0.7643, Val: 0.6478, Test: 0.6183, Best time: 2.0000
Epoch: 016, Runtime 16.504501, Loss 1.697688, forward nfe 4516, backward nfe 0, Train: 0.7714, Val: 0.6669, Test: 0.6335, Best time: 1.0000
Epoch: 017, Runtime 16.397449, Loss 1.733992, forward nfe 4812, backward nfe 0, Train: 0.7786, Val: 0.6765, Test: 0.6416, Best time: 1.0000
Epoch: 018, Runtime 16.342792, Loss 1.509288, forward nfe 5108, backward nfe 0, Train: 0.7643, Val: 0.6779, Test: 0.6437, Best time: 1.0000
Epoch: 019, Runtime 16.249675, Loss 1.653944, forward nfe 5404, backward nfe 0, Train: 0.7643, Val: 0.6794, Test: 0.6447, Best time: 1.0000
Epoch: 020, Runtime 16.498473, Loss 1.615263, forward nfe 5700, backward nfe 0, Train: 0.7714, Val: 0.6890, Test: 0.6437, Best time: 1.0000
Epoch: 021, Runtime 16.598051, Loss 1.516963, forward nfe 5996, backward nfe 0, Train: 0.7786, Val: 0.6978, Test: 0.6599, Best time: 1.0000
Epoch: 022, Runtime 16.602683, Loss 1.397098, forward nfe 6292, backward nfe 0, Train: 0.8000, Val: 0.7029, Test: 0.6680, Best time: 1.0000
Epoch: 023, Runtime 16.965114, Loss 1.319514, forward nfe 6588, backward nfe 0, Train: 0.7786, Val: 0.7074, Test: 0.6741, Best time: 1.0000
Epoch: 024, Runtime 17.003097, Loss 1.475999, forward nfe 6884, backward nfe 0, Train: 0.7929, Val: 0.7096, Test: 0.6792, Best time: 1.0000
Epoch: 025, Runtime 16.849947, Loss 1.403238, forward nfe 7180, backward nfe 0, Train: 0.8214, Val: 0.7110, Test: 0.6832, Best time: 1.0000
Epoch: 026, Runtime 17.140076, Loss 1.327022, forward nfe 7476, backward nfe 0, Train: 0.8286, Val: 0.7206, Test: 0.6964, Best time: 1.0000
Epoch: 027, Runtime 17.299208, Loss 1.324945, forward nfe 7772, backward nfe 0, Train: 0.8071, Val: 0.7324, Test: 0.7157, Best time: 1.0000
Epoch: 028, Runtime 17.356972, Loss 1.230351, forward nfe 8068, backward nfe 0, Train: 0.8071, Val: 0.7434, Test: 0.7208, Best time: 1.0000
Epoch: 029, Runtime 17.607268, Loss 1.210232, forward nfe 8364, backward nfe 0, Train: 0.8214, Val: 0.7478, Test: 0.7117, Best time: 2.0000
Epoch: 030, Runtime 17.286040, Loss 1.163288, forward nfe 8660, backward nfe 0, Train: 0.8286, Val: 0.7522, Test: 0.7137, Best time: 3.0000
Epoch: 031, Runtime 17.486083, Loss 1.102535, forward nfe 8956, backward nfe 0, Train: 0.8429, Val: 0.7647, Test: 0.7269, Best time: 4.0000
Epoch: 032, Runtime 17.635507, Loss 1.211674, forward nfe 9252, backward nfe 0, Train: 0.8500, Val: 0.7779, Test: 0.7391, Best time: 4.0000
Epoch: 033, Runtime 17.758464, Loss 1.095280, forward nfe 9548, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 4.0000
Epoch: 034, Runtime 17.157123, Loss 1.129525, forward nfe 9844, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 035, Runtime 17.554829, Loss 1.144211, forward nfe 10140, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 036, Runtime 17.826966, Loss 0.986995, forward nfe 10436, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 037, Runtime 18.313198, Loss 1.231067, forward nfe 10732, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 038, Runtime 18.639366, Loss 1.263983, forward nfe 11028, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 039, Runtime 18.901685, Loss 0.941394, forward nfe 11324, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 040, Runtime 18.919218, Loss 1.086576, forward nfe 11620, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 041, Runtime 19.433334, Loss 1.052395, forward nfe 11916, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 042, Runtime 19.684964, Loss 1.033432, forward nfe 12212, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 043, Runtime 19.821101, Loss 0.879570, forward nfe 12508, backward nfe 0, Train: 0.8500, Val: 0.7882, Test: 0.7563, Best time: 18.2948
Epoch: 044, Runtime 19.706517, Loss 1.066171, forward nfe 12804, backward nfe 0, Train: 0.8714, Val: 0.7934, Test: 0.7655, Best time: 9.0000
Epoch: 045, Runtime 16.317564, Loss 0.936792, forward nfe 13100, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 10.0000
Epoch: 046, Runtime 16.188360, Loss 1.101237, forward nfe 13396, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 047, Runtime 16.442254, Loss 0.973897, forward nfe 13692, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 048, Runtime 16.766154, Loss 0.926544, forward nfe 13988, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 049, Runtime 17.163699, Loss 0.942543, forward nfe 14284, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 050, Runtime 16.261536, Loss 0.926151, forward nfe 14580, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 051, Runtime 16.553754, Loss 0.817665, forward nfe 14876, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 052, Runtime 16.995766, Loss 0.904308, forward nfe 15172, backward nfe 0, Train: 0.8857, Val: 0.8000, Test: 0.7706, Best time: 18.2948
Epoch: 053, Runtime 17.406253, Loss 0.888044, forward nfe 15468, backward nfe 0, Train: 0.8786, Val: 0.8015, Test: 0.7787, Best time: 14.0000
Epoch: 054, Runtime 15.713994, Loss 0.906852, forward nfe 15764, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.0000
Epoch: 055, Runtime 15.602013, Loss 1.142273, forward nfe 16060, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 056, Runtime 15.160629, Loss 0.918996, forward nfe 16356, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 057, Runtime 15.568692, Loss 0.916779, forward nfe 16652, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 058, Runtime 15.440526, Loss 0.895332, forward nfe 16948, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 059, Runtime 15.655554, Loss 0.938273, forward nfe 17244, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 060, Runtime 16.073518, Loss 0.686379, forward nfe 17540, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 061, Runtime 16.203536, Loss 0.727459, forward nfe 17836, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 062, Runtime 16.335340, Loss 0.937947, forward nfe 18132, backward nfe 0, Train: 0.8857, Val: 0.8110, Test: 0.7949, Best time: 18.2948
Epoch: 063, Runtime 17.117819, Loss 0.779357, forward nfe 18428, backward nfe 0, Train: 0.9000, Val: 0.8118, Test: 0.7990, Best time: 23.0000
Epoch: 064, Runtime 14.544958, Loss 0.590894, forward nfe 18724, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 22.0000
Epoch: 065, Runtime 14.514296, Loss 0.694445, forward nfe 19020, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 066, Runtime 14.775373, Loss 0.799498, forward nfe 19316, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 067, Runtime 14.628971, Loss 0.832024, forward nfe 19612, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 068, Runtime 14.891365, Loss 0.837286, forward nfe 19908, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 069, Runtime 15.042532, Loss 0.708385, forward nfe 20204, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 070, Runtime 15.718551, Loss 0.942405, forward nfe 20500, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 071, Runtime 15.598394, Loss 0.718058, forward nfe 20796, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 072, Runtime 15.779195, Loss 0.777116, forward nfe 21092, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 073, Runtime 16.735002, Loss 0.707363, forward nfe 21388, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 074, Runtime 16.467499, Loss 0.600813, forward nfe 21684, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 075, Runtime 16.445388, Loss 0.704950, forward nfe 21980, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 076, Runtime 16.848359, Loss 0.733672, forward nfe 22276, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 077, Runtime 16.797180, Loss 0.801403, forward nfe 22572, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 078, Runtime 16.522977, Loss 0.839560, forward nfe 22868, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 079, Runtime 17.190941, Loss 0.787456, forward nfe 23164, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 080, Runtime 17.189956, Loss 0.744894, forward nfe 23460, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 081, Runtime 17.326510, Loss 0.782126, forward nfe 23756, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 082, Runtime 17.778876, Loss 0.716990, forward nfe 24052, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 083, Runtime 17.461406, Loss 0.746585, forward nfe 24348, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 084, Runtime 17.607573, Loss 0.596988, forward nfe 24644, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 085, Runtime 18.119467, Loss 0.710898, forward nfe 24940, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 086, Runtime 18.181109, Loss 0.666297, forward nfe 25236, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 087, Runtime 17.866114, Loss 0.668045, forward nfe 25532, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 088, Runtime 17.714900, Loss 0.654447, forward nfe 25828, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 089, Runtime 17.699854, Loss 0.704613, forward nfe 26124, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 090, Runtime 17.914716, Loss 0.753362, forward nfe 26420, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 091, Runtime 17.620896, Loss 0.746297, forward nfe 26716, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 092, Runtime 18.369877, Loss 0.707510, forward nfe 27012, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 093, Runtime 18.405034, Loss 0.710374, forward nfe 27308, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 094, Runtime 17.740513, Loss 0.687284, forward nfe 27604, backward nfe 0, Train: 0.9071, Val: 0.8147, Test: 0.8030, Best time: 18.2948
Epoch: 095, Runtime 19.798283, Loss 0.632765, forward nfe 27900, backward nfe 0, Train: 0.9357, Val: 0.8221, Test: 0.8041, Best time: 35.0000
Epoch: 096, Runtime 13.494864, Loss 0.732648, forward nfe 28196, backward nfe 0, Train: 0.9357, Val: 0.8221, Test: 0.8041, Best time: 18.2948
Epoch: 097, Runtime 12.988505, Loss 0.480944, forward nfe 28492, backward nfe 0, Train: 0.9357, Val: 0.8221, Test: 0.8041, Best time: 18.2948
Epoch: 098, Runtime 12.953847, Loss 0.717364, forward nfe 28788, backward nfe 0, Train: 0.9357, Val: 0.8221, Test: 0.8041, Best time: 18.2948
Epoch: 099, Runtime 13.042997, Loss 0.619213, forward nfe 29084, backward nfe 0, Train: 0.9357, Val: 0.8221, Test: 0.8041, Best time: 18.2948
best val accuracy 0.822059 with test accuracy 0.804061 at epoch 95 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8385786802030457
Entropy Threshold: 2 Test accuracy: 0.8284263959390863
Entropy Threshold: 1.6 Test accuracy: 0.8343558282208589
Entropy Threshold: 1.5 Test accuracy: 0.8475103734439834
Entropy Threshold: 1.4 Test accuracy: 0.8464773922187171
Entropy Threshold: 1.3 Test accuracy: 0.8560687432867884
Entropy Threshold: 1.2 Test accuracy: 0.8580931263858093
Entropy Threshold: 1.1 Test accuracy: 0.873589164785553
Entropy Threshold: 0.9 Test accuracy: 0.9013732833957553
Entropy Threshold: 0.8 Test accuracy: 0.9140211640211641
Entropy Threshold: 0.7 Test accuracy: 0.9319148936170213
Entropy Threshold: 0.6 Test accuracy: 0.9337349397590361
Entropy Threshold: 0.5 Test accuracy: 0.9446254071661238
Entropy Threshold: 0.4 Test accuracy: 0.9498269896193772
Entropy Threshold: 0.3 Test accuracy: 0.9588785046728971
Entropy Threshold: 0.2 Test accuracy: 0.9589322381930184
Entropy Threshold: 0.1 Test accuracy: 0.9685230024213075
