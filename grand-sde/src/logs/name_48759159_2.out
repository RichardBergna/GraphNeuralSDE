[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.2
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.076309, Loss 2.120033, forward nfe 76, backward nfe 0, Train: 0.5000, Val: 0.4919, Test: 0.4629, Best time: 54.8843
Epoch: 002, Runtime 9.908434, Loss 2.064730, forward nfe 372, backward nfe 0, Train: 0.5000, Val: 0.4919, Test: 0.4629, Best time: 18.2948
Epoch: 003, Runtime 10.363212, Loss 2.074449, forward nfe 668, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 8.0000
Epoch: 004, Runtime 10.067607, Loss 1.938117, forward nfe 964, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 005, Runtime 10.857520, Loss 1.958775, forward nfe 1260, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 006, Runtime 10.941915, Loss 1.741809, forward nfe 1556, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 007, Runtime 10.982466, Loss 1.640241, forward nfe 1852, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 008, Runtime 11.046597, Loss 1.521238, forward nfe 2148, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 009, Runtime 10.701426, Loss 1.415599, forward nfe 2444, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 010, Runtime 10.692819, Loss 1.278188, forward nfe 2740, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 011, Runtime 11.038032, Loss 1.142387, forward nfe 3036, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 012, Runtime 10.961179, Loss 0.997701, forward nfe 3332, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 013, Runtime 11.078383, Loss 0.927970, forward nfe 3628, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 014, Runtime 11.508770, Loss 0.877624, forward nfe 3924, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 015, Runtime 11.201660, Loss 0.819311, forward nfe 4220, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 016, Runtime 11.363869, Loss 0.700263, forward nfe 4516, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 017, Runtime 11.562542, Loss 0.693574, forward nfe 4812, backward nfe 0, Train: 0.8500, Val: 0.7088, Test: 0.6924, Best time: 18.2948
Epoch: 018, Runtime 11.710910, Loss 0.608271, forward nfe 5108, backward nfe 0, Train: 0.8786, Val: 0.7257, Test: 0.7360, Best time: 18.2948
Epoch: 019, Runtime 10.092896, Loss 0.638317, forward nfe 5404, backward nfe 0, Train: 0.8929, Val: 0.7360, Test: 0.7330, Best time: 18.2948
Epoch: 020, Runtime 10.004942, Loss 0.626650, forward nfe 5700, backward nfe 0, Train: 0.8929, Val: 0.7360, Test: 0.7330, Best time: 18.2948
Epoch: 021, Runtime 9.971367, Loss 0.584174, forward nfe 5996, backward nfe 0, Train: 0.8929, Val: 0.7360, Test: 0.7330, Best time: 18.2948
Epoch: 022, Runtime 9.856605, Loss 0.557472, forward nfe 6292, backward nfe 0, Train: 0.8929, Val: 0.7360, Test: 0.7330, Best time: 18.2948
Epoch: 023, Runtime 10.364538, Loss 0.564935, forward nfe 6588, backward nfe 0, Train: 0.8786, Val: 0.7434, Test: 0.7594, Best time: 18.2948
Epoch: 024, Runtime 9.891718, Loss 0.541713, forward nfe 6884, backward nfe 0, Train: 0.8929, Val: 0.7581, Test: 0.7655, Best time: 18.2948
Epoch: 025, Runtime 9.275264, Loss 0.584307, forward nfe 7180, backward nfe 0, Train: 0.8714, Val: 0.7669, Test: 0.7716, Best time: 18.2948
Epoch: 026, Runtime 9.782984, Loss 0.537199, forward nfe 7476, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 027, Runtime 9.834193, Loss 0.554071, forward nfe 7772, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 028, Runtime 10.367182, Loss 0.483326, forward nfe 8068, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 029, Runtime 10.171717, Loss 0.550449, forward nfe 8364, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 030, Runtime 10.197679, Loss 0.417045, forward nfe 8660, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 031, Runtime 10.550241, Loss 0.452312, forward nfe 8956, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 032, Runtime 10.497572, Loss 0.375446, forward nfe 9252, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 033, Runtime 10.453990, Loss 0.412793, forward nfe 9548, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 034, Runtime 10.722971, Loss 0.509549, forward nfe 9844, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 035, Runtime 10.550644, Loss 0.411724, forward nfe 10140, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 036, Runtime 10.148690, Loss 0.422728, forward nfe 10436, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 037, Runtime 10.161484, Loss 0.390054, forward nfe 10732, backward nfe 0, Train: 0.9286, Val: 0.7735, Test: 0.7685, Best time: 18.2948
Epoch: 038, Runtime 10.468463, Loss 0.389772, forward nfe 11028, backward nfe 0, Train: 0.9643, Val: 0.7831, Test: 0.7848, Best time: 18.2948
Epoch: 039, Runtime 9.165721, Loss 0.361291, forward nfe 11324, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 040, Runtime 9.311160, Loss 0.471080, forward nfe 11620, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 041, Runtime 9.655049, Loss 0.405878, forward nfe 11916, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 042, Runtime 9.528787, Loss 0.340225, forward nfe 12212, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 043, Runtime 9.760148, Loss 0.435002, forward nfe 12508, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 044, Runtime 10.482970, Loss 0.386552, forward nfe 12804, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 045, Runtime 10.981912, Loss 0.360040, forward nfe 13100, backward nfe 0, Train: 0.9500, Val: 0.7912, Test: 0.8112, Best time: 18.2948
Epoch: 046, Runtime 11.001023, Loss 0.391679, forward nfe 13396, backward nfe 0, Train: 0.9500, Val: 0.7919, Test: 0.7990, Best time: 18.2948
Epoch: 047, Runtime 10.006166, Loss 0.298505, forward nfe 13692, backward nfe 0, Train: 0.9500, Val: 0.7919, Test: 0.7990, Best time: 18.2948
Epoch: 048, Runtime 9.568596, Loss 0.365228, forward nfe 13988, backward nfe 0, Train: 0.9500, Val: 0.7919, Test: 0.7990, Best time: 18.2948
Epoch: 049, Runtime 9.348452, Loss 0.359337, forward nfe 14284, backward nfe 0, Train: 0.9500, Val: 0.7919, Test: 0.7990, Best time: 18.2948
Epoch: 050, Runtime 9.443442, Loss 0.339960, forward nfe 14580, backward nfe 0, Train: 0.9500, Val: 0.7919, Test: 0.7990, Best time: 18.2948
Epoch: 051, Runtime 9.656949, Loss 0.319423, forward nfe 14876, backward nfe 0, Train: 0.9500, Val: 0.7919, Test: 0.7990, Best time: 18.2948
Epoch: 052, Runtime 9.583335, Loss 0.230402, forward nfe 15172, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 053, Runtime 9.021063, Loss 0.403332, forward nfe 15468, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 054, Runtime 9.259788, Loss 0.318423, forward nfe 15764, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 055, Runtime 9.191509, Loss 0.371566, forward nfe 16060, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 056, Runtime 9.326512, Loss 0.271400, forward nfe 16356, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 057, Runtime 9.578523, Loss 0.182125, forward nfe 16652, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 058, Runtime 9.586351, Loss 0.288251, forward nfe 16948, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 059, Runtime 9.799149, Loss 0.213191, forward nfe 17244, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 060, Runtime 10.992025, Loss 0.229312, forward nfe 17540, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 061, Runtime 10.890843, Loss 0.269973, forward nfe 17836, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 062, Runtime 10.994657, Loss 0.269601, forward nfe 18132, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 063, Runtime 11.282176, Loss 0.338462, forward nfe 18428, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 064, Runtime 11.257032, Loss 0.290356, forward nfe 18724, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 065, Runtime 11.267665, Loss 0.293169, forward nfe 19020, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 066, Runtime 11.481012, Loss 0.290076, forward nfe 19316, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 067, Runtime 11.543904, Loss 0.306727, forward nfe 19612, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 068, Runtime 11.503963, Loss 0.214365, forward nfe 19908, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 069, Runtime 11.806135, Loss 0.284841, forward nfe 20204, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 070, Runtime 11.770540, Loss 0.300831, forward nfe 20500, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 071, Runtime 11.839375, Loss 0.306939, forward nfe 20796, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 072, Runtime 11.950658, Loss 0.301132, forward nfe 21092, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 073, Runtime 11.966917, Loss 0.224555, forward nfe 21388, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 074, Runtime 12.129257, Loss 0.292518, forward nfe 21684, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 075, Runtime 12.163133, Loss 0.272731, forward nfe 21980, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 076, Runtime 12.567257, Loss 0.313899, forward nfe 22276, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 077, Runtime 12.032856, Loss 0.243873, forward nfe 22572, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 078, Runtime 12.170690, Loss 0.248124, forward nfe 22868, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 079, Runtime 12.127743, Loss 0.333863, forward nfe 23164, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 080, Runtime 11.790529, Loss 0.247971, forward nfe 23460, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 081, Runtime 11.732597, Loss 0.239221, forward nfe 23756, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 082, Runtime 12.157804, Loss 0.198245, forward nfe 24052, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 083, Runtime 12.003505, Loss 0.269163, forward nfe 24348, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 084, Runtime 12.177255, Loss 0.303891, forward nfe 24644, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 085, Runtime 12.339804, Loss 0.209790, forward nfe 24940, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 086, Runtime 12.225519, Loss 0.188781, forward nfe 25236, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 087, Runtime 12.378284, Loss 0.239416, forward nfe 25532, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 088, Runtime 12.642063, Loss 0.255262, forward nfe 25828, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 089, Runtime 12.335031, Loss 0.306881, forward nfe 26124, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 090, Runtime 12.422485, Loss 0.200771, forward nfe 26420, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 091, Runtime 12.459738, Loss 0.213165, forward nfe 26716, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 092, Runtime 12.549357, Loss 0.262988, forward nfe 27012, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 093, Runtime 12.614148, Loss 0.211604, forward nfe 27308, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 094, Runtime 12.593510, Loss 0.219342, forward nfe 27604, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 095, Runtime 11.916363, Loss 0.131572, forward nfe 27900, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 096, Runtime 11.552818, Loss 0.197777, forward nfe 28196, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 097, Runtime 10.996712, Loss 0.154193, forward nfe 28492, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 098, Runtime 11.576480, Loss 0.220936, forward nfe 28788, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
Epoch: 099, Runtime 11.923440, Loss 0.184675, forward nfe 29084, backward nfe 0, Train: 0.9786, Val: 0.8088, Test: 0.8193, Best time: 18.2948
best val accuracy 0.808824 with test accuracy 0.819289 at epoch 52 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8284263959390863
Entropy Threshold: 2 Test accuracy: 0.8345177664974619
Entropy Threshold: 1.6 Test accuracy: 0.8379772961816305
Entropy Threshold: 1.5 Test accuracy: 0.8428720083246618
Entropy Threshold: 1.4 Test accuracy: 0.8515789473684211
Entropy Threshold: 1.3 Test accuracy: 0.8492569002123143
Entropy Threshold: 1.2 Test accuracy: 0.8583783783783784
Entropy Threshold: 1.1 Test accuracy: 0.8631813125695217
Entropy Threshold: 0.9 Test accuracy: 0.8892857142857142
Entropy Threshold: 0.8 Test accuracy: 0.8891595615103532
Entropy Threshold: 0.7 Test accuracy: 0.9110824742268041
Entropy Threshold: 0.6 Test accuracy: 0.9195088676671214
Entropy Threshold: 0.5 Test accuracy: 0.9316239316239316
Entropy Threshold: 0.4 Test accuracy: 0.9357798165137615
Entropy Threshold: 0.3 Test accuracy: 0.935064935064935
Entropy Threshold: 0.2 Test accuracy: 0.9515260323159784
Entropy Threshold: 0.1 Test accuracy: 0.9567099567099567
