[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 9.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 12.857553, Loss 6.880512, forward nfe 76, backward nfe 0, Train: 0.1643, Val: 0.1765, Test: 0.1838, Best time: 1.0000
Epoch: 002, Runtime 12.119589, Loss 8.672214, forward nfe 372, backward nfe 0, Train: 0.4071, Val: 0.3441, Test: 0.3472, Best time: 1.0000
Epoch: 003, Runtime 11.396125, Loss 6.470153, forward nfe 668, backward nfe 0, Train: 0.6143, Val: 0.5088, Test: 0.4934, Best time: 1.0000
Epoch: 004, Runtime 11.165640, Loss 6.159272, forward nfe 964, backward nfe 0, Train: 0.6643, Val: 0.6243, Test: 0.6102, Best time: 4.0000
Epoch: 005, Runtime 11.552022, Loss 5.336932, forward nfe 1260, backward nfe 0, Train: 0.6643, Val: 0.6890, Test: 0.6619, Best time: 9.0000
Epoch: 006, Runtime 13.422230, Loss 4.670668, forward nfe 1556, backward nfe 0, Train: 0.7071, Val: 0.7243, Test: 0.6985, Best time: 19.0000
Epoch: 007, Runtime 13.844378, Loss 4.627363, forward nfe 1852, backward nfe 0, Train: 0.7357, Val: 0.7735, Test: 0.7269, Best time: 44.0000
Epoch: 008, Runtime 13.866681, Loss 4.198380, forward nfe 2148, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 40.0000
Epoch: 009, Runtime 13.911064, Loss 3.848284, forward nfe 2444, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 010, Runtime 13.598981, Loss 3.455385, forward nfe 2740, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 011, Runtime 14.034683, Loss 3.340398, forward nfe 3036, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 012, Runtime 14.234457, Loss 2.647433, forward nfe 3332, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 013, Runtime 14.439899, Loss 2.868408, forward nfe 3628, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 014, Runtime 14.743679, Loss 2.501184, forward nfe 3924, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 015, Runtime 14.904352, Loss 2.580798, forward nfe 4220, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 016, Runtime 15.268857, Loss 2.707475, forward nfe 4516, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 017, Runtime 15.598866, Loss 2.305913, forward nfe 4812, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 018, Runtime 15.619803, Loss 2.387553, forward nfe 5108, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 019, Runtime 16.134900, Loss 2.551209, forward nfe 5404, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 020, Runtime 16.279068, Loss 2.223151, forward nfe 5700, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 021, Runtime 17.482323, Loss 2.436506, forward nfe 5996, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 022, Runtime 16.948001, Loss 2.195987, forward nfe 6292, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 023, Runtime 16.813291, Loss 2.575914, forward nfe 6588, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 024, Runtime 17.414047, Loss 2.174128, forward nfe 6884, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 025, Runtime 17.438223, Loss 2.220822, forward nfe 7180, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 026, Runtime 17.340471, Loss 2.271229, forward nfe 7476, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 027, Runtime 18.056057, Loss 2.085635, forward nfe 7772, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 028, Runtime 18.466132, Loss 2.165387, forward nfe 8068, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 029, Runtime 18.960403, Loss 2.201453, forward nfe 8364, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 030, Runtime 18.702954, Loss 2.138242, forward nfe 8660, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 031, Runtime 18.399258, Loss 1.924149, forward nfe 8956, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 032, Runtime 18.533448, Loss 1.876146, forward nfe 9252, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 033, Runtime 18.691273, Loss 2.073532, forward nfe 9548, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 034, Runtime 18.366236, Loss 2.037962, forward nfe 9844, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 035, Runtime 18.447237, Loss 1.970410, forward nfe 10140, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 036, Runtime 19.037436, Loss 1.820907, forward nfe 10436, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 037, Runtime 18.594581, Loss 1.829278, forward nfe 10732, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 038, Runtime 18.862506, Loss 1.760951, forward nfe 11028, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 039, Runtime 18.919787, Loss 1.986388, forward nfe 11324, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 040, Runtime 19.022305, Loss 1.664188, forward nfe 11620, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 041, Runtime 18.989688, Loss 1.779573, forward nfe 11916, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 042, Runtime 19.137043, Loss 1.803039, forward nfe 12212, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 043, Runtime 19.592963, Loss 1.807099, forward nfe 12508, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 044, Runtime 19.390806, Loss 1.839306, forward nfe 12804, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 045, Runtime 18.542501, Loss 1.814288, forward nfe 13100, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 046, Runtime 18.305980, Loss 1.887097, forward nfe 13396, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 047, Runtime 13.496929, Loss 1.674168, forward nfe 13692, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 048, Runtime 13.069559, Loss 1.502984, forward nfe 13988, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 049, Runtime 12.585735, Loss 1.564204, forward nfe 14284, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 050, Runtime 12.980873, Loss 1.772793, forward nfe 14580, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 051, Runtime 12.577908, Loss 1.627172, forward nfe 14876, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 052, Runtime 13.121134, Loss 1.698181, forward nfe 15172, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 053, Runtime 12.721098, Loss 1.757599, forward nfe 15468, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 054, Runtime 13.294466, Loss 1.670067, forward nfe 15764, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 055, Runtime 12.809595, Loss 1.598481, forward nfe 16060, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 056, Runtime 13.506441, Loss 1.517865, forward nfe 16356, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 057, Runtime 12.887471, Loss 1.458012, forward nfe 16652, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 058, Runtime 13.444300, Loss 1.665847, forward nfe 16948, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 059, Runtime 12.863930, Loss 1.240553, forward nfe 17244, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 060, Runtime 13.275265, Loss 1.442097, forward nfe 17540, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 061, Runtime 13.292911, Loss 1.470738, forward nfe 17836, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 062, Runtime 13.810244, Loss 1.423710, forward nfe 18132, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 063, Runtime 13.239316, Loss 1.210032, forward nfe 18428, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 064, Runtime 13.924690, Loss 1.567381, forward nfe 18724, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 065, Runtime 13.649214, Loss 1.382690, forward nfe 19020, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 066, Runtime 13.962140, Loss 1.549249, forward nfe 19316, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 067, Runtime 13.645723, Loss 1.444760, forward nfe 19612, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 068, Runtime 14.075470, Loss 1.380709, forward nfe 19908, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 069, Runtime 14.010513, Loss 1.420436, forward nfe 20204, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 070, Runtime 14.690560, Loss 1.467318, forward nfe 20500, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 071, Runtime 14.537922, Loss 1.333271, forward nfe 20796, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 072, Runtime 14.749624, Loss 1.369992, forward nfe 21092, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 073, Runtime 14.983817, Loss 1.037395, forward nfe 21388, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 074, Runtime 15.233402, Loss 1.290653, forward nfe 21684, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 075, Runtime 15.194317, Loss 1.137694, forward nfe 21980, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 076, Runtime 15.632693, Loss 1.081900, forward nfe 22276, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 077, Runtime 15.914651, Loss 1.036094, forward nfe 22572, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 078, Runtime 15.880078, Loss 1.091911, forward nfe 22868, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 079, Runtime 16.671996, Loss 1.188099, forward nfe 23164, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 080, Runtime 17.017988, Loss 1.015218, forward nfe 23460, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 081, Runtime 16.280555, Loss 1.046659, forward nfe 23756, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 082, Runtime 16.805138, Loss 1.122590, forward nfe 24052, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 083, Runtime 16.861809, Loss 1.168456, forward nfe 24348, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 084, Runtime 17.924651, Loss 1.197626, forward nfe 24644, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 085, Runtime 17.690254, Loss 1.031095, forward nfe 24940, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 086, Runtime 17.596385, Loss 0.935276, forward nfe 25236, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 087, Runtime 18.238463, Loss 1.059618, forward nfe 25532, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 088, Runtime 18.429857, Loss 1.159594, forward nfe 25828, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 089, Runtime 18.596700, Loss 1.156343, forward nfe 26124, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 090, Runtime 18.712531, Loss 1.078229, forward nfe 26420, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 091, Runtime 18.671760, Loss 1.148494, forward nfe 26716, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 092, Runtime 18.896443, Loss 1.092390, forward nfe 27012, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 093, Runtime 20.636675, Loss 0.979239, forward nfe 27308, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 094, Runtime 19.819802, Loss 1.125318, forward nfe 27604, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 095, Runtime 19.694781, Loss 0.849307, forward nfe 27900, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 096, Runtime 19.369390, Loss 1.191365, forward nfe 28196, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 097, Runtime 18.935096, Loss 1.104531, forward nfe 28492, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 098, Runtime 19.119021, Loss 0.997828, forward nfe 28788, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
Epoch: 099, Runtime 18.687446, Loss 0.908102, forward nfe 29084, backward nfe 0, Train: 0.8143, Val: 0.7949, Test: 0.7736, Best time: 18.2948
best val accuracy 0.794853 with test accuracy 0.773604 at epoch 8 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.233502538071066
Entropy Threshold: 2 Test accuracy: 0.23045685279187816
Entropy Threshold: 1.6 Test accuracy: 0.4069767441860465
Entropy Threshold: 1.5 Test accuracy: 0.55
Entropy Threshold: 1.4 Test accuracy: 0.6363636363636364
Entropy Threshold: 1.3 Test accuracy: 0.8
Entropy Threshold: 1.2 Test accuracy: 1.0
Entropy Threshold: 1.1 Test accuracy: 1.0
Entropy Threshold: 0.9 Test accuracy: 1.0
Entropy Threshold: 0.8 Test accuracy: None
Entropy Threshold: 0.7 Test accuracy: None
Entropy Threshold: 0.6 Test accuracy: None
Entropy Threshold: 0.5 Test accuracy: None
Entropy Threshold: 0.4 Test accuracy: None
Entropy Threshold: 0.3 Test accuracy: None
Entropy Threshold: 0.2 Test accuracy: None
Entropy Threshold: 0.1 Test accuracy: None
