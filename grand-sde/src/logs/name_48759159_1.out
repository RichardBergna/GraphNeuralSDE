[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.2
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.120571, Loss 2.142135, forward nfe 76, backward nfe 0, Train: 0.6714, Val: 0.5662, Test: 0.5766, Best time: 4.0000
Epoch: 002, Runtime 10.327932, Loss 2.336839, forward nfe 372, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 2.0000
Epoch: 003, Runtime 9.902329, Loss 2.127078, forward nfe 668, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 004, Runtime 10.433635, Loss 2.045958, forward nfe 964, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 005, Runtime 10.429471, Loss 1.917249, forward nfe 1260, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 006, Runtime 10.929974, Loss 1.908793, forward nfe 1556, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 007, Runtime 11.412855, Loss 1.793553, forward nfe 1852, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 008, Runtime 11.404970, Loss 1.707716, forward nfe 2148, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 009, Runtime 10.817696, Loss 1.539762, forward nfe 2444, backward nfe 0, Train: 0.7786, Val: 0.6618, Test: 0.6538, Best time: 18.2948
Epoch: 010, Runtime 11.005765, Loss 1.399371, forward nfe 2740, backward nfe 0, Train: 0.8071, Val: 0.6882, Test: 0.6843, Best time: 11.0000
Epoch: 011, Runtime 10.286792, Loss 1.303273, forward nfe 3036, backward nfe 0, Train: 0.8143, Val: 0.7228, Test: 0.7188, Best time: 9.0000
Epoch: 012, Runtime 10.042147, Loss 1.226685, forward nfe 3332, backward nfe 0, Train: 0.8571, Val: 0.7397, Test: 0.7299, Best time: 20.0000
Epoch: 013, Runtime 10.070501, Loss 1.084269, forward nfe 3628, backward nfe 0, Train: 0.8857, Val: 0.7596, Test: 0.7391, Best time: 18.0000
Epoch: 014, Runtime 10.464225, Loss 0.975974, forward nfe 3924, backward nfe 0, Train: 0.8857, Val: 0.7596, Test: 0.7391, Best time: 18.2948
Epoch: 015, Runtime 10.236755, Loss 0.883450, forward nfe 4220, backward nfe 0, Train: 0.8857, Val: 0.7596, Test: 0.7391, Best time: 18.2948
Epoch: 016, Runtime 10.598439, Loss 0.900563, forward nfe 4516, backward nfe 0, Train: 0.9000, Val: 0.7610, Test: 0.7391, Best time: 13.0000
Epoch: 017, Runtime 10.051068, Loss 0.774005, forward nfe 4812, backward nfe 0, Train: 0.9143, Val: 0.7618, Test: 0.7523, Best time: 22.0000
Epoch: 018, Runtime 10.194971, Loss 0.797835, forward nfe 5108, backward nfe 0, Train: 0.9286, Val: 0.7706, Test: 0.7594, Best time: 21.0000
Epoch: 019, Runtime 10.183090, Loss 0.765977, forward nfe 5404, backward nfe 0, Train: 0.9214, Val: 0.7772, Test: 0.7695, Best time: 19.0000
Epoch: 020, Runtime 10.000728, Loss 0.676376, forward nfe 5700, backward nfe 0, Train: 0.9286, Val: 0.7853, Test: 0.7777, Best time: 20.0000
Epoch: 021, Runtime 10.362823, Loss 0.685587, forward nfe 5996, backward nfe 0, Train: 0.9143, Val: 0.7897, Test: 0.7827, Best time: 17.0000
Epoch: 022, Runtime 9.826247, Loss 0.683518, forward nfe 6292, backward nfe 0, Train: 0.9071, Val: 0.7912, Test: 0.7716, Best time: 9.0000
Epoch: 023, Runtime 10.187966, Loss 0.627192, forward nfe 6588, backward nfe 0, Train: 0.9357, Val: 0.8000, Test: 0.7888, Best time: 31.0000
Epoch: 024, Runtime 9.902469, Loss 0.624431, forward nfe 6884, backward nfe 0, Train: 0.9500, Val: 0.8007, Test: 0.7949, Best time: 39.0000
Epoch: 025, Runtime 9.730800, Loss 0.503309, forward nfe 7180, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 026, Runtime 9.962088, Loss 0.589637, forward nfe 7476, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 027, Runtime 10.210047, Loss 0.593895, forward nfe 7772, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 028, Runtime 10.248173, Loss 0.541862, forward nfe 8068, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 029, Runtime 10.210731, Loss 0.521593, forward nfe 8364, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 030, Runtime 10.470818, Loss 0.507998, forward nfe 8660, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 031, Runtime 10.282128, Loss 0.481230, forward nfe 8956, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 032, Runtime 10.076138, Loss 0.526949, forward nfe 9252, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 033, Runtime 10.901849, Loss 0.448691, forward nfe 9548, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 034, Runtime 11.202214, Loss 0.467373, forward nfe 9844, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 035, Runtime 11.106475, Loss 0.386385, forward nfe 10140, backward nfe 0, Train: 0.9429, Val: 0.8074, Test: 0.7939, Best time: 18.2948
Epoch: 036, Runtime 11.293873, Loss 0.472890, forward nfe 10436, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 037, Runtime 9.654680, Loss 0.471118, forward nfe 10732, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 038, Runtime 10.168390, Loss 0.364734, forward nfe 11028, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 039, Runtime 9.810715, Loss 0.436340, forward nfe 11324, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 040, Runtime 9.872775, Loss 0.443230, forward nfe 11620, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 041, Runtime 10.042084, Loss 0.440001, forward nfe 11916, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 042, Runtime 9.938050, Loss 0.385049, forward nfe 12212, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 043, Runtime 10.425992, Loss 0.404137, forward nfe 12508, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 044, Runtime 10.313249, Loss 0.427230, forward nfe 12804, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 045, Runtime 10.270535, Loss 0.371103, forward nfe 13100, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 046, Runtime 10.169340, Loss 0.352837, forward nfe 13396, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 047, Runtime 10.379752, Loss 0.366742, forward nfe 13692, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 048, Runtime 10.597456, Loss 0.324806, forward nfe 13988, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 049, Runtime 10.316236, Loss 0.439577, forward nfe 14284, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 050, Runtime 10.882860, Loss 0.366296, forward nfe 14580, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 051, Runtime 10.687535, Loss 0.365222, forward nfe 14876, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 052, Runtime 10.725824, Loss 0.399723, forward nfe 15172, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 053, Runtime 10.740393, Loss 0.362977, forward nfe 15468, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 054, Runtime 10.790080, Loss 0.314936, forward nfe 15764, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 055, Runtime 10.988304, Loss 0.355997, forward nfe 16060, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 056, Runtime 10.956756, Loss 0.363444, forward nfe 16356, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 057, Runtime 11.087998, Loss 0.309789, forward nfe 16652, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 058, Runtime 10.936424, Loss 0.285339, forward nfe 16948, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 059, Runtime 11.850454, Loss 0.317704, forward nfe 17244, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 060, Runtime 11.999254, Loss 0.355824, forward nfe 17540, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 061, Runtime 12.105820, Loss 0.445198, forward nfe 17836, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 062, Runtime 12.221380, Loss 0.287925, forward nfe 18132, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 063, Runtime 12.254322, Loss 0.318708, forward nfe 18428, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 064, Runtime 12.256796, Loss 0.304230, forward nfe 18724, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 065, Runtime 12.322456, Loss 0.377219, forward nfe 19020, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 066, Runtime 12.302635, Loss 0.335485, forward nfe 19316, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 067, Runtime 12.346641, Loss 0.310336, forward nfe 19612, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 068, Runtime 12.380492, Loss 0.301656, forward nfe 19908, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 069, Runtime 12.348626, Loss 0.256561, forward nfe 20204, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 070, Runtime 12.509209, Loss 0.299494, forward nfe 20500, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 071, Runtime 12.432260, Loss 0.227494, forward nfe 20796, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 072, Runtime 12.641927, Loss 0.309148, forward nfe 21092, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 073, Runtime 12.339468, Loss 0.361159, forward nfe 21388, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 074, Runtime 12.746709, Loss 0.389230, forward nfe 21684, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 075, Runtime 12.433427, Loss 0.279455, forward nfe 21980, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 076, Runtime 12.747014, Loss 0.324222, forward nfe 22276, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 077, Runtime 12.583778, Loss 0.310217, forward nfe 22572, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 078, Runtime 11.597545, Loss 0.286269, forward nfe 22868, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 079, Runtime 10.867162, Loss 0.259120, forward nfe 23164, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 080, Runtime 12.213189, Loss 0.265854, forward nfe 23460, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 081, Runtime 12.507683, Loss 0.269618, forward nfe 23756, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 082, Runtime 12.777709, Loss 0.264268, forward nfe 24052, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 083, Runtime 12.483118, Loss 0.255622, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 084, Runtime 12.745651, Loss 0.268478, forward nfe 24644, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 085, Runtime 12.499613, Loss 0.261920, forward nfe 24940, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 086, Runtime 12.717280, Loss 0.279317, forward nfe 25236, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 087, Runtime 12.610701, Loss 0.281689, forward nfe 25532, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 088, Runtime 12.844507, Loss 0.338633, forward nfe 25828, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 089, Runtime 12.663556, Loss 0.276818, forward nfe 26124, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 090, Runtime 12.802607, Loss 0.256169, forward nfe 26420, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 091, Runtime 12.580602, Loss 0.284787, forward nfe 26716, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 092, Runtime 12.711529, Loss 0.286989, forward nfe 27012, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 093, Runtime 12.654882, Loss 0.217453, forward nfe 27308, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 094, Runtime 12.311006, Loss 0.233245, forward nfe 27604, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 095, Runtime 11.048970, Loss 0.254729, forward nfe 27900, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 096, Runtime 11.327699, Loss 0.255472, forward nfe 28196, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 097, Runtime 11.316961, Loss 0.300062, forward nfe 28492, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 098, Runtime 12.012659, Loss 0.299672, forward nfe 28788, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
Epoch: 099, Runtime 11.940960, Loss 0.223875, forward nfe 29084, backward nfe 0, Train: 0.9429, Val: 0.8125, Test: 0.8051, Best time: 18.2948
best val accuracy 0.812500 with test accuracy 0.805076 at epoch 36 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8294416243654822
Entropy Threshold: 2 Test accuracy: 0.8233502538071066
Entropy Threshold: 1.6 Test accuracy: 0.8402489626556017
Entropy Threshold: 1.5 Test accuracy: 0.8422712933753943
Entropy Threshold: 1.4 Test accuracy: 0.8505376344086022
Entropy Threshold: 1.3 Test accuracy: 0.8585635359116022
Entropy Threshold: 1.2 Test accuracy: 0.8624577226606539
Entropy Threshold: 1.1 Test accuracy: 0.872093023255814
Entropy Threshold: 0.9 Test accuracy: 0.8958868894601543
Entropy Threshold: 0.8 Test accuracy: 0.901595744680851
Entropy Threshold: 0.7 Test accuracy: 0.9069111424541608
Entropy Threshold: 0.6 Test accuracy: 0.9154302670623146
Entropy Threshold: 0.5 Test accuracy: 0.9227129337539433
Entropy Threshold: 0.4 Test accuracy: 0.9302325581395349
Entropy Threshold: 0.3 Test accuracy: 0.9385171790235082
Entropy Threshold: 0.2 Test accuracy: 0.9436619718309859
Entropy Threshold: 0.1 Test accuracy: 0.946969696969697
