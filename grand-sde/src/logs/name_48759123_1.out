[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.1
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 10.440346, Loss 2.178873, forward nfe 76, backward nfe 0, Train: 0.4000, Val: 0.4007, Test: 0.4305, Best time: 1.0000
Epoch: 002, Runtime 9.148329, Loss 2.589921, forward nfe 372, backward nfe 0, Train: 0.4000, Val: 0.4007, Test: 0.4305, Best time: 18.2948
Epoch: 003, Runtime 9.737086, Loss 2.131154, forward nfe 668, backward nfe 0, Train: 0.4000, Val: 0.4007, Test: 0.4305, Best time: 18.2948
Epoch: 004, Runtime 9.657926, Loss 2.075985, forward nfe 964, backward nfe 0, Train: 0.5000, Val: 0.4162, Test: 0.4447, Best time: 8.0000
Epoch: 005, Runtime 9.325101, Loss 1.943579, forward nfe 1260, backward nfe 0, Train: 0.4929, Val: 0.4191, Test: 0.4416, Best time: 7.0000
Epoch: 006, Runtime 8.997921, Loss 1.997917, forward nfe 1556, backward nfe 0, Train: 0.4929, Val: 0.4191, Test: 0.4416, Best time: 18.2948
Epoch: 007, Runtime 9.635315, Loss 1.944816, forward nfe 1852, backward nfe 0, Train: 0.4929, Val: 0.4191, Test: 0.4416, Best time: 18.2948
Epoch: 008, Runtime 9.630625, Loss 1.809911, forward nfe 2148, backward nfe 0, Train: 0.4929, Val: 0.4191, Test: 0.4416, Best time: 18.2948
Epoch: 009, Runtime 9.318826, Loss 1.750418, forward nfe 2444, backward nfe 0, Train: 0.5929, Val: 0.4449, Test: 0.4437, Best time: 13.0000
Epoch: 010, Runtime 9.418500, Loss 1.723058, forward nfe 2740, backward nfe 0, Train: 0.6286, Val: 0.4897, Test: 0.4843, Best time: 14.0000
Epoch: 011, Runtime 9.264854, Loss 1.563440, forward nfe 3036, backward nfe 0, Train: 0.6429, Val: 0.5206, Test: 0.5127, Best time: 18.0000
Epoch: 012, Runtime 9.330502, Loss 1.572408, forward nfe 3332, backward nfe 0, Train: 0.6643, Val: 0.5478, Test: 0.5360, Best time: 24.0000
Epoch: 013, Runtime 9.255500, Loss 1.484315, forward nfe 3628, backward nfe 0, Train: 0.7000, Val: 0.5640, Test: 0.5645, Best time: 8.0000
Epoch: 014, Runtime 9.357232, Loss 1.392236, forward nfe 3924, backward nfe 0, Train: 0.7357, Val: 0.5794, Test: 0.5858, Best time: 14.0000
Epoch: 015, Runtime 9.629716, Loss 1.320531, forward nfe 4220, backward nfe 0, Train: 0.7429, Val: 0.5956, Test: 0.5990, Best time: 12.0000
Epoch: 016, Runtime 9.181086, Loss 1.127668, forward nfe 4516, backward nfe 0, Train: 0.7429, Val: 0.6096, Test: 0.6102, Best time: 14.0000
Epoch: 017, Runtime 9.473999, Loss 1.059635, forward nfe 4812, backward nfe 0, Train: 0.7571, Val: 0.6272, Test: 0.6193, Best time: 27.0000
Epoch: 018, Runtime 9.573448, Loss 1.091024, forward nfe 5108, backward nfe 0, Train: 0.7857, Val: 0.6390, Test: 0.6386, Best time: 22.0000
Epoch: 019, Runtime 9.482444, Loss 0.965853, forward nfe 5404, backward nfe 0, Train: 0.7929, Val: 0.6632, Test: 0.6528, Best time: 18.2948
Epoch: 020, Runtime 9.034120, Loss 0.930572, forward nfe 5700, backward nfe 0, Train: 0.7643, Val: 0.6757, Test: 0.6863, Best time: 18.2948
Epoch: 021, Runtime 9.323100, Loss 0.855035, forward nfe 5996, backward nfe 0, Train: 0.7643, Val: 0.6757, Test: 0.6863, Best time: 18.2948
Epoch: 022, Runtime 9.870210, Loss 0.780251, forward nfe 6292, backward nfe 0, Train: 0.8429, Val: 0.6904, Test: 0.7036, Best time: 18.2948
Epoch: 023, Runtime 9.478818, Loss 0.736191, forward nfe 6588, backward nfe 0, Train: 0.8071, Val: 0.6919, Test: 0.7056, Best time: 18.2948
Epoch: 024, Runtime 8.955790, Loss 0.677198, forward nfe 6884, backward nfe 0, Train: 0.8286, Val: 0.6956, Test: 0.7015, Best time: 18.2948
Epoch: 025, Runtime 9.413108, Loss 0.737147, forward nfe 7180, backward nfe 0, Train: 0.8643, Val: 0.6963, Test: 0.7168, Best time: 18.0000
Epoch: 026, Runtime 9.458769, Loss 0.699672, forward nfe 7476, backward nfe 0, Train: 0.8857, Val: 0.7125, Test: 0.7350, Best time: 17.0000
Epoch: 027, Runtime 9.379343, Loss 0.706163, forward nfe 7772, backward nfe 0, Train: 0.9000, Val: 0.7221, Test: 0.7472, Best time: 22.0000
Epoch: 028, Runtime 9.304367, Loss 0.570771, forward nfe 8068, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 029, Runtime 9.227461, Loss 0.662148, forward nfe 8364, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 030, Runtime 9.818062, Loss 0.659927, forward nfe 8660, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 031, Runtime 9.191073, Loss 0.626959, forward nfe 8956, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 032, Runtime 9.711918, Loss 0.674754, forward nfe 9252, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 033, Runtime 9.930040, Loss 0.595426, forward nfe 9548, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 034, Runtime 9.880040, Loss 0.547610, forward nfe 9844, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 035, Runtime 9.844775, Loss 0.563278, forward nfe 10140, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 036, Runtime 10.273666, Loss 0.508200, forward nfe 10436, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 037, Runtime 10.334779, Loss 0.484498, forward nfe 10732, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 038, Runtime 9.940435, Loss 0.562125, forward nfe 11028, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 039, Runtime 10.414757, Loss 0.510502, forward nfe 11324, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 040, Runtime 10.799494, Loss 0.530601, forward nfe 11620, backward nfe 0, Train: 0.8714, Val: 0.7368, Test: 0.7513, Best time: 18.2948
Epoch: 041, Runtime 10.221946, Loss 0.482772, forward nfe 11916, backward nfe 0, Train: 0.9571, Val: 0.7441, Test: 0.7787, Best time: 36.0000
Epoch: 042, Runtime 9.389298, Loss 0.519784, forward nfe 12212, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 043, Runtime 9.425224, Loss 0.440308, forward nfe 12508, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 044, Runtime 9.362751, Loss 0.481564, forward nfe 12804, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 045, Runtime 9.422582, Loss 0.447021, forward nfe 13100, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 046, Runtime 9.592969, Loss 0.428695, forward nfe 13396, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 047, Runtime 10.068690, Loss 0.410528, forward nfe 13692, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 048, Runtime 9.442060, Loss 0.466901, forward nfe 13988, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 049, Runtime 10.058722, Loss 0.413719, forward nfe 14284, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 050, Runtime 10.310425, Loss 0.352158, forward nfe 14580, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 051, Runtime 9.842139, Loss 0.302613, forward nfe 14876, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 052, Runtime 10.251548, Loss 0.420773, forward nfe 15172, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 053, Runtime 10.561862, Loss 0.443026, forward nfe 15468, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 054, Runtime 10.277985, Loss 0.316642, forward nfe 15764, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 055, Runtime 10.478695, Loss 0.299098, forward nfe 16060, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 056, Runtime 10.771139, Loss 0.411294, forward nfe 16356, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 057, Runtime 10.782585, Loss 0.379192, forward nfe 16652, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 058, Runtime 10.645461, Loss 0.448962, forward nfe 16948, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 059, Runtime 10.991441, Loss 0.396273, forward nfe 17244, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 060, Runtime 10.983048, Loss 0.318624, forward nfe 17540, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 061, Runtime 10.840436, Loss 0.295172, forward nfe 17836, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 062, Runtime 11.259709, Loss 0.348483, forward nfe 18132, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 063, Runtime 11.189272, Loss 0.356342, forward nfe 18428, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 064, Runtime 11.110316, Loss 0.345847, forward nfe 18724, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 065, Runtime 11.362036, Loss 0.343277, forward nfe 19020, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 066, Runtime 11.096874, Loss 0.271234, forward nfe 19316, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 067, Runtime 11.381127, Loss 0.272494, forward nfe 19612, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 068, Runtime 11.706693, Loss 0.286045, forward nfe 19908, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 069, Runtime 11.001754, Loss 0.281102, forward nfe 20204, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 070, Runtime 11.451304, Loss 0.340174, forward nfe 20500, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 071, Runtime 11.810868, Loss 0.333413, forward nfe 20796, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 072, Runtime 11.086683, Loss 0.312088, forward nfe 21092, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 073, Runtime 11.577487, Loss 0.263395, forward nfe 21388, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 074, Runtime 11.750270, Loss 0.275428, forward nfe 21684, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 075, Runtime 11.206874, Loss 0.230348, forward nfe 21980, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 076, Runtime 11.677253, Loss 0.242890, forward nfe 22276, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 077, Runtime 11.917676, Loss 0.255299, forward nfe 22572, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 078, Runtime 11.395113, Loss 0.270735, forward nfe 22868, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 079, Runtime 11.690629, Loss 0.256747, forward nfe 23164, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 080, Runtime 12.032357, Loss 0.304829, forward nfe 23460, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 081, Runtime 11.665160, Loss 0.265119, forward nfe 23756, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 082, Runtime 11.834726, Loss 0.240270, forward nfe 24052, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 083, Runtime 11.858122, Loss 0.344705, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 084, Runtime 11.748237, Loss 0.273594, forward nfe 24644, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 085, Runtime 11.866943, Loss 0.341628, forward nfe 24940, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 086, Runtime 11.540873, Loss 0.308489, forward nfe 25236, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 087, Runtime 11.929427, Loss 0.249342, forward nfe 25532, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 088, Runtime 12.174085, Loss 0.249408, forward nfe 25828, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 089, Runtime 11.633158, Loss 0.223992, forward nfe 26124, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 090, Runtime 11.875892, Loss 0.249636, forward nfe 26420, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 091, Runtime 12.037151, Loss 0.203174, forward nfe 26716, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 092, Runtime 11.590945, Loss 0.228842, forward nfe 27012, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 093, Runtime 12.035486, Loss 0.338127, forward nfe 27308, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 094, Runtime 11.845762, Loss 0.281893, forward nfe 27604, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 095, Runtime 11.805861, Loss 0.284502, forward nfe 27900, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 096, Runtime 12.104980, Loss 0.224324, forward nfe 28196, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 097, Runtime 11.526674, Loss 0.233015, forward nfe 28492, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 098, Runtime 11.961195, Loss 0.337061, forward nfe 28788, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
Epoch: 099, Runtime 12.204736, Loss 0.284496, forward nfe 29084, backward nfe 0, Train: 0.9429, Val: 0.7588, Test: 0.7695, Best time: 18.2948
best val accuracy 0.758824 with test accuracy 0.769543 at epoch 42 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.7959390862944162
Entropy Threshold: 2 Test accuracy: 0.7959390862944162
Entropy Threshold: 1.6 Test accuracy: 0.8016528925619835
Entropy Threshold: 1.5 Test accuracy: 0.8073684210526316
Entropy Threshold: 1.4 Test accuracy: 0.822198275862069
Entropy Threshold: 1.3 Test accuracy: 0.8272425249169435
Entropy Threshold: 1.2 Test accuracy: 0.8373702422145328
Entropy Threshold: 1.1 Test accuracy: 0.847457627118644
Entropy Threshold: 0.9 Test accuracy: 0.8695073235685752
Entropy Threshold: 0.8 Test accuracy: 0.8815977175463623
Entropy Threshold: 0.7 Test accuracy: 0.8923766816143498
Entropy Threshold: 0.6 Test accuracy: 0.8998384491114702
Entropy Threshold: 0.5 Test accuracy: 0.9073426573426573
Entropy Threshold: 0.4 Test accuracy: 0.9202226345083488
Entropy Threshold: 0.3 Test accuracy: 0.917184265010352
Entropy Threshold: 0.2 Test accuracy: 0.9328537170263789
Entropy Threshold: 0.1 Test accuracy: 0.9424242424242424
