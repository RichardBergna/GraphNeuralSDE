[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.5
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 10.047596, Loss 2.103661, forward nfe 76, backward nfe 0, Train: 0.5429, Val: 0.4890, Test: 0.4538, Best time: 2.0000
Epoch: 002, Runtime 10.041190, Loss 2.084402, forward nfe 372, backward nfe 0, Train: 0.5429, Val: 0.4890, Test: 0.4538, Best time: 18.2948
Epoch: 003, Runtime 9.587816, Loss 1.952345, forward nfe 668, backward nfe 0, Train: 0.5429, Val: 0.4890, Test: 0.4538, Best time: 18.2948
Epoch: 004, Runtime 9.450991, Loss 1.791649, forward nfe 964, backward nfe 0, Train: 0.6857, Val: 0.4926, Test: 0.4904, Best time: 2.0000
Epoch: 005, Runtime 9.260894, Loss 1.654554, forward nfe 1260, backward nfe 0, Train: 0.7571, Val: 0.5625, Test: 0.5685, Best time: 4.0000
Epoch: 006, Runtime 9.195543, Loss 1.511397, forward nfe 1556, backward nfe 0, Train: 0.7714, Val: 0.5824, Test: 0.5756, Best time: 3.0000
Epoch: 007, Runtime 9.327138, Loss 1.282122, forward nfe 1852, backward nfe 0, Train: 0.7857, Val: 0.6015, Test: 0.5807, Best time: 3.0000
Epoch: 008, Runtime 9.374449, Loss 1.116512, forward nfe 2148, backward nfe 0, Train: 0.8143, Val: 0.6529, Test: 0.6284, Best time: 8.0000
Epoch: 009, Runtime 9.429374, Loss 0.959566, forward nfe 2444, backward nfe 0, Train: 0.8286, Val: 0.7456, Test: 0.7239, Best time: 23.0000
Epoch: 010, Runtime 9.526327, Loss 0.800606, forward nfe 2740, backward nfe 0, Train: 0.9214, Val: 0.7949, Test: 0.7817, Best time: 8.0000
Epoch: 011, Runtime 9.370792, Loss 0.636555, forward nfe 3036, backward nfe 0, Train: 0.9143, Val: 0.8169, Test: 0.8071, Best time: 14.0000
Epoch: 012, Runtime 9.222275, Loss 0.645996, forward nfe 3332, backward nfe 0, Train: 0.9214, Val: 0.8191, Test: 0.8112, Best time: 10.0000
Epoch: 013, Runtime 9.551010, Loss 0.490696, forward nfe 3628, backward nfe 0, Train: 0.9214, Val: 0.8191, Test: 0.8112, Best time: 18.2948
Epoch: 014, Runtime 9.753078, Loss 0.473750, forward nfe 3924, backward nfe 0, Train: 0.9214, Val: 0.8191, Test: 0.8112, Best time: 18.2948
Epoch: 015, Runtime 9.573901, Loss 0.452672, forward nfe 4220, backward nfe 0, Train: 0.9214, Val: 0.8191, Test: 0.8112, Best time: 18.2948
Epoch: 016, Runtime 9.637486, Loss 0.413014, forward nfe 4516, backward nfe 0, Train: 0.9214, Val: 0.8191, Test: 0.8112, Best time: 18.2948
Epoch: 017, Runtime 10.009790, Loss 0.416137, forward nfe 4812, backward nfe 0, Train: 0.9214, Val: 0.8191, Test: 0.8112, Best time: 18.2948
Epoch: 018, Runtime 10.198125, Loss 0.438732, forward nfe 5108, backward nfe 0, Train: 0.9429, Val: 0.8228, Test: 0.8112, Best time: 26.0000
Epoch: 019, Runtime 9.603289, Loss 0.394850, forward nfe 5404, backward nfe 0, Train: 0.9571, Val: 0.8272, Test: 0.8142, Best time: 22.0000
Epoch: 020, Runtime 9.550445, Loss 0.324874, forward nfe 5700, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 21.0000
Epoch: 021, Runtime 9.509032, Loss 0.338641, forward nfe 5996, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 022, Runtime 9.344620, Loss 0.328828, forward nfe 6292, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 023, Runtime 9.320336, Loss 0.329911, forward nfe 6588, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 024, Runtime 9.305309, Loss 0.348935, forward nfe 6884, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 025, Runtime 9.624438, Loss 0.371742, forward nfe 7180, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 026, Runtime 9.730853, Loss 0.319232, forward nfe 7476, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 027, Runtime 9.655895, Loss 0.335022, forward nfe 7772, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 028, Runtime 10.209940, Loss 0.369698, forward nfe 8068, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 029, Runtime 9.951622, Loss 0.358113, forward nfe 8364, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 030, Runtime 9.987491, Loss 0.328562, forward nfe 8660, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 031, Runtime 10.383328, Loss 0.297268, forward nfe 8956, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 032, Runtime 10.164067, Loss 0.295365, forward nfe 9252, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 033, Runtime 10.375225, Loss 0.292374, forward nfe 9548, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 034, Runtime 10.498399, Loss 0.327631, forward nfe 9844, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 035, Runtime 10.532813, Loss 0.299116, forward nfe 10140, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 036, Runtime 10.561580, Loss 0.224369, forward nfe 10436, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 037, Runtime 10.734321, Loss 0.297090, forward nfe 10732, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 038, Runtime 14.833087, Loss 0.214942, forward nfe 11028, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 039, Runtime 17.881263, Loss 0.273356, forward nfe 11324, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 040, Runtime 18.245121, Loss 0.349492, forward nfe 11620, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 041, Runtime 18.117282, Loss 0.350563, forward nfe 11916, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 042, Runtime 18.504120, Loss 0.194773, forward nfe 12212, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 043, Runtime 18.540947, Loss 0.253815, forward nfe 12508, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 044, Runtime 18.684973, Loss 0.296570, forward nfe 12804, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 045, Runtime 18.719060, Loss 0.303434, forward nfe 13100, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 046, Runtime 18.326886, Loss 0.197793, forward nfe 13396, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 047, Runtime 18.014551, Loss 0.269401, forward nfe 13692, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 048, Runtime 17.481803, Loss 0.273960, forward nfe 13988, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 049, Runtime 15.714856, Loss 0.259525, forward nfe 14284, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 050, Runtime 15.191645, Loss 0.283296, forward nfe 14580, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 051, Runtime 15.185503, Loss 0.302848, forward nfe 14876, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 052, Runtime 14.881265, Loss 0.170041, forward nfe 15172, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 053, Runtime 14.447170, Loss 0.237771, forward nfe 15468, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 054, Runtime 14.235251, Loss 0.244895, forward nfe 15764, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 055, Runtime 14.133878, Loss 0.211076, forward nfe 16060, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 056, Runtime 14.254069, Loss 0.202087, forward nfe 16356, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 057, Runtime 14.227160, Loss 0.198787, forward nfe 16652, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 058, Runtime 14.448683, Loss 0.179551, forward nfe 16948, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 059, Runtime 14.267511, Loss 0.252765, forward nfe 17244, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 060, Runtime 14.082153, Loss 0.166850, forward nfe 17540, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 061, Runtime 14.192975, Loss 0.194029, forward nfe 17836, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 062, Runtime 14.177801, Loss 0.175312, forward nfe 18132, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 063, Runtime 14.261025, Loss 0.140433, forward nfe 18428, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 064, Runtime 14.230394, Loss 0.241466, forward nfe 18724, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 065, Runtime 14.416709, Loss 0.203499, forward nfe 19020, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 066, Runtime 14.386398, Loss 0.217399, forward nfe 19316, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 067, Runtime 14.534525, Loss 0.204963, forward nfe 19612, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 068, Runtime 14.342611, Loss 0.187155, forward nfe 19908, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 069, Runtime 14.320270, Loss 0.183497, forward nfe 20204, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 070, Runtime 14.441044, Loss 0.196201, forward nfe 20500, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 071, Runtime 14.350154, Loss 0.199305, forward nfe 20796, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 072, Runtime 14.405639, Loss 0.132298, forward nfe 21092, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 073, Runtime 14.454000, Loss 0.189823, forward nfe 21388, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 074, Runtime 14.419523, Loss 0.159920, forward nfe 21684, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 075, Runtime 14.187064, Loss 0.136998, forward nfe 21980, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 076, Runtime 14.211747, Loss 0.172834, forward nfe 22276, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 077, Runtime 13.972819, Loss 0.162392, forward nfe 22572, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 078, Runtime 13.229660, Loss 0.154956, forward nfe 22868, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 079, Runtime 13.297531, Loss 0.216157, forward nfe 23164, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 080, Runtime 12.500705, Loss 0.136103, forward nfe 23460, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8142, Best time: 18.2948
Epoch: 081, Runtime 12.421927, Loss 0.188217, forward nfe 23756, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 082, Runtime 10.019964, Loss 0.145974, forward nfe 24052, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 083, Runtime 10.241062, Loss 0.121577, forward nfe 24348, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 084, Runtime 10.391028, Loss 0.177285, forward nfe 24644, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 085, Runtime 9.712607, Loss 0.204164, forward nfe 24940, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 086, Runtime 9.724563, Loss 0.159324, forward nfe 25236, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 087, Runtime 9.818006, Loss 0.187774, forward nfe 25532, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 088, Runtime 9.680849, Loss 0.194005, forward nfe 25828, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 089, Runtime 10.089753, Loss 0.103519, forward nfe 26124, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 090, Runtime 9.964139, Loss 0.185182, forward nfe 26420, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 091, Runtime 10.002334, Loss 0.159516, forward nfe 26716, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 092, Runtime 10.344199, Loss 0.203318, forward nfe 27012, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 093, Runtime 10.149007, Loss 0.239901, forward nfe 27308, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 094, Runtime 10.349285, Loss 0.091615, forward nfe 27604, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 095, Runtime 10.344703, Loss 0.178110, forward nfe 27900, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 096, Runtime 10.358378, Loss 0.146227, forward nfe 28196, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 097, Runtime 10.868692, Loss 0.163952, forward nfe 28492, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 098, Runtime 11.400275, Loss 0.179511, forward nfe 28788, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
Epoch: 099, Runtime 10.862626, Loss 0.193747, forward nfe 29084, backward nfe 0, Train: 0.9786, Val: 0.8360, Test: 0.8173, Best time: 18.2948
best val accuracy 0.836029 with test accuracy 0.817259 at epoch 81 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8263959390862944
Entropy Threshold: 2 Test accuracy: 0.8243654822335026
Entropy Threshold: 1.6 Test accuracy: 0.8268839103869654
Entropy Threshold: 1.5 Test accuracy: 0.8352098259979529
Entropy Threshold: 1.4 Test accuracy: 0.8335046248715313
Entropy Threshold: 1.3 Test accuracy: 0.8359133126934984
Entropy Threshold: 1.2 Test accuracy: 0.838405036726128
Entropy Threshold: 1.1 Test accuracy: 0.8469713071200851
Entropy Threshold: 0.9 Test accuracy: 0.8600223964165733
Entropy Threshold: 0.8 Test accuracy: 0.8777393310265282
Entropy Threshold: 0.7 Test accuracy: 0.8867469879518072
Entropy Threshold: 0.6 Test accuracy: 0.9029850746268657
Entropy Threshold: 0.5 Test accuracy: 0.9128738621586476
Entropy Threshold: 0.4 Test accuracy: 0.9250681198910081
Entropy Threshold: 0.3 Test accuracy: 0.9297994269340975
Entropy Threshold: 0.2 Test accuracy: 0.9467275494672754
Entropy Threshold: 0.1 Test accuracy: 0.9586919104991394
