[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.4
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.769157, Loss 2.084304, forward nfe 76, backward nfe 0, Train: 0.1500, Val: 0.3206, Test: 0.2954, Best time: 1.0000
Epoch: 002, Runtime 10.794889, Loss 2.277314, forward nfe 372, backward nfe 0, Train: 0.3857, Val: 0.4147, Test: 0.3980, Best time: 1.0000
Epoch: 003, Runtime 10.626206, Loss 2.093414, forward nfe 668, backward nfe 0, Train: 0.3857, Val: 0.4147, Test: 0.3980, Best time: 18.2948
Epoch: 004, Runtime 11.094769, Loss 2.090101, forward nfe 964, backward nfe 0, Train: 0.3857, Val: 0.4147, Test: 0.3980, Best time: 18.2948
Epoch: 005, Runtime 10.923090, Loss 2.034223, forward nfe 1260, backward nfe 0, Train: 0.3857, Val: 0.4147, Test: 0.3980, Best time: 18.2948
Epoch: 006, Runtime 11.186488, Loss 1.866565, forward nfe 1556, backward nfe 0, Train: 0.6143, Val: 0.5118, Test: 0.4843, Best time: 3.0000
Epoch: 007, Runtime 10.898975, Loss 1.799190, forward nfe 1852, backward nfe 0, Train: 0.6857, Val: 0.6132, Test: 0.5959, Best time: 6.0000
Epoch: 008, Runtime 11.012723, Loss 1.641935, forward nfe 2148, backward nfe 0, Train: 0.7714, Val: 0.7096, Test: 0.6985, Best time: 15.0000
Epoch: 009, Runtime 10.979518, Loss 1.520239, forward nfe 2444, backward nfe 0, Train: 0.8214, Val: 0.7426, Test: 0.7421, Best time: 14.0000
Epoch: 010, Runtime 10.843668, Loss 1.344118, forward nfe 2740, backward nfe 0, Train: 0.8571, Val: 0.7824, Test: 0.7675, Best time: 26.0000
Epoch: 011, Runtime 11.006710, Loss 1.246348, forward nfe 3036, backward nfe 0, Train: 0.8857, Val: 0.7890, Test: 0.7736, Best time: 14.0000
Epoch: 012, Runtime 10.827167, Loss 1.173250, forward nfe 3332, backward nfe 0, Train: 0.8857, Val: 0.7890, Test: 0.7736, Best time: 18.2948
Epoch: 013, Runtime 11.202117, Loss 1.012422, forward nfe 3628, backward nfe 0, Train: 0.8857, Val: 0.7890, Test: 0.7736, Best time: 18.2948
Epoch: 014, Runtime 11.235138, Loss 0.866406, forward nfe 3924, backward nfe 0, Train: 0.9071, Val: 0.7985, Test: 0.7888, Best time: 31.0000
Epoch: 015, Runtime 10.944354, Loss 0.817794, forward nfe 4220, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7878, Best time: 35.0000
Epoch: 016, Runtime 10.823039, Loss 0.714319, forward nfe 4516, backward nfe 0, Train: 0.9071, Val: 0.8029, Test: 0.7878, Best time: 18.2948
Epoch: 017, Runtime 11.365586, Loss 0.680429, forward nfe 4812, backward nfe 0, Train: 0.9357, Val: 0.8088, Test: 0.8010, Best time: 9.0000
Epoch: 018, Runtime 10.951874, Loss 0.649620, forward nfe 5108, backward nfe 0, Train: 0.9429, Val: 0.8110, Test: 0.8102, Best time: 11.0000
Epoch: 019, Runtime 10.926090, Loss 0.657473, forward nfe 5404, backward nfe 0, Train: 0.9357, Val: 0.8176, Test: 0.8091, Best time: 28.0000
Epoch: 020, Runtime 10.984039, Loss 0.589433, forward nfe 5700, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8051, Best time: 20.0000
Epoch: 021, Runtime 10.952995, Loss 0.551801, forward nfe 5996, backward nfe 0, Train: 0.9429, Val: 0.8213, Test: 0.8081, Best time: 30.0000
Epoch: 022, Runtime 10.914762, Loss 0.487222, forward nfe 6292, backward nfe 0, Train: 0.9500, Val: 0.8272, Test: 0.8010, Best time: 21.0000
Epoch: 023, Runtime 10.880736, Loss 0.495275, forward nfe 6588, backward nfe 0, Train: 0.9643, Val: 0.8375, Test: 0.8091, Best time: 17.0000
Epoch: 024, Runtime 10.897646, Loss 0.514140, forward nfe 6884, backward nfe 0, Train: 0.9714, Val: 0.8419, Test: 0.8183, Best time: 20.0000
Epoch: 025, Runtime 10.825215, Loss 0.404452, forward nfe 7180, backward nfe 0, Train: 0.9714, Val: 0.8419, Test: 0.8183, Best time: 18.2948
Epoch: 026, Runtime 11.144918, Loss 0.517586, forward nfe 7476, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 26.0000
Epoch: 027, Runtime 10.619779, Loss 0.531704, forward nfe 7772, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 028, Runtime 10.902184, Loss 0.444196, forward nfe 8068, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 029, Runtime 10.784919, Loss 0.410467, forward nfe 8364, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 030, Runtime 10.546053, Loss 0.453510, forward nfe 8660, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 031, Runtime 10.266966, Loss 0.363620, forward nfe 8956, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 032, Runtime 10.058758, Loss 0.407090, forward nfe 9252, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 033, Runtime 9.984988, Loss 0.427429, forward nfe 9548, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 034, Runtime 10.278367, Loss 0.520791, forward nfe 9844, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 035, Runtime 10.244223, Loss 0.412643, forward nfe 10140, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 036, Runtime 10.245403, Loss 0.455052, forward nfe 10436, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 037, Runtime 10.476530, Loss 0.351711, forward nfe 10732, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 038, Runtime 10.463152, Loss 0.402377, forward nfe 11028, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 039, Runtime 10.485225, Loss 0.426962, forward nfe 11324, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 040, Runtime 11.977185, Loss 0.371173, forward nfe 11620, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 041, Runtime 12.212847, Loss 0.489851, forward nfe 11916, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 042, Runtime 12.141361, Loss 0.360377, forward nfe 12212, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 043, Runtime 12.410426, Loss 0.314796, forward nfe 12508, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 044, Runtime 12.405386, Loss 0.338714, forward nfe 12804, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 045, Runtime 12.445534, Loss 0.349902, forward nfe 13100, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 046, Runtime 12.586848, Loss 0.384280, forward nfe 13396, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 047, Runtime 12.572004, Loss 0.388412, forward nfe 13692, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 048, Runtime 12.646363, Loss 0.347209, forward nfe 13988, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 049, Runtime 12.768209, Loss 0.370470, forward nfe 14284, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 050, Runtime 12.744469, Loss 0.262568, forward nfe 14580, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 051, Runtime 12.748511, Loss 0.396024, forward nfe 14876, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 052, Runtime 12.944873, Loss 0.332900, forward nfe 15172, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 053, Runtime 13.007434, Loss 0.369265, forward nfe 15468, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 054, Runtime 12.916872, Loss 0.319079, forward nfe 15764, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 055, Runtime 13.171494, Loss 0.329578, forward nfe 16060, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 056, Runtime 12.950665, Loss 0.347446, forward nfe 16356, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 057, Runtime 12.974546, Loss 0.287808, forward nfe 16652, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 058, Runtime 13.099003, Loss 0.264655, forward nfe 16948, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 059, Runtime 13.051967, Loss 0.391153, forward nfe 17244, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 060, Runtime 13.004026, Loss 0.253918, forward nfe 17540, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 061, Runtime 13.170379, Loss 0.300246, forward nfe 17836, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 062, Runtime 13.240839, Loss 0.290194, forward nfe 18132, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 063, Runtime 13.160054, Loss 0.265323, forward nfe 18428, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 064, Runtime 13.184003, Loss 0.318315, forward nfe 18724, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 065, Runtime 13.152931, Loss 0.308372, forward nfe 19020, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 066, Runtime 13.215974, Loss 0.272046, forward nfe 19316, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 067, Runtime 13.353176, Loss 0.248991, forward nfe 19612, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 068, Runtime 13.190962, Loss 0.306415, forward nfe 19908, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 069, Runtime 13.095481, Loss 0.345930, forward nfe 20204, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 070, Runtime 13.199485, Loss 0.290636, forward nfe 20500, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 071, Runtime 13.194903, Loss 0.345627, forward nfe 20796, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 072, Runtime 13.055583, Loss 0.300626, forward nfe 21092, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 073, Runtime 12.590989, Loss 0.342646, forward nfe 21388, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 074, Runtime 12.128381, Loss 0.297988, forward nfe 21684, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 075, Runtime 11.842785, Loss 0.246485, forward nfe 21980, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 076, Runtime 11.566553, Loss 0.290217, forward nfe 22276, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 077, Runtime 12.314101, Loss 0.296264, forward nfe 22572, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 078, Runtime 11.950218, Loss 0.301892, forward nfe 22868, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 079, Runtime 11.958567, Loss 0.290197, forward nfe 23164, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 080, Runtime 12.160047, Loss 0.289013, forward nfe 23460, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 081, Runtime 11.867403, Loss 0.319424, forward nfe 23756, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 082, Runtime 11.985865, Loss 0.260522, forward nfe 24052, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 083, Runtime 11.834416, Loss 0.269383, forward nfe 24348, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 084, Runtime 11.867083, Loss 0.249468, forward nfe 24644, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 085, Runtime 12.308267, Loss 0.245268, forward nfe 24940, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 086, Runtime 13.459844, Loss 0.223286, forward nfe 25236, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 087, Runtime 13.427142, Loss 0.328361, forward nfe 25532, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 088, Runtime 13.535469, Loss 0.198460, forward nfe 25828, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 089, Runtime 13.502522, Loss 0.310181, forward nfe 26124, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 090, Runtime 13.476167, Loss 0.195555, forward nfe 26420, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 091, Runtime 12.748173, Loss 0.256513, forward nfe 26716, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 092, Runtime 12.424107, Loss 0.282509, forward nfe 27012, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 093, Runtime 12.308142, Loss 0.255460, forward nfe 27308, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 094, Runtime 12.355702, Loss 0.346997, forward nfe 27604, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 095, Runtime 12.324853, Loss 0.262513, forward nfe 27900, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 096, Runtime 12.355503, Loss 0.252861, forward nfe 28196, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 097, Runtime 12.304508, Loss 0.310833, forward nfe 28492, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 098, Runtime 12.428455, Loss 0.259275, forward nfe 28788, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
Epoch: 099, Runtime 12.281862, Loss 0.230890, forward nfe 29084, backward nfe 0, Train: 0.9571, Val: 0.8441, Test: 0.8183, Best time: 18.2948
best val accuracy 0.844118 with test accuracy 0.818274 at epoch 26 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8101522842639594
Entropy Threshold: 2 Test accuracy: 0.8182741116751269
Entropy Threshold: 1.6 Test accuracy: 0.8331584470094439
Entropy Threshold: 1.5 Test accuracy: 0.8498920086393088
Entropy Threshold: 1.4 Test accuracy: 0.8557268722466961
Entropy Threshold: 1.3 Test accuracy: 0.8623435722411832
Entropy Threshold: 1.2 Test accuracy: 0.8656361474435196
Entropy Threshold: 1.1 Test accuracy: 0.8816936488169365
Entropy Threshold: 0.9 Test accuracy: 0.9078404401650619
Entropy Threshold: 0.8 Test accuracy: 0.9230769230769231
Entropy Threshold: 0.7 Test accuracy: 0.9307692307692308
Entropy Threshold: 0.6 Test accuracy: 0.935
Entropy Threshold: 0.5 Test accuracy: 0.9492753623188406
Entropy Threshold: 0.4 Test accuracy: 0.9558232931726908
Entropy Threshold: 0.3 Test accuracy: 0.9622222222222222
Entropy Threshold: 0.2 Test accuracy: 0.9689922480620154
Entropy Threshold: 0.1 Test accuracy: 0.9691780821917808
