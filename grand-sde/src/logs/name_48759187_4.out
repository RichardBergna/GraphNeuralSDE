[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.5
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 8.881051, Loss 2.066559, forward nfe 76, backward nfe 0, Train: 0.3143, Val: 0.2176, Test: 0.2081, Best time: 1.0000
Epoch: 002, Runtime 7.875880, Loss 2.410231, forward nfe 372, backward nfe 0, Train: 0.7000, Val: 0.4838, Test: 0.5147, Best time: 3.0000
Epoch: 003, Runtime 7.704437, Loss 2.190486, forward nfe 668, backward nfe 0, Train: 0.7000, Val: 0.4838, Test: 0.5147, Best time: 18.2948
Epoch: 004, Runtime 8.036071, Loss 2.145612, forward nfe 964, backward nfe 0, Train: 0.7000, Val: 0.4838, Test: 0.5147, Best time: 18.2948
Epoch: 005, Runtime 7.940001, Loss 2.025738, forward nfe 1260, backward nfe 0, Train: 0.7000, Val: 0.4838, Test: 0.5147, Best time: 18.2948
Epoch: 006, Runtime 8.126390, Loss 1.977804, forward nfe 1556, backward nfe 0, Train: 0.6286, Val: 0.5096, Test: 0.5218, Best time: 4.0000
Epoch: 007, Runtime 8.002855, Loss 1.863996, forward nfe 1852, backward nfe 0, Train: 0.7071, Val: 0.5566, Test: 0.5685, Best time: 5.0000
Epoch: 008, Runtime 8.308742, Loss 1.663838, forward nfe 2148, backward nfe 0, Train: 0.7429, Val: 0.6213, Test: 0.6355, Best time: 6.0000
Epoch: 009, Runtime 8.507288, Loss 1.548918, forward nfe 2444, backward nfe 0, Train: 0.7929, Val: 0.6669, Test: 0.6792, Best time: 10.0000
Epoch: 010, Runtime 8.627210, Loss 1.446442, forward nfe 2740, backward nfe 0, Train: 0.8000, Val: 0.6897, Test: 0.7015, Best time: 19.0000
Epoch: 011, Runtime 8.686915, Loss 1.349250, forward nfe 3036, backward nfe 0, Train: 0.8000, Val: 0.6897, Test: 0.7015, Best time: 18.2948
Epoch: 012, Runtime 9.067153, Loss 1.233989, forward nfe 3332, backward nfe 0, Train: 0.8000, Val: 0.6897, Test: 0.7015, Best time: 18.2948
Epoch: 013, Runtime 9.349200, Loss 1.125546, forward nfe 3628, backward nfe 0, Train: 0.8071, Val: 0.7110, Test: 0.7046, Best time: 29.0000
Epoch: 014, Runtime 9.393245, Loss 1.126921, forward nfe 3924, backward nfe 0, Train: 0.8071, Val: 0.7456, Test: 0.7360, Best time: 22.0000
Epoch: 015, Runtime 9.211416, Loss 1.023292, forward nfe 4220, backward nfe 0, Train: 0.8429, Val: 0.7632, Test: 0.7645, Best time: 22.0000
Epoch: 016, Runtime 9.455750, Loss 0.913798, forward nfe 4516, backward nfe 0, Train: 0.8786, Val: 0.7846, Test: 0.7858, Best time: 20.0000
Epoch: 017, Runtime 9.407798, Loss 0.849123, forward nfe 4812, backward nfe 0, Train: 0.8857, Val: 0.7993, Test: 0.7878, Best time: 23.0000
Epoch: 018, Runtime 9.239508, Loss 0.757040, forward nfe 5108, backward nfe 0, Train: 0.9000, Val: 0.8037, Test: 0.7919, Best time: 24.0000
Epoch: 019, Runtime 8.948962, Loss 0.696993, forward nfe 5404, backward nfe 0, Train: 0.8857, Val: 0.8103, Test: 0.8041, Best time: 34.0000
Epoch: 020, Runtime 8.848693, Loss 0.769259, forward nfe 5700, backward nfe 0, Train: 0.8857, Val: 0.8169, Test: 0.8081, Best time: 51.0000
Epoch: 021, Runtime 8.795649, Loss 0.663252, forward nfe 5996, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 51.0000
Epoch: 022, Runtime 8.949536, Loss 0.587907, forward nfe 6292, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 023, Runtime 8.946122, Loss 0.627318, forward nfe 6588, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 024, Runtime 8.919417, Loss 0.567734, forward nfe 6884, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 025, Runtime 8.961361, Loss 0.642732, forward nfe 7180, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 026, Runtime 9.388845, Loss 0.548314, forward nfe 7476, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 027, Runtime 9.243995, Loss 0.544045, forward nfe 7772, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 028, Runtime 9.260979, Loss 0.502246, forward nfe 8068, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 029, Runtime 9.547178, Loss 0.567106, forward nfe 8364, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 030, Runtime 10.046109, Loss 0.549501, forward nfe 8660, backward nfe 0, Train: 0.8786, Val: 0.8176, Test: 0.8152, Best time: 18.2948
Epoch: 031, Runtime 10.228767, Loss 0.542535, forward nfe 8956, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 48.0000
Epoch: 032, Runtime 9.067410, Loss 0.502281, forward nfe 9252, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 033, Runtime 9.343172, Loss 0.481974, forward nfe 9548, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 034, Runtime 9.105368, Loss 0.520240, forward nfe 9844, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 035, Runtime 8.938854, Loss 0.486379, forward nfe 10140, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 036, Runtime 9.232555, Loss 0.427154, forward nfe 10436, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 037, Runtime 9.204536, Loss 0.460829, forward nfe 10732, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 038, Runtime 9.373606, Loss 0.384591, forward nfe 11028, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 039, Runtime 9.669629, Loss 0.412517, forward nfe 11324, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 040, Runtime 9.509320, Loss 0.364109, forward nfe 11620, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 041, Runtime 9.551672, Loss 0.446274, forward nfe 11916, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 042, Runtime 10.266596, Loss 0.279246, forward nfe 12212, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 043, Runtime 10.295977, Loss 0.391041, forward nfe 12508, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 044, Runtime 10.095508, Loss 0.385057, forward nfe 12804, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 045, Runtime 10.454071, Loss 0.421388, forward nfe 13100, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 046, Runtime 10.058589, Loss 0.453695, forward nfe 13396, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 047, Runtime 10.003546, Loss 0.400131, forward nfe 13692, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 048, Runtime 10.243039, Loss 0.364854, forward nfe 13988, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 049, Runtime 10.387581, Loss 0.271758, forward nfe 14284, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 050, Runtime 10.121680, Loss 0.377258, forward nfe 14580, backward nfe 0, Train: 0.9143, Val: 0.8184, Test: 0.8142, Best time: 18.2948
Epoch: 051, Runtime 10.494491, Loss 0.317032, forward nfe 14876, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8132, Best time: 42.0000
Epoch: 052, Runtime 8.921670, Loss 0.322559, forward nfe 15172, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8132, Best time: 18.2948
Epoch: 053, Runtime 9.212064, Loss 0.331633, forward nfe 15468, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8132, Best time: 18.2948
Epoch: 054, Runtime 9.309639, Loss 0.362036, forward nfe 15764, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8132, Best time: 18.2948
Epoch: 055, Runtime 9.189413, Loss 0.379263, forward nfe 16060, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8132, Best time: 18.2948
Epoch: 056, Runtime 9.612878, Loss 0.316637, forward nfe 16356, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8132, Best time: 18.2948
Epoch: 057, Runtime 9.689941, Loss 0.332435, forward nfe 16652, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8152, Best time: 54.8843
Epoch: 058, Runtime 9.030339, Loss 0.300051, forward nfe 16948, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8152, Best time: 18.2948
Epoch: 059, Runtime 9.251995, Loss 0.346953, forward nfe 17244, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8152, Best time: 18.2948
Epoch: 060, Runtime 9.360035, Loss 0.310012, forward nfe 17540, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8152, Best time: 18.2948
Epoch: 061, Runtime 9.005119, Loss 0.297677, forward nfe 17836, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8152, Best time: 18.2948
Epoch: 062, Runtime 9.251831, Loss 0.290162, forward nfe 18132, backward nfe 0, Train: 0.9571, Val: 0.8250, Test: 0.8152, Best time: 18.2948
Epoch: 063, Runtime 9.723292, Loss 0.357007, forward nfe 18428, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 49.0000
Epoch: 064, Runtime 8.937033, Loss 0.326135, forward nfe 18724, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 065, Runtime 9.157800, Loss 0.309300, forward nfe 19020, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 066, Runtime 9.014442, Loss 0.317932, forward nfe 19316, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 067, Runtime 8.943414, Loss 0.284120, forward nfe 19612, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 068, Runtime 9.323947, Loss 0.315954, forward nfe 19908, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 069, Runtime 9.267472, Loss 0.376720, forward nfe 20204, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 070, Runtime 9.298300, Loss 0.334723, forward nfe 20500, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 071, Runtime 9.543664, Loss 0.250308, forward nfe 20796, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 072, Runtime 9.587941, Loss 0.279522, forward nfe 21092, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 073, Runtime 9.919286, Loss 0.254190, forward nfe 21388, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 074, Runtime 10.351190, Loss 0.271132, forward nfe 21684, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 075, Runtime 9.915940, Loss 0.256036, forward nfe 21980, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 076, Runtime 9.835328, Loss 0.281516, forward nfe 22276, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 077, Runtime 10.128587, Loss 0.271565, forward nfe 22572, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 078, Runtime 10.016084, Loss 0.261267, forward nfe 22868, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 079, Runtime 9.529114, Loss 0.242536, forward nfe 23164, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 080, Runtime 9.536065, Loss 0.274477, forward nfe 23460, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 081, Runtime 9.506004, Loss 0.372965, forward nfe 23756, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 082, Runtime 9.418912, Loss 0.218166, forward nfe 24052, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 083, Runtime 9.537064, Loss 0.287015, forward nfe 24348, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 084, Runtime 9.624894, Loss 0.303070, forward nfe 24644, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 085, Runtime 9.593403, Loss 0.352503, forward nfe 24940, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 086, Runtime 9.709365, Loss 0.308980, forward nfe 25236, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 087, Runtime 9.759531, Loss 0.280375, forward nfe 25532, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 088, Runtime 10.036632, Loss 0.214775, forward nfe 25828, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 089, Runtime 10.254141, Loss 0.266829, forward nfe 26124, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 090, Runtime 10.173538, Loss 0.222396, forward nfe 26420, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 091, Runtime 10.179185, Loss 0.219607, forward nfe 26716, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 092, Runtime 10.100131, Loss 0.181494, forward nfe 27012, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 093, Runtime 10.057251, Loss 0.259224, forward nfe 27308, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 094, Runtime 10.133760, Loss 0.246409, forward nfe 27604, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 095, Runtime 10.049199, Loss 0.178600, forward nfe 27900, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 096, Runtime 10.185056, Loss 0.202593, forward nfe 28196, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 097, Runtime 10.176978, Loss 0.216305, forward nfe 28492, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 098, Runtime 10.090689, Loss 0.224973, forward nfe 28788, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
Epoch: 099, Runtime 10.226444, Loss 0.189096, forward nfe 29084, backward nfe 0, Train: 0.9571, Val: 0.8257, Test: 0.8071, Best time: 18.2948
best val accuracy 0.825735 with test accuracy 0.807107 at epoch 63 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8131979695431472
Entropy Threshold: 2 Test accuracy: 0.8121827411167513
Entropy Threshold: 1.6 Test accuracy: 0.8169734151329243
Entropy Threshold: 1.5 Test accuracy: 0.8210961737331954
Entropy Threshold: 1.4 Test accuracy: 0.8202716823406478
Entropy Threshold: 1.3 Test accuracy: 0.8290870488322718
Entropy Threshold: 1.2 Test accuracy: 0.8411316648531012
Entropy Threshold: 1.1 Test accuracy: 0.8452914798206278
Entropy Threshold: 0.9 Test accuracy: 0.866504854368932
Entropy Threshold: 0.8 Test accuracy: 0.8771929824561403
Entropy Threshold: 0.7 Test accuracy: 0.8877146631439894
Entropy Threshold: 0.6 Test accuracy: 0.8979020979020979
Entropy Threshold: 0.5 Test accuracy: 0.9013254786450663
Entropy Threshold: 0.4 Test accuracy: 0.9145962732919255
Entropy Threshold: 0.3 Test accuracy: 0.9232081911262798
Entropy Threshold: 0.2 Test accuracy: 0.9245283018867925
Entropy Threshold: 0.1 Test accuracy: 0.9469026548672567
