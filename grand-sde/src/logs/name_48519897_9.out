[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.01
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 7.368459, Loss 1.952527, forward nfe 76, backward nfe 0, Train: 0.6429, Val: 0.5456, Test: 0.5482, Best time: 5.0000
Epoch: 002, Runtime 7.299612, Loss 1.896302, forward nfe 372, backward nfe 0, Train: 0.7214, Val: 0.6309, Test: 0.6132, Best time: 6.0000
Epoch: 003, Runtime 7.437205, Loss 1.712549, forward nfe 668, backward nfe 0, Train: 0.7786, Val: 0.6574, Test: 0.6447, Best time: 5.0000
Epoch: 004, Runtime 7.493890, Loss 1.499233, forward nfe 964, backward nfe 0, Train: 0.9143, Val: 0.7647, Test: 0.7574, Best time: 7.0000
Epoch: 005, Runtime 7.537377, Loss 1.223644, forward nfe 1260, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 16.0000
Epoch: 006, Runtime 6.977245, Loss 0.916712, forward nfe 1556, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 007, Runtime 7.220719, Loss 0.646731, forward nfe 1852, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 008, Runtime 7.116141, Loss 0.439850, forward nfe 2148, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 009, Runtime 7.407977, Loss 0.307598, forward nfe 2444, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 010, Runtime 7.248425, Loss 0.236127, forward nfe 2740, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 011, Runtime 7.489712, Loss 0.213261, forward nfe 3036, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 012, Runtime 7.465503, Loss 0.176820, forward nfe 3332, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 013, Runtime 7.533800, Loss 0.161361, forward nfe 3628, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 014, Runtime 7.479902, Loss 0.135605, forward nfe 3924, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 015, Runtime 7.702350, Loss 0.137784, forward nfe 4220, backward nfe 0, Train: 0.9571, Val: 0.8125, Test: 0.8030, Best time: 18.2948
Epoch: 016, Runtime 7.675076, Loss 0.131676, forward nfe 4516, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 34.0000
Epoch: 017, Runtime 7.219363, Loss 0.222334, forward nfe 4812, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 018, Runtime 7.110354, Loss 0.172967, forward nfe 5108, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 019, Runtime 7.224472, Loss 0.135757, forward nfe 5404, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 020, Runtime 7.341995, Loss 0.225715, forward nfe 5700, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 021, Runtime 7.415366, Loss 0.156056, forward nfe 5996, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 022, Runtime 7.527720, Loss 0.160794, forward nfe 6292, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 023, Runtime 7.530297, Loss 0.206682, forward nfe 6588, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 024, Runtime 7.530195, Loss 0.175187, forward nfe 6884, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 025, Runtime 7.593112, Loss 0.179423, forward nfe 7180, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 026, Runtime 7.608871, Loss 0.188843, forward nfe 7476, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 027, Runtime 7.155461, Loss 0.186273, forward nfe 7772, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 028, Runtime 7.240088, Loss 0.141806, forward nfe 8068, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 029, Runtime 7.105321, Loss 0.214203, forward nfe 8364, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 030, Runtime 7.381596, Loss 0.151946, forward nfe 8660, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 031, Runtime 7.239553, Loss 0.165821, forward nfe 8956, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 032, Runtime 7.343051, Loss 0.133728, forward nfe 9252, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 033, Runtime 7.333915, Loss 0.134503, forward nfe 9548, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 034, Runtime 7.442203, Loss 0.157420, forward nfe 9844, backward nfe 0, Train: 0.9714, Val: 0.8191, Test: 0.8173, Best time: 18.2948
Epoch: 035, Runtime 7.609118, Loss 0.129202, forward nfe 10140, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 43.0000
Epoch: 036, Runtime 7.105376, Loss 0.199448, forward nfe 10436, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 037, Runtime 6.998838, Loss 0.149950, forward nfe 10732, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 038, Runtime 7.235954, Loss 0.133233, forward nfe 11028, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 039, Runtime 7.227399, Loss 0.142718, forward nfe 11324, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 040, Runtime 7.208257, Loss 0.149033, forward nfe 11620, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 041, Runtime 7.387357, Loss 0.129520, forward nfe 11916, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 042, Runtime 7.458051, Loss 0.132529, forward nfe 12212, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 043, Runtime 7.392087, Loss 0.110677, forward nfe 12508, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 044, Runtime 7.438903, Loss 0.124056, forward nfe 12804, backward nfe 0, Train: 0.9714, Val: 0.8250, Test: 0.8315, Best time: 18.2948
Epoch: 045, Runtime 7.859678, Loss 0.159764, forward nfe 13100, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 27.0000
Epoch: 046, Runtime 6.903688, Loss 0.136695, forward nfe 13396, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 047, Runtime 7.008864, Loss 0.134122, forward nfe 13692, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 048, Runtime 7.027088, Loss 0.132631, forward nfe 13988, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 049, Runtime 7.154206, Loss 0.150983, forward nfe 14284, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 050, Runtime 7.193836, Loss 0.155663, forward nfe 14580, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 051, Runtime 7.158894, Loss 0.147345, forward nfe 14876, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 052, Runtime 7.296714, Loss 0.123867, forward nfe 15172, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 053, Runtime 7.256365, Loss 0.146266, forward nfe 15468, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 054, Runtime 7.287729, Loss 0.141172, forward nfe 15764, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 055, Runtime 7.426583, Loss 0.159652, forward nfe 16060, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 056, Runtime 7.041040, Loss 0.121277, forward nfe 16356, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 057, Runtime 6.963687, Loss 0.131955, forward nfe 16652, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 058, Runtime 7.127178, Loss 0.115248, forward nfe 16948, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 059, Runtime 7.135657, Loss 0.103311, forward nfe 17244, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 060, Runtime 7.214404, Loss 0.104970, forward nfe 17540, backward nfe 0, Train: 0.9714, Val: 0.8272, Test: 0.8284, Best time: 18.2948
Epoch: 061, Runtime 7.396686, Loss 0.127325, forward nfe 17836, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 36.0000
Epoch: 062, Runtime 6.987924, Loss 0.108284, forward nfe 18132, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 063, Runtime 6.964049, Loss 0.128257, forward nfe 18428, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 064, Runtime 7.037541, Loss 0.131479, forward nfe 18724, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 065, Runtime 7.116989, Loss 0.126460, forward nfe 19020, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 066, Runtime 7.241624, Loss 0.150221, forward nfe 19316, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 067, Runtime 7.094667, Loss 0.105200, forward nfe 19612, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 068, Runtime 7.225191, Loss 0.128766, forward nfe 19908, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 069, Runtime 7.194190, Loss 0.135014, forward nfe 20204, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 070, Runtime 7.302044, Loss 0.097965, forward nfe 20500, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 071, Runtime 7.338291, Loss 0.100893, forward nfe 20796, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 072, Runtime 6.971074, Loss 0.126793, forward nfe 21092, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 073, Runtime 6.949862, Loss 0.114541, forward nfe 21388, backward nfe 0, Train: 0.9786, Val: 0.8287, Test: 0.8315, Best time: 18.2948
Epoch: 074, Runtime 7.107562, Loss 0.077974, forward nfe 21684, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 075, Runtime 6.840721, Loss 0.129236, forward nfe 21980, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 076, Runtime 6.848991, Loss 0.134877, forward nfe 22276, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 077, Runtime 6.939284, Loss 0.118984, forward nfe 22572, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 078, Runtime 6.996017, Loss 0.115349, forward nfe 22868, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 079, Runtime 7.222308, Loss 0.140896, forward nfe 23164, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 080, Runtime 7.148154, Loss 0.100769, forward nfe 23460, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 081, Runtime 7.313983, Loss 0.112843, forward nfe 23756, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 082, Runtime 7.275181, Loss 0.140701, forward nfe 24052, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 083, Runtime 7.333707, Loss 0.137832, forward nfe 24348, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 084, Runtime 7.325861, Loss 0.112344, forward nfe 24644, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 085, Runtime 6.966866, Loss 0.117027, forward nfe 24940, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 086, Runtime 6.819811, Loss 0.116085, forward nfe 25236, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 087, Runtime 6.971400, Loss 0.133619, forward nfe 25532, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 088, Runtime 7.148053, Loss 0.099246, forward nfe 25828, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 089, Runtime 7.069611, Loss 0.106315, forward nfe 26124, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 090, Runtime 7.229923, Loss 0.108306, forward nfe 26420, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 091, Runtime 7.191429, Loss 0.079790, forward nfe 26716, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 092, Runtime 7.173061, Loss 0.127082, forward nfe 27012, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 093, Runtime 7.288365, Loss 0.077150, forward nfe 27308, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 094, Runtime 7.267112, Loss 0.079940, forward nfe 27604, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 095, Runtime 7.257895, Loss 0.135339, forward nfe 27900, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 096, Runtime 7.395422, Loss 0.078432, forward nfe 28196, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 097, Runtime 6.947326, Loss 0.079174, forward nfe 28492, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 098, Runtime 6.907129, Loss 0.146915, forward nfe 28788, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
Epoch: 099, Runtime 7.022167, Loss 0.139740, forward nfe 29084, backward nfe 0, Train: 0.9571, Val: 0.8353, Test: 0.8305, Best time: 18.2948
best val accuracy 0.835294 with test accuracy 0.830457 at epoch 74 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.833502538071066
Entropy Threshold: 2 Test accuracy: 0.8314720812182741
Entropy Threshold: 1.6 Test accuracy: 0.8324873096446701
Entropy Threshold: 1.5 Test accuracy: 0.8309572301425662
Entropy Threshold: 1.4 Test accuracy: 0.8345250255362615
Entropy Threshold: 1.3 Test accuracy: 0.8386433710174718
Entropy Threshold: 1.2 Test accuracy: 0.8412863070539419
Entropy Threshold: 1.1 Test accuracy: 0.8485804416403786
Entropy Threshold: 0.9 Test accuracy: 0.8630434782608696
Entropy Threshold: 0.8 Test accuracy: 0.8712541620421753
Entropy Threshold: 0.7 Test accuracy: 0.876993166287016
Entropy Threshold: 0.6 Test accuracy: 0.8869257950530035
Entropy Threshold: 0.5 Test accuracy: 0.8913308913308914
Entropy Threshold: 0.4 Test accuracy: 0.8942065491183879
Entropy Threshold: 0.3 Test accuracy: 0.8998699609882965
Entropy Threshold: 0.2 Test accuracy: 0.9192886456908345
Entropy Threshold: 0.1 Test accuracy: 0.9314456035767511
