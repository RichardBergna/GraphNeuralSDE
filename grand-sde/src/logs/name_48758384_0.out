[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 9.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 12.552215, Loss 7.354507, forward nfe 76, backward nfe 0, Train: 0.3286, Val: 0.2515, Test: 0.2599, Best time: 1.0000
Epoch: 002, Runtime 12.763064, Loss 8.482417, forward nfe 372, backward nfe 0, Train: 0.3857, Val: 0.3632, Test: 0.3766, Best time: 1.0000
Epoch: 003, Runtime 11.695257, Loss 6.718158, forward nfe 668, backward nfe 0, Train: 0.3857, Val: 0.3632, Test: 0.3766, Best time: 18.2948
Epoch: 004, Runtime 12.417114, Loss 5.774631, forward nfe 964, backward nfe 0, Train: 0.3857, Val: 0.3632, Test: 0.3766, Best time: 18.2948
Epoch: 005, Runtime 12.871132, Loss 5.829036, forward nfe 1260, backward nfe 0, Train: 0.3857, Val: 0.3632, Test: 0.3766, Best time: 18.2948
Epoch: 006, Runtime 14.862455, Loss 4.377464, forward nfe 1556, backward nfe 0, Train: 0.3714, Val: 0.3875, Test: 0.3909, Best time: 1.0000
Epoch: 007, Runtime 13.956508, Loss 4.279854, forward nfe 1852, backward nfe 0, Train: 0.4357, Val: 0.4243, Test: 0.4345, Best time: 1.0000
Epoch: 008, Runtime 14.153895, Loss 4.181784, forward nfe 2148, backward nfe 0, Train: 0.5286, Val: 0.4669, Test: 0.4772, Best time: 2.0000
Epoch: 009, Runtime 14.332292, Loss 4.003052, forward nfe 2444, backward nfe 0, Train: 0.5286, Val: 0.4669, Test: 0.4772, Best time: 18.2948
Epoch: 010, Runtime 14.153323, Loss 3.968129, forward nfe 2740, backward nfe 0, Train: 0.5714, Val: 0.4728, Test: 0.4619, Best time: 10.0000
Epoch: 011, Runtime 14.153421, Loss 3.529560, forward nfe 3036, backward nfe 0, Train: 0.5571, Val: 0.4765, Test: 0.4751, Best time: 15.0000
Epoch: 012, Runtime 13.668415, Loss 3.298498, forward nfe 3332, backward nfe 0, Train: 0.5929, Val: 0.4971, Test: 0.4964, Best time: 14.0000
Epoch: 013, Runtime 13.823603, Loss 2.881812, forward nfe 3628, backward nfe 0, Train: 0.5929, Val: 0.5132, Test: 0.5117, Best time: 11.0000
Epoch: 014, Runtime 14.015973, Loss 2.809650, forward nfe 3924, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 9.0000
Epoch: 015, Runtime 13.653223, Loss 2.497289, forward nfe 4220, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 016, Runtime 13.775145, Loss 2.660113, forward nfe 4516, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 017, Runtime 14.083301, Loss 2.529194, forward nfe 4812, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 018, Runtime 13.920156, Loss 2.533525, forward nfe 5108, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 019, Runtime 13.335579, Loss 2.400905, forward nfe 5404, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 020, Runtime 13.580617, Loss 2.144723, forward nfe 5700, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 021, Runtime 13.749893, Loss 2.265106, forward nfe 5996, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 022, Runtime 14.196189, Loss 2.186060, forward nfe 6292, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 023, Runtime 14.459206, Loss 2.183252, forward nfe 6588, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 024, Runtime 14.566132, Loss 2.130808, forward nfe 6884, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 025, Runtime 14.925146, Loss 2.227447, forward nfe 7180, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 026, Runtime 14.534297, Loss 2.255349, forward nfe 7476, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 027, Runtime 14.943882, Loss 2.060904, forward nfe 7772, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 028, Runtime 14.511027, Loss 2.038651, forward nfe 8068, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 029, Runtime 15.046391, Loss 2.077958, forward nfe 8364, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 030, Runtime 14.902653, Loss 1.951327, forward nfe 8660, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 031, Runtime 15.141636, Loss 2.093089, forward nfe 8956, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 032, Runtime 14.847545, Loss 1.919448, forward nfe 9252, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 033, Runtime 15.240728, Loss 2.023870, forward nfe 9548, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 034, Runtime 14.840703, Loss 1.860455, forward nfe 9844, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 035, Runtime 15.257883, Loss 1.961035, forward nfe 10140, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 036, Runtime 14.849950, Loss 2.093101, forward nfe 10436, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 037, Runtime 15.362426, Loss 1.913229, forward nfe 10732, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 038, Runtime 14.794010, Loss 1.964576, forward nfe 11028, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 039, Runtime 15.343998, Loss 1.870062, forward nfe 11324, backward nfe 0, Train: 0.6429, Val: 0.5191, Test: 0.5147, Best time: 18.2948
Epoch: 040, Runtime 15.058328, Loss 1.892190, forward nfe 11620, backward nfe 0, Train: 0.5286, Val: 0.5199, Test: 0.5056, Best time: 14.0000
Epoch: 041, Runtime 13.389284, Loss 1.842607, forward nfe 11916, backward nfe 0, Train: 0.5357, Val: 0.5331, Test: 0.5157, Best time: 10.0000
Epoch: 042, Runtime 13.584213, Loss 2.050397, forward nfe 12212, backward nfe 0, Train: 0.5357, Val: 0.5434, Test: 0.5279, Best time: 14.0000
Epoch: 043, Runtime 13.098743, Loss 1.815517, forward nfe 12508, backward nfe 0, Train: 0.5357, Val: 0.5463, Test: 0.5310, Best time: 13.0000
Epoch: 044, Runtime 13.060457, Loss 1.776950, forward nfe 12804, backward nfe 0, Train: 0.5357, Val: 0.5463, Test: 0.5310, Best time: 18.2948
Epoch: 045, Runtime 13.268310, Loss 1.926142, forward nfe 13100, backward nfe 0, Train: 0.5429, Val: 0.5529, Test: 0.5340, Best time: 20.0000
Epoch: 046, Runtime 13.011672, Loss 1.856291, forward nfe 13396, backward nfe 0, Train: 0.5429, Val: 0.5529, Test: 0.5340, Best time: 18.2948
Epoch: 047, Runtime 13.402100, Loss 1.946421, forward nfe 13692, backward nfe 0, Train: 0.5429, Val: 0.5529, Test: 0.5340, Best time: 18.2948
Epoch: 048, Runtime 13.830903, Loss 1.761857, forward nfe 13988, backward nfe 0, Train: 0.6071, Val: 0.5603, Test: 0.5584, Best time: 12.0000
Epoch: 049, Runtime 13.040671, Loss 1.844407, forward nfe 14284, backward nfe 0, Train: 0.6214, Val: 0.5831, Test: 0.5756, Best time: 9.0000
Epoch: 050, Runtime 13.104333, Loss 1.731299, forward nfe 14580, backward nfe 0, Train: 0.6357, Val: 0.5941, Test: 0.5888, Best time: 7.0000
Epoch: 051, Runtime 12.842907, Loss 1.882337, forward nfe 14876, backward nfe 0, Train: 0.6357, Val: 0.5941, Test: 0.5888, Best time: 18.2948
Epoch: 052, Runtime 13.235923, Loss 1.892015, forward nfe 15172, backward nfe 0, Train: 0.6643, Val: 0.6007, Test: 0.6112, Best time: 6.0000
Epoch: 053, Runtime 13.162835, Loss 1.803506, forward nfe 15468, backward nfe 0, Train: 0.6929, Val: 0.6103, Test: 0.6142, Best time: 6.0000
Epoch: 054, Runtime 13.224853, Loss 1.765520, forward nfe 15764, backward nfe 0, Train: 0.7071, Val: 0.6140, Test: 0.6122, Best time: 7.0000
Epoch: 055, Runtime 12.851811, Loss 1.653100, forward nfe 16060, backward nfe 0, Train: 0.7071, Val: 0.6140, Test: 0.6122, Best time: 18.2948
Epoch: 056, Runtime 11.986746, Loss 1.811096, forward nfe 16356, backward nfe 0, Train: 0.7214, Val: 0.6213, Test: 0.6254, Best time: 11.0000
Epoch: 057, Runtime 11.685008, Loss 1.735934, forward nfe 16652, backward nfe 0, Train: 0.7429, Val: 0.6368, Test: 0.6426, Best time: 10.0000
Epoch: 058, Runtime 11.829977, Loss 1.843131, forward nfe 16948, backward nfe 0, Train: 0.7571, Val: 0.6404, Test: 0.6558, Best time: 8.0000
Epoch: 059, Runtime 11.697181, Loss 1.654457, forward nfe 17244, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 6.0000
Epoch: 060, Runtime 11.778032, Loss 1.771963, forward nfe 17540, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 061, Runtime 11.707423, Loss 1.617910, forward nfe 17836, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 062, Runtime 12.098895, Loss 1.635342, forward nfe 18132, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 063, Runtime 12.126938, Loss 1.667458, forward nfe 18428, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 064, Runtime 12.735277, Loss 1.619939, forward nfe 18724, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 065, Runtime 13.022706, Loss 1.743305, forward nfe 19020, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 066, Runtime 13.309608, Loss 1.511833, forward nfe 19316, backward nfe 0, Train: 0.7786, Val: 0.6419, Test: 0.6569, Best time: 18.2948
Epoch: 067, Runtime 13.527017, Loss 1.489263, forward nfe 19612, backward nfe 0, Train: 0.7357, Val: 0.6529, Test: 0.6619, Best time: 7.0000
Epoch: 068, Runtime 12.202007, Loss 1.429693, forward nfe 19908, backward nfe 0, Train: 0.7643, Val: 0.6596, Test: 0.6690, Best time: 8.0000
Epoch: 069, Runtime 12.052110, Loss 1.479919, forward nfe 20204, backward nfe 0, Train: 0.7857, Val: 0.6765, Test: 0.6772, Best time: 7.0000
Epoch: 070, Runtime 12.186981, Loss 1.426837, forward nfe 20500, backward nfe 0, Train: 0.8071, Val: 0.6787, Test: 0.6843, Best time: 6.0000
Epoch: 071, Runtime 12.172457, Loss 1.569357, forward nfe 20796, backward nfe 0, Train: 0.8214, Val: 0.6853, Test: 0.6964, Best time: 6.0000
Epoch: 072, Runtime 12.419988, Loss 1.529240, forward nfe 21092, backward nfe 0, Train: 0.8000, Val: 0.6941, Test: 0.7025, Best time: 6.0000
Epoch: 073, Runtime 12.063509, Loss 1.598839, forward nfe 21388, backward nfe 0, Train: 0.8429, Val: 0.6993, Test: 0.7249, Best time: 5.0000
Epoch: 074, Runtime 12.271152, Loss 1.547521, forward nfe 21684, backward nfe 0, Train: 0.8429, Val: 0.6993, Test: 0.7249, Best time: 18.2948
Epoch: 075, Runtime 12.386079, Loss 1.573870, forward nfe 21980, backward nfe 0, Train: 0.8429, Val: 0.6993, Test: 0.7249, Best time: 18.2948
Epoch: 076, Runtime 12.880698, Loss 1.476086, forward nfe 22276, backward nfe 0, Train: 0.8429, Val: 0.6993, Test: 0.7249, Best time: 18.2948
Epoch: 077, Runtime 12.969396, Loss 1.482905, forward nfe 22572, backward nfe 0, Train: 0.8429, Val: 0.6993, Test: 0.7249, Best time: 18.2948
Epoch: 078, Runtime 13.534235, Loss 1.440310, forward nfe 22868, backward nfe 0, Train: 0.8429, Val: 0.6993, Test: 0.7249, Best time: 18.2948
Epoch: 079, Runtime 13.742524, Loss 1.293958, forward nfe 23164, backward nfe 0, Train: 0.8571, Val: 0.7096, Test: 0.7147, Best time: 7.0000
Epoch: 080, Runtime 13.329364, Loss 1.355425, forward nfe 23460, backward nfe 0, Train: 0.8643, Val: 0.7132, Test: 0.7188, Best time: 8.0000
Epoch: 081, Runtime 13.234256, Loss 1.497400, forward nfe 23756, backward nfe 0, Train: 0.8643, Val: 0.7132, Test: 0.7188, Best time: 18.2948
Epoch: 082, Runtime 13.469150, Loss 1.306991, forward nfe 24052, backward nfe 0, Train: 0.8857, Val: 0.7162, Test: 0.7178, Best time: 8.0000
Epoch: 083, Runtime 13.136558, Loss 1.313974, forward nfe 24348, backward nfe 0, Train: 0.9286, Val: 0.7176, Test: 0.7431, Best time: 4.0000
Epoch: 084, Runtime 13.292785, Loss 1.217374, forward nfe 24644, backward nfe 0, Train: 0.9000, Val: 0.7272, Test: 0.7482, Best time: 6.0000
Epoch: 085, Runtime 13.348639, Loss 1.426892, forward nfe 24940, backward nfe 0, Train: 0.9000, Val: 0.7309, Test: 0.7452, Best time: 10.0000
Epoch: 086, Runtime 13.163900, Loss 1.466864, forward nfe 25236, backward nfe 0, Train: 0.9357, Val: 0.7324, Test: 0.7503, Best time: 5.0000
Epoch: 087, Runtime 13.631159, Loss 1.430909, forward nfe 25532, backward nfe 0, Train: 0.9214, Val: 0.7331, Test: 0.7452, Best time: 10.0000
Epoch: 088, Runtime 13.084613, Loss 1.336884, forward nfe 25828, backward nfe 0, Train: 0.9214, Val: 0.7331, Test: 0.7452, Best time: 18.2948
Epoch: 089, Runtime 13.717705, Loss 1.223823, forward nfe 26124, backward nfe 0, Train: 0.9214, Val: 0.7331, Test: 0.7452, Best time: 18.2948
Epoch: 090, Runtime 13.592552, Loss 1.341558, forward nfe 26420, backward nfe 0, Train: 0.9214, Val: 0.7331, Test: 0.7452, Best time: 18.2948
Epoch: 091, Runtime 14.127373, Loss 1.280065, forward nfe 26716, backward nfe 0, Train: 0.9214, Val: 0.7331, Test: 0.7452, Best time: 18.2948
Epoch: 092, Runtime 14.239657, Loss 1.132394, forward nfe 27012, backward nfe 0, Train: 0.8714, Val: 0.7412, Test: 0.7442, Best time: 21.0000
Epoch: 093, Runtime 13.438683, Loss 1.254102, forward nfe 27308, backward nfe 0, Train: 0.8500, Val: 0.7662, Test: 0.7624, Best time: 30.0000
Epoch: 094, Runtime 13.434783, Loss 1.150397, forward nfe 27604, backward nfe 0, Train: 0.8071, Val: 0.7809, Test: 0.7665, Best time: 47.0000
Epoch: 095, Runtime 13.485286, Loss 1.297338, forward nfe 27900, backward nfe 0, Train: 0.8643, Val: 0.7956, Test: 0.7726, Best time: 54.0000
Epoch: 096, Runtime 13.233243, Loss 1.172205, forward nfe 28196, backward nfe 0, Train: 0.9071, Val: 0.8007, Test: 0.7909, Best time: 46.0000
Epoch: 097, Runtime 13.196345, Loss 1.191313, forward nfe 28492, backward nfe 0, Train: 0.9071, Val: 0.8007, Test: 0.7909, Best time: 18.2948
Epoch: 098, Runtime 13.638086, Loss 1.285225, forward nfe 28788, backward nfe 0, Train: 0.9071, Val: 0.8007, Test: 0.7909, Best time: 18.2948
Epoch: 099, Runtime 13.206997, Loss 1.290317, forward nfe 29084, backward nfe 0, Train: 0.9071, Val: 0.8007, Test: 0.7909, Best time: 18.2948
best val accuracy 0.800735 with test accuracy 0.790863 at epoch 96 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.7695431472081218
Entropy Threshold: 2 Test accuracy: 0.7634517766497462
Entropy Threshold: 1.6 Test accuracy: 0.7926167209554832
Entropy Threshold: 1.5 Test accuracy: 0.79841449603624
Entropy Threshold: 1.4 Test accuracy: 0.8004778972520908
Entropy Threshold: 1.3 Test accuracy: 0.81282722513089
Entropy Threshold: 1.2 Test accuracy: 0.8363136176066025
Entropy Threshold: 1.1 Test accuracy: 0.8431372549019608
Entropy Threshold: 0.9 Test accuracy: 0.8665413533834586
Entropy Threshold: 0.8 Test accuracy: 0.8779443254817987
Entropy Threshold: 0.7 Test accuracy: 0.8810679611650486
Entropy Threshold: 0.6 Test accuracy: 0.9349112426035503
Entropy Threshold: 0.5 Test accuracy: 0.9143835616438356
Entropy Threshold: 0.4 Test accuracy: 0.9310344827586207
Entropy Threshold: 0.3 Test accuracy: 0.9365853658536586
Entropy Threshold: 0.2 Test accuracy: 0.9407894736842105
Entropy Threshold: 0.1 Test accuracy: 0.9508196721311475
