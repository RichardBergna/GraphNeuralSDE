[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.7
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 9.828616, Loss 2.106961, forward nfe 76, backward nfe 0, Train: 0.1214, Val: 0.2581, Test: 0.2650, Best time: 54.8843
Epoch: 002, Runtime 9.927599, Loss 2.280292, forward nfe 372, backward nfe 0, Train: 0.6500, Val: 0.5846, Test: 0.5939, Best time: 4.0000
Epoch: 003, Runtime 9.935458, Loss 2.112880, forward nfe 668, backward nfe 0, Train: 0.6500, Val: 0.5846, Test: 0.5939, Best time: 18.2948
Epoch: 004, Runtime 10.188223, Loss 1.979276, forward nfe 964, backward nfe 0, Train: 0.6500, Val: 0.5846, Test: 0.5939, Best time: 18.2948
Epoch: 005, Runtime 10.001593, Loss 2.083194, forward nfe 1260, backward nfe 0, Train: 0.6500, Val: 0.5846, Test: 0.5939, Best time: 18.2948
Epoch: 006, Runtime 10.166431, Loss 1.960546, forward nfe 1556, backward nfe 0, Train: 0.6929, Val: 0.6419, Test: 0.6487, Best time: 8.0000
Epoch: 007, Runtime 9.890407, Loss 1.804030, forward nfe 1852, backward nfe 0, Train: 0.7286, Val: 0.6809, Test: 0.6782, Best time: 8.0000
Epoch: 008, Runtime 9.857723, Loss 1.730399, forward nfe 2148, backward nfe 0, Train: 0.7786, Val: 0.7074, Test: 0.6934, Best time: 15.0000
Epoch: 009, Runtime 9.669865, Loss 1.656852, forward nfe 2444, backward nfe 0, Train: 0.7786, Val: 0.7074, Test: 0.6934, Best time: 18.2948
Epoch: 010, Runtime 10.072790, Loss 1.503010, forward nfe 2740, backward nfe 0, Train: 0.7786, Val: 0.7074, Test: 0.6934, Best time: 18.2948
Epoch: 011, Runtime 10.016976, Loss 1.372705, forward nfe 3036, backward nfe 0, Train: 0.7786, Val: 0.7074, Test: 0.6934, Best time: 18.2948
Epoch: 012, Runtime 10.025887, Loss 1.183457, forward nfe 3332, backward nfe 0, Train: 0.7786, Val: 0.7074, Test: 0.6934, Best time: 18.2948
Epoch: 013, Runtime 9.440508, Loss 1.162079, forward nfe 3628, backward nfe 0, Train: 0.7929, Val: 0.7287, Test: 0.7381, Best time: 8.0000
Epoch: 014, Runtime 10.083328, Loss 0.978554, forward nfe 3924, backward nfe 0, Train: 0.8143, Val: 0.7537, Test: 0.7645, Best time: 10.0000
Epoch: 015, Runtime 9.923342, Loss 0.889818, forward nfe 4220, backward nfe 0, Train: 0.8143, Val: 0.7537, Test: 0.7645, Best time: 18.2948
Epoch: 016, Runtime 10.353050, Loss 0.878460, forward nfe 4516, backward nfe 0, Train: 0.8500, Val: 0.7559, Test: 0.7655, Best time: 8.0000
Epoch: 017, Runtime 10.031265, Loss 0.814614, forward nfe 4812, backward nfe 0, Train: 0.8500, Val: 0.7610, Test: 0.7614, Best time: 14.0000
Epoch: 018, Runtime 9.893559, Loss 0.744368, forward nfe 5108, backward nfe 0, Train: 0.8500, Val: 0.7610, Test: 0.7614, Best time: 18.2948
Epoch: 019, Runtime 10.269590, Loss 0.722567, forward nfe 5404, backward nfe 0, Train: 0.8714, Val: 0.7640, Test: 0.7756, Best time: 17.0000
Epoch: 020, Runtime 9.966085, Loss 0.737052, forward nfe 5700, backward nfe 0, Train: 0.8929, Val: 0.7765, Test: 0.7848, Best time: 14.0000
Epoch: 021, Runtime 9.920537, Loss 0.737571, forward nfe 5996, backward nfe 0, Train: 0.8429, Val: 0.7853, Test: 0.7736, Best time: 18.2948
Epoch: 022, Runtime 10.012123, Loss 0.638761, forward nfe 6292, backward nfe 0, Train: 0.9071, Val: 0.8007, Test: 0.8030, Best time: 27.0000
Epoch: 023, Runtime 9.878917, Loss 0.543456, forward nfe 6588, backward nfe 0, Train: 0.9286, Val: 0.8066, Test: 0.8051, Best time: 27.0000
Epoch: 024, Runtime 9.851695, Loss 0.549440, forward nfe 6884, backward nfe 0, Train: 0.9071, Val: 0.8081, Test: 0.7990, Best time: 43.0000
Epoch: 025, Runtime 9.694263, Loss 0.564302, forward nfe 7180, backward nfe 0, Train: 0.9071, Val: 0.8081, Test: 0.7990, Best time: 18.2948
Epoch: 026, Runtime 10.123254, Loss 0.554854, forward nfe 7476, backward nfe 0, Train: 0.9071, Val: 0.8081, Test: 0.7990, Best time: 18.2948
Epoch: 027, Runtime 9.981035, Loss 0.516000, forward nfe 7772, backward nfe 0, Train: 0.9071, Val: 0.8081, Test: 0.7990, Best time: 18.2948
Epoch: 028, Runtime 10.158507, Loss 0.536098, forward nfe 8068, backward nfe 0, Train: 0.9429, Val: 0.8132, Test: 0.8071, Best time: 33.0000
Epoch: 029, Runtime 9.505925, Loss 0.485983, forward nfe 8364, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 54.8843
Epoch: 030, Runtime 9.801277, Loss 0.562196, forward nfe 8660, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 031, Runtime 10.330436, Loss 0.516007, forward nfe 8956, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 032, Runtime 10.101821, Loss 0.486462, forward nfe 9252, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 033, Runtime 10.024153, Loss 0.520645, forward nfe 9548, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 034, Runtime 10.437780, Loss 0.464286, forward nfe 9844, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 035, Runtime 10.349513, Loss 0.450416, forward nfe 10140, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 036, Runtime 10.456877, Loss 0.407156, forward nfe 10436, backward nfe 0, Train: 0.9071, Val: 0.8213, Test: 0.8112, Best time: 18.2948
Epoch: 037, Runtime 10.974778, Loss 0.423390, forward nfe 10732, backward nfe 0, Train: 0.9714, Val: 0.8257, Test: 0.8193, Best time: 50.0000
Epoch: 038, Runtime 9.658308, Loss 0.448790, forward nfe 11028, backward nfe 0, Train: 0.9714, Val: 0.8257, Test: 0.8193, Best time: 18.2948
Epoch: 039, Runtime 10.005425, Loss 0.394838, forward nfe 11324, backward nfe 0, Train: 0.9714, Val: 0.8257, Test: 0.8193, Best time: 18.2948
Epoch: 040, Runtime 9.943349, Loss 0.414686, forward nfe 11620, backward nfe 0, Train: 0.9714, Val: 0.8257, Test: 0.8193, Best time: 18.2948
Epoch: 041, Runtime 10.154242, Loss 0.447788, forward nfe 11916, backward nfe 0, Train: 0.9857, Val: 0.8287, Test: 0.8244, Best time: 47.0000
Epoch: 042, Runtime 9.883782, Loss 0.345603, forward nfe 12212, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 30.0000
Epoch: 043, Runtime 9.718571, Loss 0.412538, forward nfe 12508, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 044, Runtime 10.116652, Loss 0.365913, forward nfe 12804, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 045, Runtime 10.066729, Loss 0.323352, forward nfe 13100, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 046, Runtime 10.062903, Loss 0.329148, forward nfe 13396, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 047, Runtime 10.445145, Loss 0.369655, forward nfe 13692, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 048, Runtime 10.324168, Loss 0.341885, forward nfe 13988, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 049, Runtime 10.514827, Loss 0.285288, forward nfe 14284, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 050, Runtime 10.667216, Loss 0.357213, forward nfe 14580, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 051, Runtime 10.604831, Loss 0.262020, forward nfe 14876, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 052, Runtime 10.624628, Loss 0.297924, forward nfe 15172, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 053, Runtime 10.928782, Loss 0.383262, forward nfe 15468, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 054, Runtime 10.834482, Loss 0.305995, forward nfe 15764, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 055, Runtime 10.903985, Loss 0.335359, forward nfe 16060, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 056, Runtime 11.220974, Loss 0.280182, forward nfe 16356, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 057, Runtime 11.163276, Loss 0.344819, forward nfe 16652, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 058, Runtime 11.148103, Loss 0.271528, forward nfe 16948, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 059, Runtime 11.287632, Loss 0.330269, forward nfe 17244, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 060, Runtime 11.321173, Loss 0.289371, forward nfe 17540, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 061, Runtime 11.396600, Loss 0.343283, forward nfe 17836, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 062, Runtime 11.401140, Loss 0.280551, forward nfe 18132, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 063, Runtime 11.177849, Loss 0.248043, forward nfe 18428, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 064, Runtime 10.477513, Loss 0.330599, forward nfe 18724, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 065, Runtime 10.418216, Loss 0.280132, forward nfe 19020, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 066, Runtime 10.503533, Loss 0.351290, forward nfe 19316, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 067, Runtime 10.577420, Loss 0.337940, forward nfe 19612, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 068, Runtime 10.634517, Loss 0.258138, forward nfe 19908, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 069, Runtime 10.640200, Loss 0.202007, forward nfe 20204, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 070, Runtime 11.786395, Loss 0.271562, forward nfe 20500, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 071, Runtime 11.253964, Loss 0.287777, forward nfe 20796, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 072, Runtime 12.022082, Loss 0.291152, forward nfe 21092, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 073, Runtime 11.877090, Loss 0.280070, forward nfe 21388, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 074, Runtime 11.900507, Loss 0.255496, forward nfe 21684, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 075, Runtime 11.952856, Loss 0.203303, forward nfe 21980, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 076, Runtime 11.978631, Loss 0.246028, forward nfe 22276, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 077, Runtime 12.037794, Loss 0.207500, forward nfe 22572, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 078, Runtime 12.039839, Loss 0.188928, forward nfe 22868, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 079, Runtime 11.989737, Loss 0.255246, forward nfe 23164, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 080, Runtime 12.104970, Loss 0.254336, forward nfe 23460, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 081, Runtime 12.084283, Loss 0.288195, forward nfe 23756, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 082, Runtime 12.031175, Loss 0.284767, forward nfe 24052, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 083, Runtime 12.076371, Loss 0.267077, forward nfe 24348, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 084, Runtime 12.205875, Loss 0.228269, forward nfe 24644, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 085, Runtime 12.244786, Loss 0.214109, forward nfe 24940, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 086, Runtime 12.243828, Loss 0.205562, forward nfe 25236, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 087, Runtime 11.478099, Loss 0.176577, forward nfe 25532, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 088, Runtime 11.110218, Loss 0.217587, forward nfe 25828, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 089, Runtime 12.464298, Loss 0.262163, forward nfe 26124, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 090, Runtime 11.701241, Loss 0.207676, forward nfe 26420, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 091, Runtime 11.070156, Loss 0.281140, forward nfe 26716, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 092, Runtime 11.141470, Loss 0.261598, forward nfe 27012, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 093, Runtime 11.258429, Loss 0.198740, forward nfe 27308, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 094, Runtime 12.684382, Loss 0.230500, forward nfe 27604, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 095, Runtime 12.469642, Loss 0.175051, forward nfe 27900, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 096, Runtime 12.118087, Loss 0.268709, forward nfe 28196, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 097, Runtime 12.508141, Loss 0.177664, forward nfe 28492, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 098, Runtime 12.613498, Loss 0.214406, forward nfe 28788, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
Epoch: 099, Runtime 12.668911, Loss 0.216841, forward nfe 29084, backward nfe 0, Train: 0.9857, Val: 0.8301, Test: 0.8315, Best time: 18.2948
best val accuracy 0.830147 with test accuracy 0.831472 at epoch 42 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8203045685279188
Entropy Threshold: 2 Test accuracy: 0.8142131979695432
Entropy Threshold: 1.6 Test accuracy: 0.8212809917355371
Entropy Threshold: 1.5 Test accuracy: 0.8333333333333334
Entropy Threshold: 1.4 Test accuracy: 0.8405951115834219
Entropy Threshold: 1.3 Test accuracy: 0.8498367791077258
Entropy Threshold: 1.2 Test accuracy: 0.855715871254162
Entropy Threshold: 1.1 Test accuracy: 0.8701149425287357
Entropy Threshold: 0.9 Test accuracy: 0.8825710754017305
Entropy Threshold: 0.8 Test accuracy: 0.891644908616188
Entropy Threshold: 0.7 Test accuracy: 0.9145658263305322
Entropy Threshold: 0.6 Test accuracy: 0.9342301943198804
Entropy Threshold: 0.5 Test accuracy: 0.9407051282051282
Entropy Threshold: 0.4 Test accuracy: 0.9494097807757167
Entropy Threshold: 0.3 Test accuracy: 0.9552238805970149
Entropy Threshold: 0.2 Test accuracy: 0.9572301425661914
Entropy Threshold: 0.1 Test accuracy: 0.9612590799031477
