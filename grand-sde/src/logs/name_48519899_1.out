[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.1
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 14.815579, Loss 1.983966, forward nfe 76, backward nfe 0, Train: 0.6500, Val: 0.4934, Test: 0.4832, Best time: 4.0000
Epoch: 002, Runtime 14.723466, Loss 1.799312, forward nfe 372, backward nfe 0, Train: 0.9000, Val: 0.7485, Test: 0.7411, Best time: 12.0000
Epoch: 003, Runtime 14.492985, Loss 1.548503, forward nfe 668, backward nfe 0, Train: 0.9143, Val: 0.8051, Test: 0.7817, Best time: 15.0000
Epoch: 004, Runtime 14.064981, Loss 1.195732, forward nfe 964, backward nfe 0, Train: 0.9143, Val: 0.8051, Test: 0.7817, Best time: 18.2948
Epoch: 005, Runtime 14.643813, Loss 0.903337, forward nfe 1260, backward nfe 0, Train: 0.9143, Val: 0.8051, Test: 0.7817, Best time: 18.2948
Epoch: 006, Runtime 15.765097, Loss 0.654260, forward nfe 1556, backward nfe 0, Train: 0.9357, Val: 0.8199, Test: 0.8061, Best time: 14.0000
Epoch: 007, Runtime 14.487425, Loss 0.468693, forward nfe 1852, backward nfe 0, Train: 0.9500, Val: 0.8338, Test: 0.8274, Best time: 50.0000
Epoch: 008, Runtime 14.221001, Loss 0.350559, forward nfe 2148, backward nfe 0, Train: 0.9500, Val: 0.8338, Test: 0.8274, Best time: 18.2948
Epoch: 009, Runtime 14.769403, Loss 0.320541, forward nfe 2444, backward nfe 0, Train: 0.9500, Val: 0.8338, Test: 0.8274, Best time: 18.2948
Epoch: 010, Runtime 15.041798, Loss 0.259144, forward nfe 2740, backward nfe 0, Train: 0.9500, Val: 0.8338, Test: 0.8274, Best time: 18.2948
Epoch: 011, Runtime 14.686604, Loss 0.248002, forward nfe 3036, backward nfe 0, Train: 0.9500, Val: 0.8338, Test: 0.8274, Best time: 18.2948
Epoch: 012, Runtime 14.838559, Loss 0.201349, forward nfe 3332, backward nfe 0, Train: 0.9786, Val: 0.8382, Test: 0.8284, Best time: 14.0000
Epoch: 013, Runtime 14.340400, Loss 0.226150, forward nfe 3628, backward nfe 0, Train: 0.9929, Val: 0.8404, Test: 0.8355, Best time: 14.0000
Epoch: 014, Runtime 14.030724, Loss 0.154691, forward nfe 3924, backward nfe 0, Train: 0.9929, Val: 0.8404, Test: 0.8355, Best time: 18.2948
Epoch: 015, Runtime 14.725137, Loss 0.175868, forward nfe 4220, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 32.0000
Epoch: 016, Runtime 13.883185, Loss 0.206053, forward nfe 4516, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 017, Runtime 14.440316, Loss 0.225614, forward nfe 4812, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 018, Runtime 15.069320, Loss 0.216621, forward nfe 5108, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 019, Runtime 14.536553, Loss 0.225186, forward nfe 5404, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 020, Runtime 14.401187, Loss 0.191637, forward nfe 5700, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 021, Runtime 14.813557, Loss 0.189650, forward nfe 5996, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 022, Runtime 15.168385, Loss 0.163800, forward nfe 6292, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 023, Runtime 14.695025, Loss 0.223114, forward nfe 6588, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 024, Runtime 14.850507, Loss 0.151917, forward nfe 6884, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 025, Runtime 15.273415, Loss 0.209291, forward nfe 7180, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 026, Runtime 15.344079, Loss 0.208855, forward nfe 7476, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 027, Runtime 15.043108, Loss 0.166094, forward nfe 7772, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 028, Runtime 15.186586, Loss 0.161798, forward nfe 8068, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 029, Runtime 15.418751, Loss 0.200741, forward nfe 8364, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 030, Runtime 15.593417, Loss 0.116582, forward nfe 8660, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 031, Runtime 15.481929, Loss 0.135150, forward nfe 8956, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 032, Runtime 15.368293, Loss 0.161932, forward nfe 9252, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 033, Runtime 15.444416, Loss 0.181794, forward nfe 9548, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 034, Runtime 15.666155, Loss 0.206629, forward nfe 9844, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 035, Runtime 15.624355, Loss 0.186571, forward nfe 10140, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 036, Runtime 15.573910, Loss 0.195380, forward nfe 10436, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 037, Runtime 15.643012, Loss 0.116832, forward nfe 10732, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 038, Runtime 15.922297, Loss 0.167693, forward nfe 11028, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 039, Runtime 15.936098, Loss 0.146701, forward nfe 11324, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 040, Runtime 15.861205, Loss 0.121600, forward nfe 11620, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 041, Runtime 16.011660, Loss 0.147426, forward nfe 11916, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 042, Runtime 16.027447, Loss 0.154011, forward nfe 12212, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 043, Runtime 15.947855, Loss 0.171942, forward nfe 12508, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 044, Runtime 15.884000, Loss 0.120833, forward nfe 12804, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 045, Runtime 15.878386, Loss 0.116931, forward nfe 13100, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 046, Runtime 16.118122, Loss 0.141832, forward nfe 13396, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 047, Runtime 15.999413, Loss 0.153324, forward nfe 13692, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 048, Runtime 15.928032, Loss 0.113182, forward nfe 13988, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 049, Runtime 16.073569, Loss 0.127222, forward nfe 14284, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 050, Runtime 16.414127, Loss 0.122964, forward nfe 14580, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 051, Runtime 16.342367, Loss 0.143650, forward nfe 14876, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 052, Runtime 16.158957, Loss 0.121553, forward nfe 15172, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 053, Runtime 16.343430, Loss 0.128287, forward nfe 15468, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 054, Runtime 16.539768, Loss 0.143034, forward nfe 15764, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 055, Runtime 16.432941, Loss 0.125347, forward nfe 16060, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 056, Runtime 16.330504, Loss 0.140656, forward nfe 16356, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 057, Runtime 16.428372, Loss 0.133917, forward nfe 16652, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 058, Runtime 16.263856, Loss 0.130478, forward nfe 16948, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 059, Runtime 16.282351, Loss 0.125953, forward nfe 17244, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 060, Runtime 16.475940, Loss 0.132637, forward nfe 17540, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 061, Runtime 16.516968, Loss 0.138147, forward nfe 17836, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 062, Runtime 16.399844, Loss 0.086389, forward nfe 18132, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 063, Runtime 16.341665, Loss 0.120666, forward nfe 18428, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 064, Runtime 16.386535, Loss 0.127299, forward nfe 18724, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 065, Runtime 16.390384, Loss 0.127189, forward nfe 19020, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 066, Runtime 16.311478, Loss 0.143132, forward nfe 19316, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 067, Runtime 16.433062, Loss 0.112368, forward nfe 19612, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 068, Runtime 16.476649, Loss 0.100912, forward nfe 19908, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 069, Runtime 16.318645, Loss 0.104266, forward nfe 20204, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 070, Runtime 16.393777, Loss 0.094730, forward nfe 20500, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 071, Runtime 16.615805, Loss 0.117148, forward nfe 20796, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 072, Runtime 16.498016, Loss 0.092571, forward nfe 21092, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 073, Runtime 16.455492, Loss 0.132549, forward nfe 21388, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 074, Runtime 16.558718, Loss 0.117545, forward nfe 21684, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 075, Runtime 16.644471, Loss 0.141474, forward nfe 21980, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 076, Runtime 16.644029, Loss 0.137371, forward nfe 22276, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 077, Runtime 16.596452, Loss 0.123540, forward nfe 22572, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 078, Runtime 16.699624, Loss 0.106395, forward nfe 22868, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 079, Runtime 16.817937, Loss 0.123435, forward nfe 23164, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 080, Runtime 16.710835, Loss 0.121120, forward nfe 23460, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 081, Runtime 16.626300, Loss 0.127238, forward nfe 23756, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 082, Runtime 15.908463, Loss 0.095583, forward nfe 24052, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 083, Runtime 15.467833, Loss 0.124036, forward nfe 24348, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 084, Runtime 12.059344, Loss 0.126979, forward nfe 24644, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 085, Runtime 11.953453, Loss 0.097945, forward nfe 24940, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 086, Runtime 11.946284, Loss 0.095687, forward nfe 25236, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 087, Runtime 12.133610, Loss 0.096996, forward nfe 25532, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 088, Runtime 11.909559, Loss 0.088322, forward nfe 25828, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 089, Runtime 11.928434, Loss 0.135797, forward nfe 26124, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 090, Runtime 12.116736, Loss 0.115009, forward nfe 26420, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 091, Runtime 12.091087, Loss 0.121180, forward nfe 26716, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 092, Runtime 11.975153, Loss 0.104690, forward nfe 27012, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 093, Runtime 12.178057, Loss 0.108556, forward nfe 27308, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 094, Runtime 12.273076, Loss 0.083361, forward nfe 27604, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 095, Runtime 12.622065, Loss 0.167075, forward nfe 27900, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 096, Runtime 12.627020, Loss 0.096514, forward nfe 28196, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 097, Runtime 12.702775, Loss 0.095294, forward nfe 28492, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 098, Runtime 12.681191, Loss 0.097328, forward nfe 28788, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
Epoch: 099, Runtime 12.775743, Loss 0.132050, forward nfe 29084, backward nfe 0, Train: 0.9786, Val: 0.8441, Test: 0.8406, Best time: 18.2948
best val accuracy 0.844118 with test accuracy 0.840609 at epoch 15 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8365482233502538
Entropy Threshold: 2 Test accuracy: 0.8345177664974619
Entropy Threshold: 1.6 Test accuracy: 0.8333333333333334
Entropy Threshold: 1.5 Test accuracy: 0.836901121304791
Entropy Threshold: 1.4 Test accuracy: 0.837948717948718
Entropy Threshold: 1.3 Test accuracy: 0.8459152016546019
Entropy Threshold: 1.2 Test accuracy: 0.8447916666666667
Entropy Threshold: 1.1 Test accuracy: 0.8503688092729189
Entropy Threshold: 0.9 Test accuracy: 0.8653637350705755
Entropy Threshold: 0.8 Test accuracy: 0.8712541620421753
Entropy Threshold: 0.7 Test accuracy: 0.89198606271777
Entropy Threshold: 0.6 Test accuracy: 0.9077490774907749
Entropy Threshold: 0.5 Test accuracy: 0.9181585677749361
Entropy Threshold: 0.4 Test accuracy: 0.9292389853137517
Entropy Threshold: 0.3 Test accuracy: 0.9357541899441341
Entropy Threshold: 0.2 Test accuracy: 0.9507462686567164
Entropy Threshold: 0.1 Test accuracy: 0.9630252100840336
