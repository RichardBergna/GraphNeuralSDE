[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 3.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 21.931659, Loss 2.362667, forward nfe 76, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 1.0000
Epoch: 002, Runtime 35.805943, Loss 9.936853, forward nfe 372, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 003, Runtime 22.805219, Loss 2.675689, forward nfe 668, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 004, Runtime 22.577661, Loss 2.851579, forward nfe 964, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 005, Runtime 24.638600, Loss 3.099470, forward nfe 1260, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 006, Runtime 28.250905, Loss 3.537464, forward nfe 1556, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 007, Runtime 29.918632, Loss 3.311420, forward nfe 1852, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 008, Runtime 28.631768, Loss 2.652185, forward nfe 2148, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 009, Runtime 28.672743, Loss 2.518176, forward nfe 2444, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 010, Runtime 29.235504, Loss 2.584886, forward nfe 2740, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 011, Runtime 29.835276, Loss 2.768519, forward nfe 3036, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 012, Runtime 29.830688, Loss 2.559106, forward nfe 3332, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 013, Runtime 30.035218, Loss 2.501091, forward nfe 3628, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 014, Runtime 29.718604, Loss 2.637681, forward nfe 3924, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 015, Runtime 30.156004, Loss 2.665280, forward nfe 4220, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 016, Runtime 27.472260, Loss 2.525301, forward nfe 4516, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 017, Runtime 27.413112, Loss 2.446476, forward nfe 4812, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 018, Runtime 27.074671, Loss 2.419132, forward nfe 5108, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 019, Runtime 27.102162, Loss 2.550061, forward nfe 5404, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 020, Runtime 26.764126, Loss 2.295607, forward nfe 5700, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 021, Runtime 27.094940, Loss 2.335993, forward nfe 5996, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 022, Runtime 27.213131, Loss 2.399918, forward nfe 6292, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 023, Runtime 26.975972, Loss 2.278544, forward nfe 6588, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 024, Runtime 27.169452, Loss 2.456857, forward nfe 6884, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 025, Runtime 27.531983, Loss 2.182152, forward nfe 7180, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 026, Runtime 27.469163, Loss 2.413023, forward nfe 7476, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 027, Runtime 27.288531, Loss 2.273444, forward nfe 7772, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 028, Runtime 28.327538, Loss 2.245188, forward nfe 8068, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 029, Runtime 29.516655, Loss 2.197221, forward nfe 8364, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 030, Runtime 29.631227, Loss 2.228587, forward nfe 8660, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 031, Runtime 27.737867, Loss 2.263503, forward nfe 8956, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 032, Runtime 25.220742, Loss 2.193190, forward nfe 9252, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 033, Runtime 25.626068, Loss 2.389015, forward nfe 9548, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 034, Runtime 25.374805, Loss 2.260859, forward nfe 9844, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 035, Runtime 25.252273, Loss 2.261451, forward nfe 10140, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 036, Runtime 25.500626, Loss 2.311766, forward nfe 10436, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 037, Runtime 27.719177, Loss 2.361167, forward nfe 10732, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 038, Runtime 30.225456, Loss 2.292729, forward nfe 11028, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 039, Runtime 25.539185, Loss 2.236431, forward nfe 11324, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 040, Runtime 20.719633, Loss 2.239781, forward nfe 11620, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 041, Runtime 21.274572, Loss 2.261194, forward nfe 11916, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 042, Runtime 21.641366, Loss 2.205672, forward nfe 12212, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 043, Runtime 21.740104, Loss 2.221740, forward nfe 12508, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 044, Runtime 22.308932, Loss 2.265502, forward nfe 12804, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 045, Runtime 22.756034, Loss 2.199273, forward nfe 13100, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 046, Runtime 22.632666, Loss 2.269354, forward nfe 13396, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 047, Runtime 23.218097, Loss 2.237504, forward nfe 13692, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 048, Runtime 23.720312, Loss 2.208812, forward nfe 13988, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 049, Runtime 24.394617, Loss 2.196742, forward nfe 14284, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 050, Runtime 24.985355, Loss 2.228262, forward nfe 14580, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 051, Runtime 25.319547, Loss 2.238478, forward nfe 14876, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 052, Runtime 26.049958, Loss 2.097132, forward nfe 15172, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 053, Runtime 26.590749, Loss 2.036603, forward nfe 15468, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 054, Runtime 26.889763, Loss 2.128239, forward nfe 15764, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 055, Runtime 27.173292, Loss 2.215597, forward nfe 16060, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 056, Runtime 28.439332, Loss 2.078437, forward nfe 16356, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 057, Runtime 29.586871, Loss 2.102446, forward nfe 16652, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 058, Runtime 29.815135, Loss 2.066925, forward nfe 16948, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 059, Runtime 28.710143, Loss 2.175745, forward nfe 17244, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 060, Runtime 28.463201, Loss 2.217463, forward nfe 17540, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 061, Runtime 24.954920, Loss 2.172776, forward nfe 17836, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 062, Runtime 24.544028, Loss 2.050016, forward nfe 18132, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 063, Runtime 24.678226, Loss 2.195183, forward nfe 18428, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 064, Runtime 24.845777, Loss 2.216284, forward nfe 18724, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 065, Runtime 24.991129, Loss 2.054585, forward nfe 19020, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 066, Runtime 25.113595, Loss 2.176028, forward nfe 19316, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 067, Runtime 25.626865, Loss 2.121377, forward nfe 19612, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 068, Runtime 25.923204, Loss 2.086191, forward nfe 19908, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 069, Runtime 26.322462, Loss 2.230679, forward nfe 20204, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 070, Runtime 26.425038, Loss 2.222164, forward nfe 20500, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 071, Runtime 26.335382, Loss 2.173110, forward nfe 20796, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 072, Runtime 26.283003, Loss 2.056524, forward nfe 21092, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 073, Runtime 26.429120, Loss 2.071761, forward nfe 21388, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 074, Runtime 26.319616, Loss 2.104477, forward nfe 21684, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 075, Runtime 26.424881, Loss 2.089673, forward nfe 21980, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 076, Runtime 26.721936, Loss 2.117990, forward nfe 22276, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 077, Runtime 26.848856, Loss 2.132158, forward nfe 22572, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 078, Runtime 26.678913, Loss 2.077266, forward nfe 22868, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 079, Runtime 26.707856, Loss 2.136422, forward nfe 23164, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 080, Runtime 26.178248, Loss 2.130987, forward nfe 23460, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 081, Runtime 25.556453, Loss 2.066189, forward nfe 23756, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 082, Runtime 24.946954, Loss 2.114736, forward nfe 24052, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 083, Runtime 23.697127, Loss 2.153863, forward nfe 24348, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 084, Runtime 20.786336, Loss 2.043880, forward nfe 24644, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 085, Runtime 16.173249, Loss 2.117616, forward nfe 24940, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 086, Runtime 15.845321, Loss 2.065592, forward nfe 25236, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 087, Runtime 15.726274, Loss 2.076057, forward nfe 25532, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 088, Runtime 16.013506, Loss 2.070556, forward nfe 25828, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 089, Runtime 16.393231, Loss 2.071473, forward nfe 26124, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 090, Runtime 16.368151, Loss 2.098435, forward nfe 26420, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 091, Runtime 17.104127, Loss 2.104707, forward nfe 26716, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 092, Runtime 17.541781, Loss 2.003687, forward nfe 27012, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 093, Runtime 17.706628, Loss 2.172398, forward nfe 27308, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 094, Runtime 18.222049, Loss 2.051117, forward nfe 27604, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 095, Runtime 18.266887, Loss 2.012364, forward nfe 27900, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 096, Runtime 18.447115, Loss 2.092451, forward nfe 28196, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 097, Runtime 19.010219, Loss 2.043753, forward nfe 28492, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 098, Runtime 19.422531, Loss 2.071260, forward nfe 28788, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
Epoch: 099, Runtime 19.558615, Loss 2.013616, forward nfe 29084, backward nfe 0, Train: 0.3643, Val: 0.3949, Test: 0.3797, Best time: 18.2948
best val accuracy 0.394853 with test accuracy 0.379695 at epoch 1 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.08426395939086294
Entropy Threshold: 2 Test accuracy: 0.08426395939086294
Entropy Threshold: 1.6 Test accuracy: 0.08426395939086294
Entropy Threshold: 1.5 Test accuracy: 0.08426395939086294
Entropy Threshold: 1.4 Test accuracy: 0.08426395939086294
Entropy Threshold: 1.3 Test accuracy: 0.08426395939086294
Entropy Threshold: 1.2 Test accuracy: 0.08426395939086294
Entropy Threshold: 1.1 Test accuracy: 0.08426395939086294
Entropy Threshold: 0.9 Test accuracy: 0.08426395939086294
Entropy Threshold: 0.8 Test accuracy: 0.08426395939086294
Entropy Threshold: 0.7 Test accuracy: 0.08426395939086294
Entropy Threshold: 0.6 Test accuracy: 0.08426395939086294
Entropy Threshold: 0.5 Test accuracy: 0.08434959349593496
Entropy Threshold: 0.4 Test accuracy: 0.08434959349593496
Entropy Threshold: 0.3 Test accuracy: 0.08434959349593496
Entropy Threshold: 0.2 Test accuracy: 0.0836734693877551
Entropy Threshold: 0.1 Test accuracy: 0.08176795580110498
