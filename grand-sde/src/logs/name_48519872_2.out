[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 15.403691, Loss 2.063011, forward nfe 76, backward nfe 0, Train: 0.5429, Val: 0.4699, Test: 0.5168, Best time: 2.0000
Epoch: 002, Runtime 16.709500, Loss 2.111023, forward nfe 372, backward nfe 0, Train: 0.6643, Val: 0.5985, Test: 0.6315, Best time: 3.0000
Epoch: 003, Runtime 14.113852, Loss 2.028017, forward nfe 668, backward nfe 0, Train: 0.6643, Val: 0.5985, Test: 0.6315, Best time: 18.2948
Epoch: 004, Runtime 14.300890, Loss 2.024550, forward nfe 964, backward nfe 0, Train: 0.6643, Val: 0.5985, Test: 0.6315, Best time: 18.2948
Epoch: 005, Runtime 14.421409, Loss 2.135618, forward nfe 1260, backward nfe 0, Train: 0.6643, Val: 0.5985, Test: 0.6315, Best time: 18.2948
Epoch: 006, Runtime 14.839630, Loss 1.910311, forward nfe 1556, backward nfe 0, Train: 0.8357, Val: 0.7029, Test: 0.7279, Best time: 7.0000
Epoch: 007, Runtime 13.975138, Loss 1.757420, forward nfe 1852, backward nfe 0, Train: 0.8714, Val: 0.7353, Test: 0.7503, Best time: 5.0000
Epoch: 008, Runtime 13.393821, Loss 1.674394, forward nfe 2148, backward nfe 0, Train: 0.8571, Val: 0.7426, Test: 0.7685, Best time: 7.0000
Epoch: 009, Runtime 13.184839, Loss 1.490148, forward nfe 2444, backward nfe 0, Train: 0.8571, Val: 0.7426, Test: 0.7685, Best time: 18.2948
Epoch: 010, Runtime 13.744107, Loss 1.354270, forward nfe 2740, backward nfe 0, Train: 0.8571, Val: 0.7426, Test: 0.7685, Best time: 18.2948
Epoch: 011, Runtime 13.487147, Loss 1.175532, forward nfe 3036, backward nfe 0, Train: 0.8571, Val: 0.7426, Test: 0.7685, Best time: 18.2948
Epoch: 012, Runtime 13.632512, Loss 1.137891, forward nfe 3332, backward nfe 0, Train: 0.8571, Val: 0.7426, Test: 0.7685, Best time: 18.2948
Epoch: 013, Runtime 14.062906, Loss 1.049940, forward nfe 3628, backward nfe 0, Train: 0.8571, Val: 0.7426, Test: 0.7685, Best time: 18.2948
Epoch: 014, Runtime 14.117381, Loss 0.970988, forward nfe 3924, backward nfe 0, Train: 0.8571, Val: 0.7456, Test: 0.7604, Best time: 8.0000
Epoch: 015, Runtime 13.310893, Loss 0.830433, forward nfe 4220, backward nfe 0, Train: 0.8643, Val: 0.7640, Test: 0.7817, Best time: 15.0000
Epoch: 016, Runtime 13.561748, Loss 0.813413, forward nfe 4516, backward nfe 0, Train: 0.8786, Val: 0.7676, Test: 0.7868, Best time: 14.0000
Epoch: 017, Runtime 13.305896, Loss 0.772648, forward nfe 4812, backward nfe 0, Train: 0.8786, Val: 0.7676, Test: 0.7868, Best time: 18.2948
Epoch: 018, Runtime 13.774777, Loss 0.698776, forward nfe 5108, backward nfe 0, Train: 0.8786, Val: 0.7676, Test: 0.7868, Best time: 18.2948
Epoch: 019, Runtime 13.717008, Loss 0.657081, forward nfe 5404, backward nfe 0, Train: 0.8786, Val: 0.7676, Test: 0.7868, Best time: 18.2948
Epoch: 020, Runtime 13.919007, Loss 0.585909, forward nfe 5700, backward nfe 0, Train: 0.9286, Val: 0.7846, Test: 0.7929, Best time: 19.0000
Epoch: 021, Runtime 13.608749, Loss 0.653283, forward nfe 5996, backward nfe 0, Train: 0.9286, Val: 0.8059, Test: 0.8305, Best time: 51.0000
Epoch: 022, Runtime 13.337853, Loss 0.529836, forward nfe 6292, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 35.0000
Epoch: 023, Runtime 13.197674, Loss 0.615095, forward nfe 6588, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 024, Runtime 13.312665, Loss 0.524079, forward nfe 6884, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 025, Runtime 13.285997, Loss 0.556399, forward nfe 7180, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 026, Runtime 13.409879, Loss 0.484340, forward nfe 7476, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 027, Runtime 13.859870, Loss 0.504952, forward nfe 7772, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 028, Runtime 13.668958, Loss 0.523815, forward nfe 8068, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 029, Runtime 13.810133, Loss 0.548266, forward nfe 8364, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 030, Runtime 14.215639, Loss 0.462489, forward nfe 8660, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 031, Runtime 13.976666, Loss 0.561394, forward nfe 8956, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 032, Runtime 14.168846, Loss 0.515068, forward nfe 9252, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 033, Runtime 14.580895, Loss 0.482286, forward nfe 9548, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 034, Runtime 14.554272, Loss 0.400155, forward nfe 9844, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 035, Runtime 14.767237, Loss 0.394873, forward nfe 10140, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 036, Runtime 15.006221, Loss 0.355485, forward nfe 10436, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 037, Runtime 14.937098, Loss 0.364204, forward nfe 10732, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 038, Runtime 15.013896, Loss 0.371946, forward nfe 11028, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 039, Runtime 15.400599, Loss 0.393554, forward nfe 11324, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 040, Runtime 15.439808, Loss 0.294782, forward nfe 11620, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 041, Runtime 15.383976, Loss 0.331401, forward nfe 11916, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 042, Runtime 15.732165, Loss 0.392475, forward nfe 12212, backward nfe 0, Train: 0.9357, Val: 0.8191, Test: 0.8386, Best time: 18.2948
Epoch: 043, Runtime 15.717537, Loss 0.383047, forward nfe 12508, backward nfe 0, Train: 0.9786, Val: 0.8257, Test: 0.8437, Best time: 54.0000
Epoch: 044, Runtime 12.952633, Loss 0.324064, forward nfe 12804, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 54.0000
Epoch: 045, Runtime 12.776109, Loss 0.363142, forward nfe 13100, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 046, Runtime 13.192472, Loss 0.308751, forward nfe 13396, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 047, Runtime 13.164172, Loss 0.304968, forward nfe 13692, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 048, Runtime 13.138172, Loss 0.386439, forward nfe 13988, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 049, Runtime 13.740483, Loss 0.289146, forward nfe 14284, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 050, Runtime 13.491690, Loss 0.288511, forward nfe 14580, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 051, Runtime 13.643491, Loss 0.342697, forward nfe 14876, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 052, Runtime 13.952588, Loss 0.285657, forward nfe 15172, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 053, Runtime 13.904510, Loss 0.257254, forward nfe 15468, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 054, Runtime 13.886118, Loss 0.213885, forward nfe 15764, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 055, Runtime 14.465071, Loss 0.340175, forward nfe 16060, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 056, Runtime 14.272634, Loss 0.275918, forward nfe 16356, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 057, Runtime 14.224319, Loss 0.360447, forward nfe 16652, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 058, Runtime 14.801026, Loss 0.337610, forward nfe 16948, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 059, Runtime 14.871703, Loss 0.306056, forward nfe 17244, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 060, Runtime 14.842131, Loss 0.260208, forward nfe 17540, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 061, Runtime 15.119614, Loss 0.281373, forward nfe 17836, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 062, Runtime 15.066994, Loss 0.354348, forward nfe 18132, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 063, Runtime 15.088630, Loss 0.226007, forward nfe 18428, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 064, Runtime 15.313605, Loss 0.250052, forward nfe 18724, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 065, Runtime 15.396317, Loss 0.296966, forward nfe 19020, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 066, Runtime 15.316548, Loss 0.234412, forward nfe 19316, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 067, Runtime 15.604731, Loss 0.348710, forward nfe 19612, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 068, Runtime 15.544773, Loss 0.256489, forward nfe 19908, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 069, Runtime 15.563920, Loss 0.208732, forward nfe 20204, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 070, Runtime 15.786918, Loss 0.215831, forward nfe 20500, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 071, Runtime 15.714948, Loss 0.314403, forward nfe 20796, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 072, Runtime 15.620765, Loss 0.378922, forward nfe 21092, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 073, Runtime 15.893140, Loss 0.246776, forward nfe 21388, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 074, Runtime 15.644459, Loss 0.177716, forward nfe 21684, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 075, Runtime 15.697253, Loss 0.251270, forward nfe 21980, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 076, Runtime 15.417955, Loss 0.273278, forward nfe 22276, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 077, Runtime 15.286592, Loss 0.296774, forward nfe 22572, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 078, Runtime 15.329333, Loss 0.279549, forward nfe 22868, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 079, Runtime 15.343121, Loss 0.335921, forward nfe 23164, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 080, Runtime 15.739313, Loss 0.287920, forward nfe 23460, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 081, Runtime 15.921571, Loss 0.215413, forward nfe 23756, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 082, Runtime 16.022617, Loss 0.360316, forward nfe 24052, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 083, Runtime 16.006728, Loss 0.215198, forward nfe 24348, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 084, Runtime 15.965035, Loss 0.272766, forward nfe 24644, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 085, Runtime 16.046443, Loss 0.181111, forward nfe 24940, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 086, Runtime 15.622002, Loss 0.279931, forward nfe 25236, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 087, Runtime 15.955485, Loss 0.174207, forward nfe 25532, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 088, Runtime 16.034649, Loss 0.216068, forward nfe 25828, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 089, Runtime 16.026222, Loss 0.204740, forward nfe 26124, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 090, Runtime 15.646357, Loss 0.196633, forward nfe 26420, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 091, Runtime 15.637380, Loss 0.260270, forward nfe 26716, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 092, Runtime 15.710974, Loss 0.214634, forward nfe 27012, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 093, Runtime 15.559657, Loss 0.190423, forward nfe 27308, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 094, Runtime 15.677403, Loss 0.205414, forward nfe 27604, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 095, Runtime 15.594204, Loss 0.269957, forward nfe 27900, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 096, Runtime 15.094584, Loss 0.291827, forward nfe 28196, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 097, Runtime 15.207816, Loss 0.207067, forward nfe 28492, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 098, Runtime 15.122293, Loss 0.247280, forward nfe 28788, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
Epoch: 099, Runtime 15.324649, Loss 0.187038, forward nfe 29084, backward nfe 0, Train: 0.9714, Val: 0.8382, Test: 0.8477, Best time: 18.2948
best val accuracy 0.838235 with test accuracy 0.847716 at epoch 44 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8467005076142132
Entropy Threshold: 2 Test accuracy: 0.8548223350253807
Entropy Threshold: 1.6 Test accuracy: 0.8526970954356846
Entropy Threshold: 1.5 Test accuracy: 0.8641188959660298
Entropy Threshold: 1.4 Test accuracy: 0.8758099352051836
Entropy Threshold: 1.3 Test accuracy: 0.8792912513842747
Entropy Threshold: 1.2 Test accuracy: 0.8867276887871853
Entropy Threshold: 1.1 Test accuracy: 0.9
Entropy Threshold: 0.9 Test accuracy: 0.9157088122605364
Entropy Threshold: 0.8 Test accuracy: 0.9232839838492598
Entropy Threshold: 0.7 Test accuracy: 0.9373219373219374
Entropy Threshold: 0.6 Test accuracy: 0.9443609022556391
Entropy Threshold: 0.5 Test accuracy: 0.9496753246753247
Entropy Threshold: 0.4 Test accuracy: 0.9571917808219178
Entropy Threshold: 0.3 Test accuracy: 0.9589552238805971
Entropy Threshold: 0.2 Test accuracy: 0.9567901234567902
Entropy Threshold: 0.1 Test accuracy: 0.9592875318066157
