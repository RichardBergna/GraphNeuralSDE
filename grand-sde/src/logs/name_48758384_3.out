[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 9.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.293021, Loss 6.539614, forward nfe 76, backward nfe 0, Train: 0.2571, Val: 0.1588, Test: 0.1868, Best time: 1.0000
Epoch: 002, Runtime 10.945216, Loss 7.920211, forward nfe 372, backward nfe 0, Train: 0.5286, Val: 0.3743, Test: 0.4162, Best time: 1.0000
Epoch: 003, Runtime 10.828552, Loss 6.264381, forward nfe 668, backward nfe 0, Train: 0.5286, Val: 0.3743, Test: 0.4162, Best time: 18.2948
Epoch: 004, Runtime 11.085735, Loss 5.762053, forward nfe 964, backward nfe 0, Train: 0.6071, Val: 0.3853, Test: 0.4081, Best time: 1.0000
Epoch: 005, Runtime 11.124165, Loss 5.120941, forward nfe 1260, backward nfe 0, Train: 0.5786, Val: 0.3890, Test: 0.4112, Best time: 1.0000
Epoch: 006, Runtime 11.537726, Loss 4.293970, forward nfe 1556, backward nfe 0, Train: 0.5786, Val: 0.3890, Test: 0.4112, Best time: 18.2948
Epoch: 007, Runtime 12.690969, Loss 3.765260, forward nfe 1852, backward nfe 0, Train: 0.5786, Val: 0.3890, Test: 0.4112, Best time: 18.2948
Epoch: 008, Runtime 12.596244, Loss 3.901230, forward nfe 2148, backward nfe 0, Train: 0.5500, Val: 0.3993, Test: 0.4173, Best time: 1.0000
Epoch: 009, Runtime 12.377511, Loss 3.584733, forward nfe 2444, backward nfe 0, Train: 0.6000, Val: 0.4713, Test: 0.4843, Best time: 1.0000
Epoch: 010, Runtime 12.457908, Loss 3.250386, forward nfe 2740, backward nfe 0, Train: 0.6643, Val: 0.5353, Test: 0.5492, Best time: 1.0000
Epoch: 011, Runtime 12.402871, Loss 3.250260, forward nfe 3036, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 6.0000
Epoch: 012, Runtime 12.101333, Loss 2.762578, forward nfe 3332, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 013, Runtime 12.340131, Loss 2.758373, forward nfe 3628, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 014, Runtime 12.647134, Loss 2.590303, forward nfe 3924, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 015, Runtime 12.828693, Loss 2.464165, forward nfe 4220, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 016, Runtime 13.212753, Loss 2.372360, forward nfe 4516, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 017, Runtime 13.494672, Loss 2.342836, forward nfe 4812, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 018, Runtime 13.595359, Loss 2.526248, forward nfe 5108, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 019, Runtime 14.352121, Loss 2.428585, forward nfe 5404, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 020, Runtime 14.474980, Loss 2.293854, forward nfe 5700, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 021, Runtime 14.899269, Loss 2.281152, forward nfe 5996, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 022, Runtime 14.815411, Loss 2.189273, forward nfe 6292, backward nfe 0, Train: 0.7929, Val: 0.5493, Test: 0.5543, Best time: 18.2948
Epoch: 023, Runtime 14.883896, Loss 2.073512, forward nfe 6588, backward nfe 0, Train: 0.6571, Val: 0.5706, Test: 0.5797, Best time: 53.0000
Epoch: 024, Runtime 12.338630, Loss 2.098522, forward nfe 6884, backward nfe 0, Train: 0.7000, Val: 0.5779, Test: 0.5777, Best time: 34.0000
Epoch: 025, Runtime 12.445283, Loss 1.974272, forward nfe 7180, backward nfe 0, Train: 0.7214, Val: 0.5816, Test: 0.5827, Best time: 41.0000
Epoch: 026, Runtime 12.484600, Loss 2.216321, forward nfe 7476, backward nfe 0, Train: 0.7286, Val: 0.5860, Test: 0.5787, Best time: 31.0000
Epoch: 027, Runtime 12.224406, Loss 2.005422, forward nfe 7772, backward nfe 0, Train: 0.7357, Val: 0.5963, Test: 0.5797, Best time: 38.0000
Epoch: 028, Runtime 12.355586, Loss 2.234409, forward nfe 8068, backward nfe 0, Train: 0.7643, Val: 0.5978, Test: 0.5838, Best time: 50.0000
Epoch: 029, Runtime 12.506710, Loss 1.961067, forward nfe 8364, backward nfe 0, Train: 0.7643, Val: 0.5978, Test: 0.5838, Best time: 18.2948
Epoch: 030, Runtime 12.594123, Loss 2.097057, forward nfe 8660, backward nfe 0, Train: 0.7643, Val: 0.5978, Test: 0.5838, Best time: 18.2948
Epoch: 031, Runtime 12.849850, Loss 2.010692, forward nfe 8956, backward nfe 0, Train: 0.7643, Val: 0.5978, Test: 0.5838, Best time: 18.2948
Epoch: 032, Runtime 13.240502, Loss 2.060632, forward nfe 9252, backward nfe 0, Train: 0.7643, Val: 0.5978, Test: 0.5838, Best time: 18.2948
Epoch: 033, Runtime 13.357403, Loss 1.953519, forward nfe 9548, backward nfe 0, Train: 0.6786, Val: 0.6074, Test: 0.6162, Best time: 2.0000
Epoch: 034, Runtime 12.472289, Loss 1.866426, forward nfe 9844, backward nfe 0, Train: 0.7143, Val: 0.6265, Test: 0.6477, Best time: 3.0000
Epoch: 035, Runtime 12.531342, Loss 1.986901, forward nfe 10140, backward nfe 0, Train: 0.7571, Val: 0.6544, Test: 0.6660, Best time: 3.0000
Epoch: 036, Runtime 12.765537, Loss 1.850363, forward nfe 10436, backward nfe 0, Train: 0.8000, Val: 0.6691, Test: 0.6954, Best time: 4.0000
Epoch: 037, Runtime 12.611756, Loss 1.847308, forward nfe 10732, backward nfe 0, Train: 0.8000, Val: 0.6691, Test: 0.6954, Best time: 18.2948
Epoch: 038, Runtime 13.041244, Loss 1.824610, forward nfe 11028, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 3.0000
Epoch: 039, Runtime 12.441959, Loss 1.857540, forward nfe 11324, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 040, Runtime 12.863358, Loss 1.855219, forward nfe 11620, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 041, Runtime 13.003905, Loss 1.709383, forward nfe 11916, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 042, Runtime 13.486285, Loss 1.812079, forward nfe 12212, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 043, Runtime 13.549986, Loss 1.764772, forward nfe 12508, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 044, Runtime 14.085217, Loss 1.704755, forward nfe 12804, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 045, Runtime 14.187879, Loss 1.641115, forward nfe 13100, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 046, Runtime 14.521276, Loss 1.534311, forward nfe 13396, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 047, Runtime 14.610250, Loss 1.514647, forward nfe 13692, backward nfe 0, Train: 0.7714, Val: 0.6721, Test: 0.6893, Best time: 18.2948
Epoch: 048, Runtime 14.973920, Loss 1.676588, forward nfe 13988, backward nfe 0, Train: 0.7429, Val: 0.6779, Test: 0.6873, Best time: 3.0000
Epoch: 049, Runtime 12.857141, Loss 1.694977, forward nfe 14284, backward nfe 0, Train: 0.7429, Val: 0.6779, Test: 0.6873, Best time: 18.2948
Epoch: 050, Runtime 13.144391, Loss 1.696648, forward nfe 14580, backward nfe 0, Train: 0.7643, Val: 0.6919, Test: 0.6964, Best time: 4.0000
Epoch: 051, Runtime 12.769585, Loss 1.546375, forward nfe 14876, backward nfe 0, Train: 0.7643, Val: 0.6919, Test: 0.6964, Best time: 18.2948
Epoch: 052, Runtime 12.938127, Loss 1.557105, forward nfe 15172, backward nfe 0, Train: 0.7643, Val: 0.6919, Test: 0.6964, Best time: 18.2948
Epoch: 053, Runtime 13.472866, Loss 1.605881, forward nfe 15468, backward nfe 0, Train: 0.7643, Val: 0.6919, Test: 0.6964, Best time: 18.2948
Epoch: 054, Runtime 13.522853, Loss 1.532873, forward nfe 15764, backward nfe 0, Train: 0.7643, Val: 0.6919, Test: 0.6964, Best time: 18.2948
Epoch: 055, Runtime 14.129092, Loss 1.505207, forward nfe 16060, backward nfe 0, Train: 0.7643, Val: 0.6919, Test: 0.6964, Best time: 18.2948
Epoch: 056, Runtime 14.357914, Loss 1.542415, forward nfe 16356, backward nfe 0, Train: 0.7857, Val: 0.7066, Test: 0.7127, Best time: 6.0000
Epoch: 057, Runtime 12.531739, Loss 1.482239, forward nfe 16652, backward nfe 0, Train: 0.8000, Val: 0.7154, Test: 0.7066, Best time: 5.0000
Epoch: 058, Runtime 12.049354, Loss 1.414552, forward nfe 16948, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 5.0000
Epoch: 059, Runtime 11.817622, Loss 1.772244, forward nfe 17244, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 060, Runtime 11.803597, Loss 1.284007, forward nfe 17540, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 061, Runtime 12.301095, Loss 1.521050, forward nfe 17836, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 062, Runtime 12.633401, Loss 1.361979, forward nfe 18132, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 063, Runtime 12.961370, Loss 1.272661, forward nfe 18428, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 064, Runtime 13.197521, Loss 1.310968, forward nfe 18724, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 065, Runtime 13.670180, Loss 1.350556, forward nfe 19020, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 066, Runtime 13.423258, Loss 1.394749, forward nfe 19316, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 067, Runtime 14.037505, Loss 1.528741, forward nfe 19612, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 068, Runtime 14.064103, Loss 1.371798, forward nfe 19908, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 069, Runtime 14.402691, Loss 1.348761, forward nfe 20204, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 070, Runtime 15.099180, Loss 1.465850, forward nfe 20500, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 071, Runtime 14.755750, Loss 1.344478, forward nfe 20796, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 072, Runtime 15.284185, Loss 1.296267, forward nfe 21092, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 073, Runtime 15.052576, Loss 1.360829, forward nfe 21388, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 074, Runtime 15.398604, Loss 1.306318, forward nfe 21684, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 075, Runtime 15.562063, Loss 1.353890, forward nfe 21980, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 076, Runtime 15.484262, Loss 1.362956, forward nfe 22276, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 077, Runtime 15.984348, Loss 1.348280, forward nfe 22572, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 078, Runtime 16.152238, Loss 1.347863, forward nfe 22868, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 079, Runtime 16.178235, Loss 1.294115, forward nfe 23164, backward nfe 0, Train: 0.8143, Val: 0.7162, Test: 0.7076, Best time: 18.2948
Epoch: 080, Runtime 17.038835, Loss 1.160099, forward nfe 23460, backward nfe 0, Train: 0.7929, Val: 0.7191, Test: 0.7137, Best time: 8.0000
Epoch: 081, Runtime 13.960055, Loss 1.305031, forward nfe 23756, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 8.0000
Epoch: 082, Runtime 13.185226, Loss 1.345156, forward nfe 24052, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 083, Runtime 13.305697, Loss 1.385837, forward nfe 24348, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 084, Runtime 13.160024, Loss 0.989000, forward nfe 24644, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 085, Runtime 13.269130, Loss 1.218179, forward nfe 24940, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 086, Runtime 13.329309, Loss 1.269208, forward nfe 25236, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 087, Runtime 13.930553, Loss 1.153217, forward nfe 25532, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 088, Runtime 13.906401, Loss 1.041815, forward nfe 25828, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 089, Runtime 14.622370, Loss 1.183562, forward nfe 26124, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 090, Runtime 14.384545, Loss 1.157676, forward nfe 26420, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 091, Runtime 14.911780, Loss 1.141493, forward nfe 26716, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 092, Runtime 15.010161, Loss 1.231333, forward nfe 27012, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 093, Runtime 15.157857, Loss 1.187624, forward nfe 27308, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 094, Runtime 15.736054, Loss 1.054531, forward nfe 27604, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 095, Runtime 15.305287, Loss 1.099767, forward nfe 27900, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 096, Runtime 15.605487, Loss 1.068953, forward nfe 28196, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 097, Runtime 16.103647, Loss 1.172732, forward nfe 28492, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 098, Runtime 16.409968, Loss 1.228918, forward nfe 28788, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
Epoch: 099, Runtime 16.354780, Loss 1.218278, forward nfe 29084, backward nfe 0, Train: 0.8000, Val: 0.7228, Test: 0.7188, Best time: 18.2948
best val accuracy 0.722794 with test accuracy 0.718782 at epoch 81 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.6710659898477157
Entropy Threshold: 2 Test accuracy: 0.6680203045685279
Entropy Threshold: 1.6 Test accuracy: 0.6951631046119235
Entropy Threshold: 1.5 Test accuracy: 0.7085308056872038
Entropy Threshold: 1.4 Test accuracy: 0.7278645833333334
Entropy Threshold: 1.3 Test accuracy: 0.7388888888888889
Entropy Threshold: 1.2 Test accuracy: 0.7635239567233385
Entropy Threshold: 1.1 Test accuracy: 0.7865748709122203
Entropy Threshold: 0.9 Test accuracy: 0.8092105263157895
Entropy Threshold: 0.8 Test accuracy: 0.8285714285714286
Entropy Threshold: 0.7 Test accuracy: 0.84
Entropy Threshold: 0.6 Test accuracy: 0.8509316770186336
Entropy Threshold: 0.5 Test accuracy: 0.8657718120805369
Entropy Threshold: 0.4 Test accuracy: 0.8735177865612648
Entropy Threshold: 0.3 Test accuracy: 0.8805309734513275
Entropy Threshold: 0.2 Test accuracy: 0.9065934065934066
Entropy Threshold: 0.1 Test accuracy: 0.9117647058823529
