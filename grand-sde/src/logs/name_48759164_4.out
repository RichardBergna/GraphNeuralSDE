[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.3
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 10.635119, Loss 2.140757, forward nfe 76, backward nfe 0, Train: 0.2571, Val: 0.1029, Test: 0.1178, Best time: 1.0000
Epoch: 002, Runtime 9.695242, Loss 2.441806, forward nfe 372, backward nfe 0, Train: 0.4786, Val: 0.3029, Test: 0.2954, Best time: 3.0000
Epoch: 003, Runtime 9.530212, Loss 2.206512, forward nfe 668, backward nfe 0, Train: 0.5143, Val: 0.3199, Test: 0.3239, Best time: 1.0000
Epoch: 004, Runtime 9.536041, Loss 2.134399, forward nfe 964, backward nfe 0, Train: 0.5214, Val: 0.3213, Test: 0.3289, Best time: 1.0000
Epoch: 005, Runtime 9.550131, Loss 2.067049, forward nfe 1260, backward nfe 0, Train: 0.6000, Val: 0.3809, Test: 0.3909, Best time: 1.0000
Epoch: 006, Runtime 9.583323, Loss 2.012498, forward nfe 1556, backward nfe 0, Train: 0.7429, Val: 0.5059, Test: 0.5168, Best time: 2.0000
Epoch: 007, Runtime 9.536231, Loss 1.892220, forward nfe 1852, backward nfe 0, Train: 0.8357, Val: 0.5941, Test: 0.6010, Best time: 5.0000
Epoch: 008, Runtime 9.556330, Loss 1.651863, forward nfe 2148, backward nfe 0, Train: 0.7714, Val: 0.6419, Test: 0.6467, Best time: 18.0000
Epoch: 009, Runtime 9.568144, Loss 1.564884, forward nfe 2444, backward nfe 0, Train: 0.7714, Val: 0.6750, Test: 0.6741, Best time: 27.0000
Epoch: 010, Runtime 9.552635, Loss 1.502891, forward nfe 2740, backward nfe 0, Train: 0.8286, Val: 0.6985, Test: 0.6985, Best time: 15.0000
Epoch: 011, Runtime 9.532139, Loss 1.350877, forward nfe 3036, backward nfe 0, Train: 0.8357, Val: 0.7081, Test: 0.7107, Best time: 28.0000
Epoch: 012, Runtime 9.443659, Loss 1.246845, forward nfe 3332, backward nfe 0, Train: 0.8357, Val: 0.7081, Test: 0.7107, Best time: 18.2948
Epoch: 013, Runtime 9.781096, Loss 1.103167, forward nfe 3628, backward nfe 0, Train: 0.8357, Val: 0.7081, Test: 0.7107, Best time: 18.2948
Epoch: 014, Runtime 9.767852, Loss 1.010192, forward nfe 3924, backward nfe 0, Train: 0.8357, Val: 0.7081, Test: 0.7107, Best time: 18.2948
Epoch: 015, Runtime 9.906749, Loss 0.947464, forward nfe 4220, backward nfe 0, Train: 0.8500, Val: 0.7265, Test: 0.7259, Best time: 19.0000
Epoch: 016, Runtime 9.581893, Loss 0.922145, forward nfe 4516, backward nfe 0, Train: 0.8643, Val: 0.7485, Test: 0.7574, Best time: 16.0000
Epoch: 017, Runtime 9.483145, Loss 0.755675, forward nfe 4812, backward nfe 0, Train: 0.8500, Val: 0.7706, Test: 0.7746, Best time: 32.0000
Epoch: 018, Runtime 9.510186, Loss 0.755592, forward nfe 5108, backward nfe 0, Train: 0.8714, Val: 0.7809, Test: 0.7787, Best time: 35.0000
Epoch: 019, Runtime 9.408733, Loss 0.688849, forward nfe 5404, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.7939, Best time: 34.0000
Epoch: 020, Runtime 9.240070, Loss 0.705416, forward nfe 5700, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.7939, Best time: 18.2948
Epoch: 021, Runtime 9.338750, Loss 0.621990, forward nfe 5996, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.7939, Best time: 18.2948
Epoch: 022, Runtime 9.082032, Loss 0.552278, forward nfe 6292, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.7939, Best time: 18.2948
Epoch: 023, Runtime 9.537919, Loss 0.565040, forward nfe 6588, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.7939, Best time: 18.2948
Epoch: 024, Runtime 9.920238, Loss 0.596603, forward nfe 6884, backward nfe 0, Train: 0.8857, Val: 0.7875, Test: 0.7939, Best time: 18.2948
Epoch: 025, Runtime 9.683578, Loss 0.484929, forward nfe 7180, backward nfe 0, Train: 0.9286, Val: 0.7912, Test: 0.8152, Best time: 33.0000
Epoch: 026, Runtime 9.486149, Loss 0.527028, forward nfe 7476, backward nfe 0, Train: 0.9071, Val: 0.8081, Test: 0.8183, Best time: 49.0000
Epoch: 027, Runtime 9.256365, Loss 0.460169, forward nfe 7772, backward nfe 0, Train: 0.9357, Val: 0.8154, Test: 0.8213, Best time: 50.0000
Epoch: 028, Runtime 9.076582, Loss 0.444642, forward nfe 8068, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 54.8843
Epoch: 029, Runtime 9.362123, Loss 0.480066, forward nfe 8364, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 030, Runtime 9.682718, Loss 0.483620, forward nfe 8660, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 031, Runtime 9.666926, Loss 0.446471, forward nfe 8956, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 032, Runtime 9.567246, Loss 0.484961, forward nfe 9252, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 033, Runtime 9.864692, Loss 0.422147, forward nfe 9548, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 034, Runtime 9.826379, Loss 0.410536, forward nfe 9844, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 035, Runtime 9.806709, Loss 0.516129, forward nfe 10140, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 036, Runtime 10.105829, Loss 0.347888, forward nfe 10436, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 037, Runtime 9.693072, Loss 0.415775, forward nfe 10732, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 038, Runtime 9.666195, Loss 0.405696, forward nfe 11028, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 039, Runtime 10.210935, Loss 0.360200, forward nfe 11324, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 040, Runtime 10.105766, Loss 0.374184, forward nfe 11620, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 041, Runtime 10.006371, Loss 0.425355, forward nfe 11916, backward nfe 0, Train: 0.9429, Val: 0.8191, Test: 0.8223, Best time: 18.2948
Epoch: 042, Runtime 10.476852, Loss 0.346939, forward nfe 12212, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 54.8843
Epoch: 043, Runtime 8.942938, Loss 0.311394, forward nfe 12508, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 044, Runtime 8.980923, Loss 0.372822, forward nfe 12804, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 045, Runtime 9.031993, Loss 0.281589, forward nfe 13100, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 046, Runtime 9.130712, Loss 0.298149, forward nfe 13396, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 047, Runtime 9.421780, Loss 0.355513, forward nfe 13692, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 048, Runtime 9.287417, Loss 0.313188, forward nfe 13988, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 049, Runtime 9.190413, Loss 0.337065, forward nfe 14284, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 050, Runtime 9.306020, Loss 0.302302, forward nfe 14580, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 051, Runtime 9.224701, Loss 0.297690, forward nfe 14876, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 052, Runtime 9.448018, Loss 0.288798, forward nfe 15172, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 053, Runtime 9.616192, Loss 0.247351, forward nfe 15468, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 054, Runtime 9.620475, Loss 0.382340, forward nfe 15764, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 055, Runtime 9.760351, Loss 0.389578, forward nfe 16060, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 056, Runtime 9.992591, Loss 0.219090, forward nfe 16356, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 057, Runtime 9.909792, Loss 0.379585, forward nfe 16652, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 058, Runtime 9.877835, Loss 0.244457, forward nfe 16948, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 059, Runtime 10.073836, Loss 0.278193, forward nfe 17244, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 060, Runtime 10.048270, Loss 0.268899, forward nfe 17540, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 061, Runtime 10.338756, Loss 0.268047, forward nfe 17836, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 062, Runtime 11.257172, Loss 0.296577, forward nfe 18132, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 063, Runtime 11.083729, Loss 0.380690, forward nfe 18428, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 064, Runtime 11.249307, Loss 0.240034, forward nfe 18724, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 065, Runtime 11.321170, Loss 0.261814, forward nfe 19020, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 066, Runtime 11.292829, Loss 0.184866, forward nfe 19316, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 067, Runtime 11.232769, Loss 0.221302, forward nfe 19612, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 068, Runtime 11.368130, Loss 0.297055, forward nfe 19908, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 069, Runtime 11.429479, Loss 0.221597, forward nfe 20204, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 070, Runtime 11.318908, Loss 0.301745, forward nfe 20500, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 071, Runtime 11.520378, Loss 0.212862, forward nfe 20796, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 072, Runtime 11.516111, Loss 0.279524, forward nfe 21092, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 073, Runtime 11.412812, Loss 0.235866, forward nfe 21388, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 074, Runtime 11.578074, Loss 0.309699, forward nfe 21684, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 075, Runtime 11.550708, Loss 0.311722, forward nfe 21980, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 076, Runtime 11.619204, Loss 0.277358, forward nfe 22276, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 077, Runtime 11.733916, Loss 0.184872, forward nfe 22572, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 078, Runtime 11.564415, Loss 0.211793, forward nfe 22868, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 079, Runtime 11.524171, Loss 0.318579, forward nfe 23164, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 080, Runtime 11.360974, Loss 0.248125, forward nfe 23460, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 081, Runtime 11.041755, Loss 0.215260, forward nfe 23756, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 082, Runtime 10.709740, Loss 0.215072, forward nfe 24052, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 083, Runtime 11.503904, Loss 0.273264, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 084, Runtime 12.723145, Loss 0.327123, forward nfe 24644, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 085, Runtime 12.476811, Loss 0.167728, forward nfe 24940, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 086, Runtime 13.974523, Loss 0.156341, forward nfe 25236, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 087, Runtime 14.812006, Loss 0.207344, forward nfe 25532, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 088, Runtime 14.748765, Loss 0.224391, forward nfe 25828, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 089, Runtime 14.735752, Loss 0.213346, forward nfe 26124, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 090, Runtime 13.569829, Loss 0.178697, forward nfe 26420, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 091, Runtime 11.840717, Loss 0.248594, forward nfe 26716, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 092, Runtime 11.868202, Loss 0.257733, forward nfe 27012, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 093, Runtime 11.973132, Loss 0.256164, forward nfe 27308, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 094, Runtime 11.871779, Loss 0.261908, forward nfe 27604, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 095, Runtime 11.990699, Loss 0.124570, forward nfe 27900, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 096, Runtime 11.864691, Loss 0.237135, forward nfe 28196, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 097, Runtime 11.890284, Loss 0.181029, forward nfe 28492, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 098, Runtime 12.189316, Loss 0.170297, forward nfe 28788, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
Epoch: 099, Runtime 11.757540, Loss 0.236054, forward nfe 29084, backward nfe 0, Train: 0.9429, Val: 0.8243, Test: 0.8284, Best time: 18.2948
best val accuracy 0.824265 with test accuracy 0.828426 at epoch 42 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8263959390862944
Entropy Threshold: 2 Test accuracy: 0.8243654822335026
Entropy Threshold: 1.6 Test accuracy: 0.8317948717948718
Entropy Threshold: 1.5 Test accuracy: 0.8326446280991735
Entropy Threshold: 1.4 Test accuracy: 0.8505263157894737
Entropy Threshold: 1.3 Test accuracy: 0.8489751887810141
Entropy Threshold: 1.2 Test accuracy: 0.8549280177187154
Entropy Threshold: 1.1 Test accuracy: 0.8695163104611924
Entropy Threshold: 0.9 Test accuracy: 0.8827160493827161
Entropy Threshold: 0.8 Test accuracy: 0.8932655654383735
Entropy Threshold: 0.7 Test accuracy: 0.9059139784946236
Entropy Threshold: 0.6 Test accuracy: 0.9154929577464789
Entropy Threshold: 0.5 Test accuracy: 0.9271916790490342
Entropy Threshold: 0.4 Test accuracy: 0.93125
Entropy Threshold: 0.3 Test accuracy: 0.9452054794520548
Entropy Threshold: 0.2 Test accuracy: 0.9572490706319703
Entropy Threshold: 0.1 Test accuracy: 0.9699769053117783
