[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.5
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 18.928150, Loss 2.048169, forward nfe 76, backward nfe 0, Train: 0.3143, Val: 0.1971, Test: 0.2345, Best time: 1.0000
Epoch: 002, Runtime 19.526451, Loss 2.067604, forward nfe 372, backward nfe 0, Train: 0.3143, Val: 0.1971, Test: 0.2345, Best time: 18.2948
Epoch: 003, Runtime 19.618937, Loss 1.878128, forward nfe 668, backward nfe 0, Train: 0.6143, Val: 0.4132, Test: 0.4294, Best time: 1.0000
Epoch: 004, Runtime 18.104629, Loss 1.768539, forward nfe 964, backward nfe 0, Train: 0.8000, Val: 0.6015, Test: 0.6386, Best time: 2.0000
Epoch: 005, Runtime 18.245428, Loss 1.658077, forward nfe 1260, backward nfe 0, Train: 0.8714, Val: 0.6669, Test: 0.7015, Best time: 10.0000
Epoch: 006, Runtime 18.087564, Loss 1.501458, forward nfe 1556, backward nfe 0, Train: 0.9000, Val: 0.6956, Test: 0.7188, Best time: 9.0000
Epoch: 007, Runtime 18.227195, Loss 1.214865, forward nfe 1852, backward nfe 0, Train: 0.9071, Val: 0.7338, Test: 0.7584, Best time: 11.0000
Epoch: 008, Runtime 17.856093, Loss 1.011179, forward nfe 2148, backward nfe 0, Train: 0.9143, Val: 0.7676, Test: 0.7970, Best time: 8.0000
Epoch: 009, Runtime 18.433474, Loss 0.810810, forward nfe 2444, backward nfe 0, Train: 0.9143, Val: 0.7956, Test: 0.8091, Best time: 27.0000
Epoch: 010, Runtime 18.086976, Loss 0.747488, forward nfe 2740, backward nfe 0, Train: 0.9214, Val: 0.8066, Test: 0.8193, Best time: 24.0000
Epoch: 011, Runtime 18.005949, Loss 0.630575, forward nfe 3036, backward nfe 0, Train: 0.9429, Val: 0.8147, Test: 0.8254, Best time: 8.0000
Epoch: 012, Runtime 17.948164, Loss 0.497368, forward nfe 3332, backward nfe 0, Train: 0.9429, Val: 0.8147, Test: 0.8254, Best time: 18.2948
Epoch: 013, Runtime 18.733031, Loss 0.466941, forward nfe 3628, backward nfe 0, Train: 0.9357, Val: 0.8206, Test: 0.8355, Best time: 19.0000
Epoch: 014, Runtime 18.863109, Loss 0.421142, forward nfe 3924, backward nfe 0, Train: 0.9357, Val: 0.8250, Test: 0.8447, Best time: 25.0000
Epoch: 015, Runtime 18.824080, Loss 0.404490, forward nfe 4220, backward nfe 0, Train: 0.9429, Val: 0.8294, Test: 0.8477, Best time: 21.0000
Epoch: 016, Runtime 18.677628, Loss 0.350950, forward nfe 4516, backward nfe 0, Train: 0.9286, Val: 0.8338, Test: 0.8437, Best time: 52.0000
Epoch: 017, Runtime 18.424942, Loss 0.314874, forward nfe 4812, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 52.0000
Epoch: 018, Runtime 18.127725, Loss 0.360450, forward nfe 5108, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 019, Runtime 18.140539, Loss 0.337953, forward nfe 5404, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 020, Runtime 18.179708, Loss 0.292734, forward nfe 5700, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 021, Runtime 18.068305, Loss 0.308606, forward nfe 5996, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 022, Runtime 18.924915, Loss 0.331034, forward nfe 6292, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 023, Runtime 19.064586, Loss 0.288529, forward nfe 6588, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 024, Runtime 19.259762, Loss 0.385467, forward nfe 6884, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 025, Runtime 19.789703, Loss 0.370469, forward nfe 7180, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 026, Runtime 19.534434, Loss 0.303603, forward nfe 7476, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 027, Runtime 19.670903, Loss 0.300059, forward nfe 7772, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 028, Runtime 20.210925, Loss 0.286459, forward nfe 8068, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 029, Runtime 19.995440, Loss 0.253495, forward nfe 8364, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 030, Runtime 19.781307, Loss 0.348978, forward nfe 8660, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 031, Runtime 20.568248, Loss 0.313945, forward nfe 8956, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 032, Runtime 20.766655, Loss 0.268400, forward nfe 9252, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 033, Runtime 20.409702, Loss 0.262060, forward nfe 9548, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 034, Runtime 20.984285, Loss 0.278323, forward nfe 9844, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 035, Runtime 21.136718, Loss 0.267846, forward nfe 10140, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 036, Runtime 21.059993, Loss 0.284354, forward nfe 10436, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 037, Runtime 21.308357, Loss 0.270805, forward nfe 10732, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 038, Runtime 21.221684, Loss 0.226740, forward nfe 11028, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 039, Runtime 21.251734, Loss 0.359128, forward nfe 11324, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 040, Runtime 21.811663, Loss 0.244437, forward nfe 11620, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 041, Runtime 21.848285, Loss 0.236762, forward nfe 11916, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 042, Runtime 21.800739, Loss 0.260055, forward nfe 12212, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 043, Runtime 22.070452, Loss 0.246962, forward nfe 12508, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 044, Runtime 21.966557, Loss 0.220085, forward nfe 12804, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 045, Runtime 21.993865, Loss 0.207546, forward nfe 13100, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 046, Runtime 22.206130, Loss 0.275055, forward nfe 13396, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 047, Runtime 22.259931, Loss 0.199632, forward nfe 13692, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 048, Runtime 22.164129, Loss 0.251975, forward nfe 13988, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 049, Runtime 21.916558, Loss 0.239761, forward nfe 14284, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 050, Runtime 22.415973, Loss 0.247371, forward nfe 14580, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 051, Runtime 22.017670, Loss 0.217065, forward nfe 14876, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 052, Runtime 21.899930, Loss 0.220852, forward nfe 15172, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 053, Runtime 22.158462, Loss 0.249392, forward nfe 15468, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 054, Runtime 22.132852, Loss 0.242702, forward nfe 15764, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 055, Runtime 22.222169, Loss 0.355733, forward nfe 16060, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 056, Runtime 22.307443, Loss 0.243844, forward nfe 16356, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 057, Runtime 22.292137, Loss 0.171840, forward nfe 16652, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 058, Runtime 22.624365, Loss 0.193746, forward nfe 16948, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 059, Runtime 22.755655, Loss 0.183627, forward nfe 17244, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 060, Runtime 22.637591, Loss 0.202758, forward nfe 17540, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 061, Runtime 22.530101, Loss 0.167982, forward nfe 17836, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 062, Runtime 22.944983, Loss 0.248859, forward nfe 18132, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 063, Runtime 21.940499, Loss 0.203526, forward nfe 18428, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 064, Runtime 20.490391, Loss 0.218189, forward nfe 18724, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 065, Runtime 16.956379, Loss 0.271566, forward nfe 19020, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 066, Runtime 16.753666, Loss 0.152156, forward nfe 19316, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 067, Runtime 17.024272, Loss 0.176817, forward nfe 19612, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 068, Runtime 16.872965, Loss 0.206135, forward nfe 19908, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 069, Runtime 16.956379, Loss 0.259472, forward nfe 20204, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 070, Runtime 16.807961, Loss 0.208486, forward nfe 20500, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 071, Runtime 17.169541, Loss 0.256584, forward nfe 20796, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 072, Runtime 17.415300, Loss 0.231474, forward nfe 21092, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 073, Runtime 17.789704, Loss 0.205024, forward nfe 21388, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 074, Runtime 17.936308, Loss 0.155325, forward nfe 21684, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 075, Runtime 17.841422, Loss 0.199122, forward nfe 21980, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 076, Runtime 17.731118, Loss 0.167924, forward nfe 22276, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 077, Runtime 18.087895, Loss 0.177119, forward nfe 22572, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 078, Runtime 17.957455, Loss 0.193541, forward nfe 22868, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 079, Runtime 17.921649, Loss 0.176104, forward nfe 23164, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 080, Runtime 18.016894, Loss 0.211202, forward nfe 23460, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 081, Runtime 17.941377, Loss 0.157426, forward nfe 23756, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 082, Runtime 18.015503, Loss 0.165613, forward nfe 24052, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 083, Runtime 18.186330, Loss 0.148757, forward nfe 24348, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 084, Runtime 18.029804, Loss 0.155881, forward nfe 24644, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 085, Runtime 18.115789, Loss 0.191809, forward nfe 24940, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 086, Runtime 18.269515, Loss 0.155906, forward nfe 25236, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 087, Runtime 19.812189, Loss 0.177576, forward nfe 25532, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 088, Runtime 20.393257, Loss 0.224132, forward nfe 25828, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 089, Runtime 20.532802, Loss 0.171243, forward nfe 26124, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 090, Runtime 20.368561, Loss 0.199254, forward nfe 26420, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 091, Runtime 20.436917, Loss 0.169797, forward nfe 26716, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 092, Runtime 20.509395, Loss 0.259805, forward nfe 27012, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 093, Runtime 20.386491, Loss 0.227582, forward nfe 27308, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 094, Runtime 20.427478, Loss 0.153946, forward nfe 27604, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 095, Runtime 20.576658, Loss 0.163375, forward nfe 27900, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 096, Runtime 20.973172, Loss 0.203568, forward nfe 28196, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 097, Runtime 20.915554, Loss 0.158554, forward nfe 28492, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 098, Runtime 20.864701, Loss 0.145048, forward nfe 28788, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
Epoch: 099, Runtime 21.090645, Loss 0.262640, forward nfe 29084, backward nfe 0, Train: 0.9357, Val: 0.8390, Test: 0.8497, Best time: 18.2948
best val accuracy 0.838971 with test accuracy 0.849746 at epoch 17 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8538071065989847
Entropy Threshold: 2 Test accuracy: 0.8477157360406091
Entropy Threshold: 1.6 Test accuracy: 0.8584615384615385
Entropy Threshold: 1.5 Test accuracy: 0.8505154639175257
Entropy Threshold: 1.4 Test accuracy: 0.8574401664932362
Entropy Threshold: 1.3 Test accuracy: 0.8695652173913043
Entropy Threshold: 1.2 Test accuracy: 0.867741935483871
Entropy Threshold: 1.1 Test accuracy: 0.8790233074361821
Entropy Threshold: 0.9 Test accuracy: 0.8936416184971099
Entropy Threshold: 0.8 Test accuracy: 0.8936678614097969
Entropy Threshold: 0.7 Test accuracy: 0.912718204488778
Entropy Threshold: 0.6 Test accuracy: 0.9173228346456693
Entropy Threshold: 0.5 Test accuracy: 0.9274965800273598
Entropy Threshold: 0.4 Test accuracy: 0.9315866084425036
Entropy Threshold: 0.3 Test accuracy: 0.9453978159126365
Entropy Threshold: 0.2 Test accuracy: 0.9573378839590444
Entropy Threshold: 0.1 Test accuracy: 0.9576923076923077
