[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.7
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 12.352094, Loss 2.066338, forward nfe 76, backward nfe 0, Train: 0.3357, Val: 0.2419, Test: 0.2335, Best time: 1.0000
Epoch: 002, Runtime 10.155124, Loss 2.522688, forward nfe 372, backward nfe 0, Train: 0.5143, Val: 0.4118, Test: 0.4162, Best time: 1.0000
Epoch: 003, Runtime 9.565088, Loss 2.022379, forward nfe 668, backward nfe 0, Train: 0.5143, Val: 0.4118, Test: 0.4162, Best time: 18.2948
Epoch: 004, Runtime 9.944290, Loss 1.960326, forward nfe 964, backward nfe 0, Train: 0.5143, Val: 0.4118, Test: 0.4162, Best time: 18.2948
Epoch: 005, Runtime 9.926506, Loss 2.019981, forward nfe 1260, backward nfe 0, Train: 0.6929, Val: 0.4721, Test: 0.4741, Best time: 1.0000
Epoch: 006, Runtime 9.662801, Loss 1.969104, forward nfe 1556, backward nfe 0, Train: 0.7357, Val: 0.6125, Test: 0.6102, Best time: 2.0000
Epoch: 007, Runtime 9.674867, Loss 1.912929, forward nfe 1852, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 2.0000
Epoch: 008, Runtime 9.493481, Loss 1.828582, forward nfe 2148, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 009, Runtime 9.748954, Loss 1.737351, forward nfe 2444, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 010, Runtime 9.794639, Loss 1.756250, forward nfe 2740, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 011, Runtime 9.873871, Loss 1.638839, forward nfe 3036, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 012, Runtime 9.784460, Loss 1.624975, forward nfe 3332, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 013, Runtime 9.442141, Loss 1.417492, forward nfe 3628, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 014, Runtime 9.449770, Loss 1.347301, forward nfe 3924, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 015, Runtime 10.018635, Loss 1.266662, forward nfe 4220, backward nfe 0, Train: 0.7643, Val: 0.6625, Test: 0.6558, Best time: 18.2948
Epoch: 016, Runtime 10.271449, Loss 1.165130, forward nfe 4516, backward nfe 0, Train: 0.8071, Val: 0.6691, Test: 0.6569, Best time: 9.0000
Epoch: 017, Runtime 9.454180, Loss 1.084167, forward nfe 4812, backward nfe 0, Train: 0.8143, Val: 0.6919, Test: 0.6741, Best time: 9.0000
Epoch: 018, Runtime 9.537736, Loss 0.978510, forward nfe 5108, backward nfe 0, Train: 0.8214, Val: 0.7221, Test: 0.6964, Best time: 8.0000
Epoch: 019, Runtime 9.442738, Loss 0.913344, forward nfe 5404, backward nfe 0, Train: 0.8000, Val: 0.7449, Test: 0.7411, Best time: 18.2948
Epoch: 020, Runtime 9.373217, Loss 0.891599, forward nfe 5700, backward nfe 0, Train: 0.8143, Val: 0.7544, Test: 0.7431, Best time: 18.2948
Epoch: 021, Runtime 8.578581, Loss 0.843078, forward nfe 5996, backward nfe 0, Train: 0.8143, Val: 0.7544, Test: 0.7431, Best time: 18.2948
Epoch: 022, Runtime 8.782636, Loss 0.817730, forward nfe 6292, backward nfe 0, Train: 0.8929, Val: 0.7603, Test: 0.7421, Best time: 19.0000
Epoch: 023, Runtime 8.622989, Loss 0.706716, forward nfe 6588, backward nfe 0, Train: 0.8929, Val: 0.7676, Test: 0.7492, Best time: 20.0000
Epoch: 024, Runtime 8.674314, Loss 0.717726, forward nfe 6884, backward nfe 0, Train: 0.8929, Val: 0.7772, Test: 0.7695, Best time: 30.0000
Epoch: 025, Runtime 8.778028, Loss 0.658602, forward nfe 7180, backward nfe 0, Train: 0.8857, Val: 0.7890, Test: 0.7797, Best time: 28.0000
Epoch: 026, Runtime 8.849263, Loss 0.712734, forward nfe 7476, backward nfe 0, Train: 0.8929, Val: 0.7993, Test: 0.7868, Best time: 26.0000
Epoch: 027, Runtime 8.555551, Loss 0.623943, forward nfe 7772, backward nfe 0, Train: 0.8929, Val: 0.7993, Test: 0.7868, Best time: 18.2948
Epoch: 028, Runtime 9.021380, Loss 0.774357, forward nfe 8068, backward nfe 0, Train: 0.9071, Val: 0.8000, Test: 0.7939, Best time: 31.0000
Epoch: 029, Runtime 8.767951, Loss 0.597877, forward nfe 8364, backward nfe 0, Train: 0.9000, Val: 0.8037, Test: 0.7827, Best time: 18.2948
Epoch: 030, Runtime 9.041079, Loss 0.608043, forward nfe 8660, backward nfe 0, Train: 0.9286, Val: 0.8044, Test: 0.7838, Best time: 39.0000
Epoch: 031, Runtime 9.780243, Loss 0.583010, forward nfe 8956, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 39.0000
Epoch: 032, Runtime 9.586062, Loss 0.661064, forward nfe 9252, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 033, Runtime 9.855047, Loss 0.484730, forward nfe 9548, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 034, Runtime 9.884376, Loss 0.554374, forward nfe 9844, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 035, Runtime 9.866829, Loss 0.531210, forward nfe 10140, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 036, Runtime 10.301235, Loss 0.555213, forward nfe 10436, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 037, Runtime 10.144170, Loss 0.536149, forward nfe 10732, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 038, Runtime 10.136075, Loss 0.542804, forward nfe 11028, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 039, Runtime 10.574537, Loss 0.500228, forward nfe 11324, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 040, Runtime 10.415043, Loss 0.524497, forward nfe 11620, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 041, Runtime 10.441738, Loss 0.476565, forward nfe 11916, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 042, Runtime 10.676658, Loss 0.498382, forward nfe 12212, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 043, Runtime 10.693977, Loss 0.482735, forward nfe 12508, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 044, Runtime 10.767814, Loss 0.415411, forward nfe 12804, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 045, Runtime 11.005585, Loss 0.457325, forward nfe 13100, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 046, Runtime 11.017590, Loss 0.463645, forward nfe 13396, backward nfe 0, Train: 0.9286, Val: 0.8081, Test: 0.7909, Best time: 18.2948
Epoch: 047, Runtime 11.305816, Loss 0.378105, forward nfe 13692, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 048, Runtime 10.050235, Loss 0.370970, forward nfe 13988, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 049, Runtime 10.330691, Loss 0.402453, forward nfe 14284, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 050, Runtime 10.215495, Loss 0.441504, forward nfe 14580, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 051, Runtime 10.356994, Loss 0.390680, forward nfe 14876, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 052, Runtime 10.682289, Loss 0.342817, forward nfe 15172, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 053, Runtime 10.450015, Loss 0.388499, forward nfe 15468, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 054, Runtime 10.502492, Loss 0.409692, forward nfe 15764, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 055, Runtime 10.960077, Loss 0.435051, forward nfe 16060, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 056, Runtime 10.843995, Loss 0.402205, forward nfe 16356, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 057, Runtime 10.876382, Loss 0.481518, forward nfe 16652, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 058, Runtime 11.195104, Loss 0.435115, forward nfe 16948, backward nfe 0, Train: 0.9500, Val: 0.8110, Test: 0.7939, Best time: 18.2948
Epoch: 059, Runtime 11.226183, Loss 0.403682, forward nfe 17244, backward nfe 0, Train: 0.9429, Val: 0.8118, Test: 0.8071, Best time: 18.2948
Epoch: 060, Runtime 9.993077, Loss 0.420576, forward nfe 17540, backward nfe 0, Train: 0.9429, Val: 0.8118, Test: 0.8071, Best time: 18.2948
Epoch: 061, Runtime 10.185344, Loss 0.352227, forward nfe 17836, backward nfe 0, Train: 0.9429, Val: 0.8118, Test: 0.8071, Best time: 18.2948
Epoch: 062, Runtime 10.194723, Loss 0.350385, forward nfe 18132, backward nfe 0, Train: 0.9429, Val: 0.8118, Test: 0.8071, Best time: 18.2948
Epoch: 063, Runtime 10.198882, Loss 0.343876, forward nfe 18428, backward nfe 0, Train: 0.9429, Val: 0.8118, Test: 0.8071, Best time: 18.2948
Epoch: 064, Runtime 10.535114, Loss 0.409392, forward nfe 18724, backward nfe 0, Train: 0.9429, Val: 0.8118, Test: 0.8071, Best time: 18.2948
Epoch: 065, Runtime 10.615873, Loss 0.388851, forward nfe 19020, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 066, Runtime 9.779620, Loss 0.319258, forward nfe 19316, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 067, Runtime 10.220324, Loss 0.292266, forward nfe 19612, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 068, Runtime 10.115561, Loss 0.397080, forward nfe 19908, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 069, Runtime 10.047740, Loss 0.362875, forward nfe 20204, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 070, Runtime 10.494081, Loss 0.392707, forward nfe 20500, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 071, Runtime 10.303231, Loss 0.423202, forward nfe 20796, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 072, Runtime 10.304879, Loss 0.499679, forward nfe 21092, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 073, Runtime 10.474058, Loss 0.385505, forward nfe 21388, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 074, Runtime 10.478027, Loss 0.306810, forward nfe 21684, backward nfe 0, Train: 0.9643, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 075, Runtime 10.634749, Loss 0.389497, forward nfe 21980, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 076, Runtime 9.254420, Loss 0.289286, forward nfe 22276, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 077, Runtime 9.558280, Loss 0.413810, forward nfe 22572, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 078, Runtime 9.443398, Loss 0.401735, forward nfe 22868, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 079, Runtime 9.423007, Loss 0.296210, forward nfe 23164, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 080, Runtime 9.993396, Loss 0.361499, forward nfe 23460, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 081, Runtime 9.905203, Loss 0.344713, forward nfe 23756, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 082, Runtime 9.990435, Loss 0.416383, forward nfe 24052, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 083, Runtime 10.073142, Loss 0.341552, forward nfe 24348, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 084, Runtime 10.025753, Loss 0.321271, forward nfe 24644, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 085, Runtime 10.089589, Loss 0.304087, forward nfe 24940, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 086, Runtime 10.261830, Loss 0.329868, forward nfe 25236, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 087, Runtime 10.248312, Loss 0.358386, forward nfe 25532, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 088, Runtime 10.125198, Loss 0.291946, forward nfe 25828, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 089, Runtime 10.404269, Loss 0.255554, forward nfe 26124, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 090, Runtime 10.383992, Loss 0.293753, forward nfe 26420, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 091, Runtime 10.346124, Loss 0.343246, forward nfe 26716, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 092, Runtime 10.677469, Loss 0.317176, forward nfe 27012, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 093, Runtime 10.538285, Loss 0.256649, forward nfe 27308, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 094, Runtime 10.502060, Loss 0.415477, forward nfe 27604, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 095, Runtime 10.759028, Loss 0.182496, forward nfe 27900, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 096, Runtime 10.597256, Loss 0.226933, forward nfe 28196, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 097, Runtime 10.136698, Loss 0.280589, forward nfe 28492, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 098, Runtime 11.335753, Loss 0.307483, forward nfe 28788, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
Epoch: 099, Runtime 12.176998, Loss 0.219876, forward nfe 29084, backward nfe 0, Train: 0.9571, Val: 0.8346, Test: 0.8335, Best time: 18.2948
best val accuracy 0.834559 with test accuracy 0.833503 at epoch 75 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8609137055837564
Entropy Threshold: 2 Test accuracy: 0.8507614213197969
Entropy Threshold: 1.6 Test accuracy: 0.8513238289205702
Entropy Threshold: 1.5 Test accuracy: 0.8574358974358974
Entropy Threshold: 1.4 Test accuracy: 0.8531540847983454
Entropy Threshold: 1.3 Test accuracy: 0.856694560669456
Entropy Threshold: 1.2 Test accuracy: 0.8685897435897436
Entropy Threshold: 1.1 Test accuracy: 0.8668831168831169
Entropy Threshold: 0.9 Test accuracy: 0.875
Entropy Threshold: 0.8 Test accuracy: 0.8900836320191159
Entropy Threshold: 0.7 Test accuracy: 0.8991282689912827
Entropy Threshold: 0.6 Test accuracy: 0.9088541666666666
Entropy Threshold: 0.5 Test accuracy: 0.9187675070028011
Entropy Threshold: 0.4 Test accuracy: 0.9365781710914455
Entropy Threshold: 0.3 Test accuracy: 0.9433656957928802
Entropy Threshold: 0.2 Test accuracy: 0.9450171821305842
Entropy Threshold: 0.1 Test accuracy: 0.9573170731707317
