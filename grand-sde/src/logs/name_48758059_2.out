[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 7.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.034151, Loss 5.517918, forward nfe 76, backward nfe 0, Train: 0.4143, Val: 0.2559, Test: 0.2355, Best time: 1.0000
Epoch: 002, Runtime 10.702325, Loss 6.241313, forward nfe 372, backward nfe 0, Train: 0.6571, Val: 0.5426, Test: 0.5299, Best time: 1.0000
Epoch: 003, Runtime 10.317168, Loss 5.699859, forward nfe 668, backward nfe 0, Train: 0.6571, Val: 0.5426, Test: 0.5299, Best time: 18.2948
Epoch: 004, Runtime 11.118244, Loss 4.740026, forward nfe 964, backward nfe 0, Train: 0.6571, Val: 0.5426, Test: 0.5299, Best time: 18.2948
Epoch: 005, Runtime 11.103930, Loss 4.811493, forward nfe 1260, backward nfe 0, Train: 0.7643, Val: 0.5434, Test: 0.5766, Best time: 5.0000
Epoch: 006, Runtime 10.952828, Loss 4.243017, forward nfe 1556, backward nfe 0, Train: 0.8214, Val: 0.5985, Test: 0.6244, Best time: 14.0000
Epoch: 007, Runtime 10.714932, Loss 3.380414, forward nfe 1852, backward nfe 0, Train: 0.8214, Val: 0.5985, Test: 0.6244, Best time: 18.2948
Epoch: 008, Runtime 10.962651, Loss 3.308676, forward nfe 2148, backward nfe 0, Train: 0.8214, Val: 0.5985, Test: 0.6244, Best time: 18.2948
Epoch: 009, Runtime 10.600920, Loss 3.289723, forward nfe 2444, backward nfe 0, Train: 0.8214, Val: 0.5985, Test: 0.6244, Best time: 18.2948
Epoch: 010, Runtime 11.099131, Loss 2.940153, forward nfe 2740, backward nfe 0, Train: 0.8429, Val: 0.6441, Test: 0.6609, Best time: 22.0000
Epoch: 011, Runtime 10.744112, Loss 2.949661, forward nfe 3036, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 10.0000
Epoch: 012, Runtime 10.845465, Loss 2.630515, forward nfe 3332, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 013, Runtime 11.404604, Loss 2.442151, forward nfe 3628, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 014, Runtime 10.785815, Loss 2.146337, forward nfe 3924, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 015, Runtime 11.067689, Loss 2.067621, forward nfe 4220, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 016, Runtime 11.007464, Loss 1.975194, forward nfe 4516, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 017, Runtime 10.933184, Loss 1.941376, forward nfe 4812, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 018, Runtime 11.023918, Loss 2.023057, forward nfe 5108, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 019, Runtime 11.263567, Loss 1.920731, forward nfe 5404, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 020, Runtime 11.644330, Loss 1.701242, forward nfe 5700, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 021, Runtime 11.656546, Loss 1.834762, forward nfe 5996, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 022, Runtime 11.385266, Loss 1.862906, forward nfe 6292, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 023, Runtime 11.800648, Loss 1.689309, forward nfe 6588, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 024, Runtime 12.253442, Loss 1.777658, forward nfe 6884, backward nfe 0, Train: 0.8786, Val: 0.6669, Test: 0.6772, Best time: 18.2948
Epoch: 025, Runtime 12.850256, Loss 1.487676, forward nfe 7180, backward nfe 0, Train: 0.8500, Val: 0.6941, Test: 0.7005, Best time: 42.0000
Epoch: 026, Runtime 10.588043, Loss 1.825400, forward nfe 7476, backward nfe 0, Train: 0.8857, Val: 0.7213, Test: 0.7107, Best time: 13.0000
Epoch: 027, Runtime 10.706984, Loss 1.491858, forward nfe 7772, backward nfe 0, Train: 0.8857, Val: 0.7316, Test: 0.7269, Best time: 12.0000
Epoch: 028, Runtime 10.699918, Loss 1.381988, forward nfe 8068, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 14.0000
Epoch: 029, Runtime 10.933446, Loss 1.687470, forward nfe 8364, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 030, Runtime 11.300894, Loss 1.599997, forward nfe 8660, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 031, Runtime 10.988888, Loss 1.566210, forward nfe 8956, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 032, Runtime 11.477176, Loss 1.515015, forward nfe 9252, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 033, Runtime 11.662086, Loss 1.329238, forward nfe 9548, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 034, Runtime 11.594307, Loss 1.476516, forward nfe 9844, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 035, Runtime 11.761689, Loss 1.437196, forward nfe 10140, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 036, Runtime 12.517724, Loss 1.225237, forward nfe 10436, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 037, Runtime 12.686496, Loss 1.210346, forward nfe 10732, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 038, Runtime 13.009009, Loss 1.346954, forward nfe 11028, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 039, Runtime 13.505937, Loss 1.144103, forward nfe 11324, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 040, Runtime 14.268293, Loss 1.162869, forward nfe 11620, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 041, Runtime 14.168057, Loss 1.195112, forward nfe 11916, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 042, Runtime 14.301609, Loss 1.245399, forward nfe 12212, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 043, Runtime 14.448838, Loss 1.298196, forward nfe 12508, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 044, Runtime 14.493733, Loss 1.199274, forward nfe 12804, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 045, Runtime 14.928600, Loss 1.081426, forward nfe 13100, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 046, Runtime 15.100454, Loss 1.053662, forward nfe 13396, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 047, Runtime 15.212577, Loss 1.089648, forward nfe 13692, backward nfe 0, Train: 0.8857, Val: 0.7397, Test: 0.7259, Best time: 18.2948
Epoch: 048, Runtime 15.550098, Loss 1.157336, forward nfe 13988, backward nfe 0, Train: 0.8929, Val: 0.7419, Test: 0.7289, Best time: 20.0000
Epoch: 049, Runtime 12.296631, Loss 1.169540, forward nfe 14284, backward nfe 0, Train: 0.8929, Val: 0.7522, Test: 0.7320, Best time: 23.0000
Epoch: 050, Runtime 12.306935, Loss 0.976986, forward nfe 14580, backward nfe 0, Train: 0.8857, Val: 0.7581, Test: 0.7310, Best time: 28.0000
Epoch: 051, Runtime 12.282867, Loss 1.311271, forward nfe 14876, backward nfe 0, Train: 0.8857, Val: 0.7581, Test: 0.7310, Best time: 18.2948
Epoch: 052, Runtime 12.326378, Loss 0.918672, forward nfe 15172, backward nfe 0, Train: 0.8857, Val: 0.7581, Test: 0.7310, Best time: 18.2948
Epoch: 053, Runtime 12.520268, Loss 1.034827, forward nfe 15468, backward nfe 0, Train: 0.8857, Val: 0.7581, Test: 0.7310, Best time: 18.2948
Epoch: 054, Runtime 12.540754, Loss 0.915328, forward nfe 15764, backward nfe 0, Train: 0.8857, Val: 0.7581, Test: 0.7310, Best time: 18.2948
Epoch: 055, Runtime 13.325442, Loss 0.986779, forward nfe 16060, backward nfe 0, Train: 0.8857, Val: 0.7581, Test: 0.7310, Best time: 18.2948
Epoch: 056, Runtime 13.533507, Loss 1.012332, forward nfe 16356, backward nfe 0, Train: 0.9214, Val: 0.7676, Test: 0.7604, Best time: 30.0000
Epoch: 057, Runtime 12.314255, Loss 1.047016, forward nfe 16652, backward nfe 0, Train: 0.9143, Val: 0.7699, Test: 0.7695, Best time: 50.0000
Epoch: 058, Runtime 12.451924, Loss 0.830710, forward nfe 16948, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 35.0000
Epoch: 059, Runtime 12.217264, Loss 0.945820, forward nfe 17244, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 060, Runtime 12.463707, Loss 1.042657, forward nfe 17540, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 061, Runtime 12.844268, Loss 0.796110, forward nfe 17836, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 062, Runtime 13.196802, Loss 0.930289, forward nfe 18132, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 063, Runtime 13.552705, Loss 0.930685, forward nfe 18428, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 064, Runtime 13.736729, Loss 0.847884, forward nfe 18724, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 065, Runtime 14.029658, Loss 1.082288, forward nfe 19020, backward nfe 0, Train: 0.9214, Val: 0.7735, Test: 0.7756, Best time: 18.2948
Epoch: 066, Runtime 14.434850, Loss 0.915794, forward nfe 19316, backward nfe 0, Train: 0.9143, Val: 0.7787, Test: 0.7675, Best time: 29.0000
Epoch: 067, Runtime 12.755965, Loss 0.949521, forward nfe 19612, backward nfe 0, Train: 0.9286, Val: 0.7882, Test: 0.7848, Best time: 42.0000
Epoch: 068, Runtime 13.168580, Loss 0.783764, forward nfe 19908, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 46.0000
Epoch: 069, Runtime 13.097198, Loss 0.891517, forward nfe 20204, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 18.2948
Epoch: 070, Runtime 13.179800, Loss 0.829877, forward nfe 20500, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 18.2948
Epoch: 071, Runtime 13.247560, Loss 0.983454, forward nfe 20796, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 18.2948
Epoch: 072, Runtime 13.208944, Loss 0.874021, forward nfe 21092, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 18.2948
Epoch: 073, Runtime 13.498420, Loss 0.860522, forward nfe 21388, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 18.2948
Epoch: 074, Runtime 14.174595, Loss 0.780736, forward nfe 21684, backward nfe 0, Train: 0.9214, Val: 0.7971, Test: 0.7939, Best time: 18.2948
Epoch: 075, Runtime 14.322538, Loss 0.861318, forward nfe 21980, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 48.0000
Epoch: 076, Runtime 12.744115, Loss 0.820438, forward nfe 22276, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 077, Runtime 12.213824, Loss 0.911761, forward nfe 22572, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 078, Runtime 12.502299, Loss 0.955841, forward nfe 22868, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 079, Runtime 12.806182, Loss 0.703884, forward nfe 23164, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 080, Runtime 13.069112, Loss 0.764381, forward nfe 23460, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 081, Runtime 13.242262, Loss 0.716859, forward nfe 23756, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 082, Runtime 13.305250, Loss 0.848097, forward nfe 24052, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 083, Runtime 13.828496, Loss 0.890177, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 084, Runtime 14.092777, Loss 0.824017, forward nfe 24644, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 085, Runtime 14.487887, Loss 0.753760, forward nfe 24940, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 086, Runtime 14.670180, Loss 0.750004, forward nfe 25236, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 087, Runtime 13.694927, Loss 0.800690, forward nfe 25532, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 088, Runtime 13.835721, Loss 0.757004, forward nfe 25828, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 089, Runtime 14.048712, Loss 0.991826, forward nfe 26124, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 090, Runtime 14.475143, Loss 0.894432, forward nfe 26420, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 091, Runtime 14.432194, Loss 0.707634, forward nfe 26716, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 092, Runtime 14.842056, Loss 0.672432, forward nfe 27012, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 093, Runtime 14.924949, Loss 0.639227, forward nfe 27308, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 094, Runtime 15.152801, Loss 0.771068, forward nfe 27604, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 095, Runtime 15.280330, Loss 0.598788, forward nfe 27900, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 096, Runtime 15.743427, Loss 0.684735, forward nfe 28196, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 097, Runtime 15.915306, Loss 0.684735, forward nfe 28492, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 098, Runtime 15.694289, Loss 0.678439, forward nfe 28788, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
Epoch: 099, Runtime 16.002106, Loss 0.792359, forward nfe 29084, backward nfe 0, Train: 0.9429, Val: 0.8029, Test: 0.8010, Best time: 18.2948
best val accuracy 0.802941 with test accuracy 0.801015 at epoch 75 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8060913705583757
Entropy Threshold: 2 Test accuracy: 0.8081218274111676
Entropy Threshold: 1.6 Test accuracy: 0.8254963427377221
Entropy Threshold: 1.5 Test accuracy: 0.821505376344086
Entropy Threshold: 1.4 Test accuracy: 0.8263274336283186
Entropy Threshold: 1.3 Test accuracy: 0.8388195232690124
Entropy Threshold: 1.2 Test accuracy: 0.8602409638554217
Entropy Threshold: 1.1 Test accuracy: 0.867080745341615
Entropy Threshold: 0.9 Test accuracy: 0.8885832187070152
Entropy Threshold: 0.8 Test accuracy: 0.8972099853157122
Entropy Threshold: 0.7 Test accuracy: 0.9167974882260597
Entropy Threshold: 0.6 Test accuracy: 0.9245283018867925
Entropy Threshold: 0.5 Test accuracy: 0.9314079422382672
Entropy Threshold: 0.4 Test accuracy: 0.9412955465587044
Entropy Threshold: 0.3 Test accuracy: 0.9447983014861996
Entropy Threshold: 0.2 Test accuracy: 0.9589371980676329
Entropy Threshold: 0.1 Test accuracy: 0.9661016949152542
