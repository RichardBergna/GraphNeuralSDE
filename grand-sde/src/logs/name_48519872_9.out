[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 15.332882, Loss 2.228061, forward nfe 76, backward nfe 0, Train: 0.7571, Val: 0.6507, Test: 0.6721, Best time: 29.0000
Epoch: 002, Runtime 16.879166, Loss 2.488415, forward nfe 372, backward nfe 0, Train: 0.7571, Val: 0.6507, Test: 0.6721, Best time: 18.2948
Epoch: 003, Runtime 15.077709, Loss 2.007086, forward nfe 668, backward nfe 0, Train: 0.7571, Val: 0.6507, Test: 0.6721, Best time: 18.2948
Epoch: 004, Runtime 13.891601, Loss 1.943611, forward nfe 964, backward nfe 0, Train: 0.7571, Val: 0.6507, Test: 0.6721, Best time: 18.2948
Epoch: 005, Runtime 14.298320, Loss 1.916531, forward nfe 1260, backward nfe 0, Train: 0.8643, Val: 0.7684, Test: 0.7584, Best time: 12.0000
Epoch: 006, Runtime 14.151069, Loss 1.762715, forward nfe 1556, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 10.0000
Epoch: 007, Runtime 13.979127, Loss 1.587781, forward nfe 1852, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 008, Runtime 13.976268, Loss 1.616020, forward nfe 2148, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 009, Runtime 13.532573, Loss 1.341491, forward nfe 2444, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 010, Runtime 13.656706, Loss 1.278409, forward nfe 2740, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 011, Runtime 14.074215, Loss 1.118425, forward nfe 3036, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 012, Runtime 14.011507, Loss 1.029530, forward nfe 3332, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 013, Runtime 14.038748, Loss 0.954132, forward nfe 3628, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 014, Runtime 15.015466, Loss 0.926709, forward nfe 3924, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 015, Runtime 14.762789, Loss 0.835101, forward nfe 4220, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 016, Runtime 14.943346, Loss 0.774668, forward nfe 4516, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 017, Runtime 15.282286, Loss 0.748713, forward nfe 4812, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 018, Runtime 15.024024, Loss 0.653729, forward nfe 5108, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 019, Runtime 15.202088, Loss 0.676418, forward nfe 5404, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 020, Runtime 15.658765, Loss 0.583021, forward nfe 5700, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 021, Runtime 15.358944, Loss 0.561906, forward nfe 5996, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 022, Runtime 14.997900, Loss 0.639601, forward nfe 6292, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 023, Runtime 15.775423, Loss 0.574601, forward nfe 6588, backward nfe 0, Train: 0.8071, Val: 0.7735, Test: 0.7797, Best time: 18.2948
Epoch: 024, Runtime 15.869653, Loss 0.537452, forward nfe 6884, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 025, Runtime 13.307654, Loss 0.518927, forward nfe 7180, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 026, Runtime 13.596992, Loss 0.474753, forward nfe 7476, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 027, Runtime 13.346317, Loss 0.489732, forward nfe 7772, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 028, Runtime 13.323107, Loss 0.495245, forward nfe 8068, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 029, Runtime 13.756578, Loss 0.494262, forward nfe 8364, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 030, Runtime 13.885032, Loss 0.509506, forward nfe 8660, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 031, Runtime 13.625438, Loss 0.436247, forward nfe 8956, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 032, Runtime 14.568120, Loss 0.483870, forward nfe 9252, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 033, Runtime 14.340466, Loss 0.457025, forward nfe 9548, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 034, Runtime 14.799237, Loss 0.412420, forward nfe 9844, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 035, Runtime 15.026953, Loss 0.434550, forward nfe 10140, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 036, Runtime 14.555827, Loss 0.423667, forward nfe 10436, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 037, Runtime 14.629750, Loss 0.364919, forward nfe 10732, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 038, Runtime 15.056873, Loss 0.485060, forward nfe 11028, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 039, Runtime 14.996076, Loss 0.387769, forward nfe 11324, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 040, Runtime 14.933432, Loss 0.352756, forward nfe 11620, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 041, Runtime 15.272168, Loss 0.384542, forward nfe 11916, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 042, Runtime 15.193940, Loss 0.372821, forward nfe 12212, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 043, Runtime 15.313084, Loss 0.436982, forward nfe 12508, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 044, Runtime 15.645673, Loss 0.361207, forward nfe 12804, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 045, Runtime 15.340021, Loss 0.398466, forward nfe 13100, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 046, Runtime 15.869548, Loss 0.479299, forward nfe 13396, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 047, Runtime 15.749123, Loss 0.302934, forward nfe 13692, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 048, Runtime 16.135981, Loss 0.336282, forward nfe 13988, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 049, Runtime 16.256893, Loss 0.307713, forward nfe 14284, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 050, Runtime 15.906924, Loss 0.414605, forward nfe 14580, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 051, Runtime 15.688480, Loss 0.328365, forward nfe 14876, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 052, Runtime 15.842296, Loss 0.386730, forward nfe 15172, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 053, Runtime 16.027538, Loss 0.364388, forward nfe 15468, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 054, Runtime 15.782498, Loss 0.390044, forward nfe 15764, backward nfe 0, Train: 0.9000, Val: 0.7750, Test: 0.7431, Best time: 18.2948
Epoch: 055, Runtime 16.107166, Loss 0.339567, forward nfe 16060, backward nfe 0, Train: 0.9643, Val: 0.7801, Test: 0.7898, Best time: 18.2948
Epoch: 056, Runtime 12.999307, Loss 0.307272, forward nfe 16356, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 057, Runtime 12.701135, Loss 0.319787, forward nfe 16652, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 058, Runtime 13.082021, Loss 0.325084, forward nfe 16948, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 059, Runtime 13.021829, Loss 0.285059, forward nfe 17244, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 060, Runtime 13.030192, Loss 0.296227, forward nfe 17540, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 061, Runtime 13.499624, Loss 0.428629, forward nfe 17836, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 062, Runtime 13.307503, Loss 0.351590, forward nfe 18132, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 063, Runtime 13.608005, Loss 0.297912, forward nfe 18428, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 064, Runtime 13.922882, Loss 0.259281, forward nfe 18724, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 065, Runtime 13.817594, Loss 0.307577, forward nfe 19020, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 066, Runtime 13.910873, Loss 0.379166, forward nfe 19316, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 067, Runtime 14.234906, Loss 0.379778, forward nfe 19612, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 068, Runtime 14.184390, Loss 0.306593, forward nfe 19908, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 069, Runtime 14.368979, Loss 0.243648, forward nfe 20204, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 070, Runtime 14.693915, Loss 0.243069, forward nfe 20500, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 071, Runtime 14.536490, Loss 0.316493, forward nfe 20796, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 072, Runtime 14.557226, Loss 0.315509, forward nfe 21092, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 073, Runtime 14.902813, Loss 0.259893, forward nfe 21388, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 074, Runtime 14.775138, Loss 0.282564, forward nfe 21684, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 075, Runtime 14.946070, Loss 0.297526, forward nfe 21980, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 076, Runtime 15.111117, Loss 0.359668, forward nfe 22276, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 077, Runtime 14.980882, Loss 0.269188, forward nfe 22572, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 078, Runtime 15.072921, Loss 0.426727, forward nfe 22868, backward nfe 0, Train: 0.9429, Val: 0.7985, Test: 0.7817, Best time: 18.2948
Epoch: 079, Runtime 15.457947, Loss 0.291102, forward nfe 23164, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 080, Runtime 12.395571, Loss 0.319628, forward nfe 23460, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 081, Runtime 12.857847, Loss 0.328358, forward nfe 23756, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 082, Runtime 12.878608, Loss 0.277135, forward nfe 24052, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 083, Runtime 12.752051, Loss 0.341622, forward nfe 24348, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 084, Runtime 13.306416, Loss 0.297958, forward nfe 24644, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 085, Runtime 13.135580, Loss 0.286665, forward nfe 24940, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 086, Runtime 13.296637, Loss 0.215360, forward nfe 25236, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 087, Runtime 13.631967, Loss 0.296120, forward nfe 25532, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 088, Runtime 13.531013, Loss 0.239152, forward nfe 25828, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 089, Runtime 13.632222, Loss 0.237449, forward nfe 26124, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 090, Runtime 14.040703, Loss 0.225939, forward nfe 26420, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 091, Runtime 13.978380, Loss 0.167274, forward nfe 26716, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 092, Runtime 13.977687, Loss 0.222955, forward nfe 27012, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 093, Runtime 14.488209, Loss 0.181755, forward nfe 27308, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 094, Runtime 14.315640, Loss 0.250712, forward nfe 27604, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 095, Runtime 14.419820, Loss 0.244065, forward nfe 27900, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 096, Runtime 14.741336, Loss 0.251511, forward nfe 28196, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 097, Runtime 14.170674, Loss 0.232197, forward nfe 28492, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 098, Runtime 14.195658, Loss 0.291495, forward nfe 28788, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
Epoch: 099, Runtime 14.301010, Loss 0.309619, forward nfe 29084, backward nfe 0, Train: 0.9571, Val: 0.8015, Test: 0.7838, Best time: 18.2948
best val accuracy 0.801471 with test accuracy 0.783756 at epoch 79 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8101522842639594
Entropy Threshold: 2 Test accuracy: 0.8152284263959391
Entropy Threshold: 1.6 Test accuracy: 0.8123076923076923
Entropy Threshold: 1.5 Test accuracy: 0.8155440414507772
Entropy Threshold: 1.4 Test accuracy: 0.8272251308900523
Entropy Threshold: 1.3 Test accuracy: 0.8328042328042328
Entropy Threshold: 1.2 Test accuracy: 0.8324265505984766
Entropy Threshold: 1.1 Test accuracy: 0.8457207207207207
Entropy Threshold: 0.9 Test accuracy: 0.8706896551724138
Entropy Threshold: 0.8 Test accuracy: 0.879021879021879
Entropy Threshold: 0.7 Test accuracy: 0.8908355795148248
Entropy Threshold: 0.6 Test accuracy: 0.9080459770114943
Entropy Threshold: 0.5 Test accuracy: 0.9142857142857143
Entropy Threshold: 0.4 Test accuracy: 0.9216
Entropy Threshold: 0.3 Test accuracy: 0.9315068493150684
Entropy Threshold: 0.2 Test accuracy: 0.9424184261036468
Entropy Threshold: 0.1 Test accuracy: 0.9501133786848073
