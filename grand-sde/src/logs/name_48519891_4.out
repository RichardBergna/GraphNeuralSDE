[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 5.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 16.920717, Loss 3.947240, forward nfe 76, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 1.0000
Epoch: 002, Runtime 16.654094, Loss 4.216649, forward nfe 372, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 003, Runtime 17.030389, Loss 3.938500, forward nfe 668, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 004, Runtime 16.489454, Loss 3.339603, forward nfe 964, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 005, Runtime 17.373784, Loss 3.325160, forward nfe 1260, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 006, Runtime 17.585287, Loss 3.308886, forward nfe 1556, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 007, Runtime 17.847985, Loss 2.991027, forward nfe 1852, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 008, Runtime 17.905815, Loss 2.820558, forward nfe 2148, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 009, Runtime 18.416625, Loss 2.587432, forward nfe 2444, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 010, Runtime 18.772836, Loss 2.458666, forward nfe 2740, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 011, Runtime 17.944896, Loss 2.395216, forward nfe 3036, backward nfe 0, Train: 0.3786, Val: 0.3441, Test: 0.3868, Best time: 18.2948
Epoch: 012, Runtime 18.271119, Loss 2.323236, forward nfe 3332, backward nfe 0, Train: 0.5714, Val: 0.3500, Test: 0.3513, Best time: 6.0000
Epoch: 013, Runtime 16.290024, Loss 2.260981, forward nfe 3628, backward nfe 0, Train: 0.6357, Val: 0.4338, Test: 0.4437, Best time: 7.0000
Epoch: 014, Runtime 15.878543, Loss 2.169898, forward nfe 3924, backward nfe 0, Train: 0.6929, Val: 0.5184, Test: 0.5391, Best time: 6.0000
Epoch: 015, Runtime 15.813488, Loss 2.037668, forward nfe 4220, backward nfe 0, Train: 0.7643, Val: 0.5941, Test: 0.6132, Best time: 8.0000
Epoch: 016, Runtime 15.914957, Loss 1.801055, forward nfe 4516, backward nfe 0, Train: 0.7857, Val: 0.6463, Test: 0.6609, Best time: 6.0000
Epoch: 017, Runtime 15.850963, Loss 1.907623, forward nfe 4812, backward nfe 0, Train: 0.8143, Val: 0.6824, Test: 0.6964, Best time: 13.0000
Epoch: 018, Runtime 15.818814, Loss 1.682108, forward nfe 5108, backward nfe 0, Train: 0.8500, Val: 0.7176, Test: 0.7127, Best time: 11.0000
Epoch: 019, Runtime 15.764649, Loss 1.702080, forward nfe 5404, backward nfe 0, Train: 0.8429, Val: 0.7301, Test: 0.7289, Best time: 14.0000
Epoch: 020, Runtime 15.618015, Loss 1.708276, forward nfe 5700, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 17.0000
Epoch: 021, Runtime 15.421210, Loss 1.750084, forward nfe 5996, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 022, Runtime 16.270278, Loss 1.535970, forward nfe 6292, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 023, Runtime 15.824127, Loss 1.522451, forward nfe 6588, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 024, Runtime 16.157658, Loss 1.449559, forward nfe 6884, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 025, Runtime 16.303761, Loss 1.500704, forward nfe 7180, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 026, Runtime 16.585942, Loss 1.440930, forward nfe 7476, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 027, Runtime 17.384463, Loss 1.463035, forward nfe 7772, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 028, Runtime 16.794777, Loss 1.353193, forward nfe 8068, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 029, Runtime 17.119643, Loss 1.343385, forward nfe 8364, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 030, Runtime 17.356970, Loss 1.142050, forward nfe 8660, backward nfe 0, Train: 0.8429, Val: 0.7426, Test: 0.7381, Best time: 18.2948
Epoch: 031, Runtime 17.856120, Loss 1.232419, forward nfe 8956, backward nfe 0, Train: 0.8571, Val: 0.7471, Test: 0.7594, Best time: 26.0000
Epoch: 032, Runtime 15.825083, Loss 1.172574, forward nfe 9252, backward nfe 0, Train: 0.8714, Val: 0.7566, Test: 0.7655, Best time: 17.0000
Epoch: 033, Runtime 15.985718, Loss 1.183723, forward nfe 9548, backward nfe 0, Train: 0.8929, Val: 0.7596, Test: 0.7777, Best time: 21.0000
Epoch: 034, Runtime 16.545094, Loss 1.093063, forward nfe 9844, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 15.0000
Epoch: 035, Runtime 16.489306, Loss 1.105873, forward nfe 10140, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 036, Runtime 16.953937, Loss 0.998669, forward nfe 10436, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 037, Runtime 16.529563, Loss 1.081652, forward nfe 10732, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 038, Runtime 17.089274, Loss 1.208652, forward nfe 11028, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 039, Runtime 16.768052, Loss 0.966096, forward nfe 11324, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 040, Runtime 16.940405, Loss 1.178289, forward nfe 11620, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 041, Runtime 16.947781, Loss 1.053153, forward nfe 11916, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 042, Runtime 17.944522, Loss 0.804062, forward nfe 12212, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 043, Runtime 18.442030, Loss 0.836345, forward nfe 12508, backward nfe 0, Train: 0.9071, Val: 0.7654, Test: 0.7756, Best time: 18.2948
Epoch: 044, Runtime 18.748762, Loss 0.959975, forward nfe 12804, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 34.0000
Epoch: 045, Runtime 16.340998, Loss 0.903007, forward nfe 13100, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 046, Runtime 16.425249, Loss 0.795197, forward nfe 13396, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 047, Runtime 16.525702, Loss 0.823835, forward nfe 13692, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 048, Runtime 17.178362, Loss 0.960653, forward nfe 13988, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 049, Runtime 17.367498, Loss 0.882323, forward nfe 14284, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 050, Runtime 17.208166, Loss 0.909979, forward nfe 14580, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 051, Runtime 17.027741, Loss 0.908942, forward nfe 14876, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 052, Runtime 16.926705, Loss 0.641585, forward nfe 15172, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 053, Runtime 17.633292, Loss 0.783466, forward nfe 15468, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 054, Runtime 17.876155, Loss 0.715373, forward nfe 15764, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 055, Runtime 18.424139, Loss 0.768025, forward nfe 16060, backward nfe 0, Train: 0.9000, Val: 0.7662, Test: 0.7827, Best time: 18.2948
Epoch: 056, Runtime 18.726660, Loss 0.785989, forward nfe 16356, backward nfe 0, Train: 0.9071, Val: 0.7706, Test: 0.7807, Best time: 18.2948
Epoch: 057, Runtime 14.866961, Loss 0.710739, forward nfe 16652, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 058, Runtime 14.773437, Loss 0.653838, forward nfe 16948, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 059, Runtime 14.999905, Loss 0.775989, forward nfe 17244, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 060, Runtime 14.885726, Loss 0.746018, forward nfe 17540, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 061, Runtime 15.491908, Loss 0.611092, forward nfe 17836, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 062, Runtime 15.173726, Loss 0.740776, forward nfe 18132, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 063, Runtime 15.648314, Loss 0.788880, forward nfe 18428, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 064, Runtime 16.071258, Loss 0.740111, forward nfe 18724, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 065, Runtime 16.188666, Loss 0.797388, forward nfe 19020, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 066, Runtime 16.501137, Loss 0.623429, forward nfe 19316, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 067, Runtime 17.220648, Loss 0.805909, forward nfe 19612, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 068, Runtime 17.030044, Loss 0.689971, forward nfe 19908, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 069, Runtime 16.836914, Loss 0.582424, forward nfe 20204, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 070, Runtime 17.160555, Loss 0.839784, forward nfe 20500, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 071, Runtime 17.116547, Loss 0.775182, forward nfe 20796, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 072, Runtime 17.212847, Loss 0.607001, forward nfe 21092, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 073, Runtime 17.507737, Loss 0.584812, forward nfe 21388, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 074, Runtime 17.410762, Loss 0.534400, forward nfe 21684, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 075, Runtime 17.950755, Loss 0.751699, forward nfe 21980, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 076, Runtime 18.004885, Loss 0.565023, forward nfe 22276, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 077, Runtime 17.864919, Loss 0.590594, forward nfe 22572, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 078, Runtime 17.548473, Loss 0.470891, forward nfe 22868, backward nfe 0, Train: 0.9071, Val: 0.7757, Test: 0.7726, Best time: 18.2948
Epoch: 079, Runtime 18.413547, Loss 0.570888, forward nfe 23164, backward nfe 0, Train: 0.9429, Val: 0.7831, Test: 0.7990, Best time: 43.0000
Epoch: 080, Runtime 13.709993, Loss 0.641176, forward nfe 23460, backward nfe 0, Train: 0.9429, Val: 0.7831, Test: 0.7990, Best time: 18.2948
Epoch: 081, Runtime 13.988107, Loss 0.513937, forward nfe 23756, backward nfe 0, Train: 0.9429, Val: 0.7831, Test: 0.7990, Best time: 18.2948
Epoch: 082, Runtime 14.204471, Loss 0.568393, forward nfe 24052, backward nfe 0, Train: 0.9429, Val: 0.7831, Test: 0.7990, Best time: 18.2948
Epoch: 083, Runtime 14.235405, Loss 0.676235, forward nfe 24348, backward nfe 0, Train: 0.9429, Val: 0.7831, Test: 0.7990, Best time: 18.2948
Epoch: 084, Runtime 15.057075, Loss 0.658579, forward nfe 24644, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 52.0000
Epoch: 085, Runtime 13.762396, Loss 0.639048, forward nfe 24940, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 086, Runtime 14.362965, Loss 0.658653, forward nfe 25236, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 087, Runtime 14.073830, Loss 0.477156, forward nfe 25532, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 088, Runtime 14.191752, Loss 0.579380, forward nfe 25828, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 089, Runtime 14.278305, Loss 0.546073, forward nfe 26124, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 090, Runtime 14.434782, Loss 0.625991, forward nfe 26420, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 091, Runtime 14.610281, Loss 0.574336, forward nfe 26716, backward nfe 0, Train: 0.9429, Val: 0.7846, Test: 0.7980, Best time: 18.2948
Epoch: 092, Runtime 15.297282, Loss 0.570309, forward nfe 27012, backward nfe 0, Train: 0.9786, Val: 0.7875, Test: 0.8102, Best time: 43.0000
Epoch: 093, Runtime 13.619684, Loss 0.610585, forward nfe 27308, backward nfe 0, Train: 0.9857, Val: 0.7897, Test: 0.8152, Best time: 54.8843
Epoch: 094, Runtime 13.048484, Loss 0.650152, forward nfe 27604, backward nfe 0, Train: 0.9857, Val: 0.7897, Test: 0.8152, Best time: 18.2948
Epoch: 095, Runtime 13.695085, Loss 0.588298, forward nfe 27900, backward nfe 0, Train: 0.9857, Val: 0.7897, Test: 0.8152, Best time: 18.2948
Epoch: 096, Runtime 13.500565, Loss 0.585734, forward nfe 28196, backward nfe 0, Train: 0.9857, Val: 0.7897, Test: 0.8152, Best time: 18.2948
Epoch: 097, Runtime 14.015898, Loss 0.526443, forward nfe 28492, backward nfe 0, Train: 0.9857, Val: 0.7897, Test: 0.8152, Best time: 18.2948
Epoch: 098, Runtime 13.657890, Loss 0.597395, forward nfe 28788, backward nfe 0, Train: 0.9857, Val: 0.7897, Test: 0.8152, Best time: 18.2948
Epoch: 099, Runtime 13.976792, Loss 0.613612, forward nfe 29084, backward nfe 0, Train: 0.9571, Val: 0.7912, Test: 0.8102, Best time: 41.0000
best val accuracy 0.791176 with test accuracy 0.810152 at epoch 99 and best time 41.000000
best_model.odeblock.t tensor([ 0., 41.])
Entropy Threshold: inf Test accuracy: 0.8060913705583757
Entropy Threshold: 2 Test accuracy: 0.8040609137055837
Entropy Threshold: 1.6 Test accuracy: 0.804902962206333
Entropy Threshold: 1.5 Test accuracy: 0.8105046343975283
Entropy Threshold: 1.4 Test accuracy: 0.8206465067778936
Entropy Threshold: 1.3 Test accuracy: 0.8186638388123012
Entropy Threshold: 1.2 Test accuracy: 0.8286334056399133
Entropy Threshold: 1.1 Test accuracy: 0.832967032967033
Entropy Threshold: 0.9 Test accuracy: 0.8518957345971564
Entropy Threshold: 0.8 Test accuracy: 0.8587360594795539
Entropy Threshold: 0.7 Test accuracy: 0.8748353096179183
Entropy Threshold: 0.6 Test accuracy: 0.8910891089108911
Entropy Threshold: 0.5 Test accuracy: 0.8992481203007519
Entropy Threshold: 0.4 Test accuracy: 0.9133986928104575
Entropy Threshold: 0.3 Test accuracy: 0.9267857142857143
Entropy Threshold: 0.2 Test accuracy: 0.9315068493150684
Entropy Threshold: 0.1 Test accuracy: 0.9413092550790068
