[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 9.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 11.322501, Loss 7.851783, forward nfe 76, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 4.0000
Epoch: 002, Runtime 10.675846, Loss 7.398673, forward nfe 372, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 003, Runtime 10.712519, Loss 6.612779, forward nfe 668, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 004, Runtime 10.865575, Loss 5.766741, forward nfe 964, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 005, Runtime 11.647752, Loss 4.682080, forward nfe 1260, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 006, Runtime 11.306624, Loss 4.956366, forward nfe 1556, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 007, Runtime 12.087120, Loss 4.399554, forward nfe 1852, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 008, Runtime 12.480938, Loss 4.185248, forward nfe 2148, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 009, Runtime 13.099714, Loss 4.344905, forward nfe 2444, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 010, Runtime 13.407841, Loss 3.643229, forward nfe 2740, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 011, Runtime 13.505914, Loss 3.398671, forward nfe 3036, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 012, Runtime 13.996287, Loss 3.103540, forward nfe 3332, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 013, Runtime 14.200860, Loss 3.116008, forward nfe 3628, backward nfe 0, Train: 0.4071, Val: 0.4669, Test: 0.4792, Best time: 18.2948
Epoch: 014, Runtime 14.742120, Loss 2.884884, forward nfe 3924, backward nfe 0, Train: 0.6286, Val: 0.4772, Test: 0.4944, Best time: 42.0000
Epoch: 015, Runtime 12.514351, Loss 2.950718, forward nfe 4220, backward nfe 0, Train: 0.7071, Val: 0.4985, Test: 0.5168, Best time: 21.0000
Epoch: 016, Runtime 12.577811, Loss 2.808819, forward nfe 4516, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 10.0000
Epoch: 017, Runtime 12.014418, Loss 2.734445, forward nfe 4812, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 018, Runtime 11.959992, Loss 2.430046, forward nfe 5108, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 019, Runtime 14.041601, Loss 2.271924, forward nfe 5404, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 020, Runtime 14.303016, Loss 2.232713, forward nfe 5700, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 021, Runtime 14.471385, Loss 2.389596, forward nfe 5996, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 022, Runtime 14.750818, Loss 2.067836, forward nfe 6292, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 023, Runtime 14.992818, Loss 2.194399, forward nfe 6588, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 024, Runtime 15.250999, Loss 2.019051, forward nfe 6884, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 025, Runtime 15.528646, Loss 2.255510, forward nfe 7180, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 026, Runtime 15.811813, Loss 2.033700, forward nfe 7476, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 027, Runtime 16.046935, Loss 2.080275, forward nfe 7772, backward nfe 0, Train: 0.7571, Val: 0.5559, Test: 0.5685, Best time: 18.2948
Epoch: 028, Runtime 16.416100, Loss 1.874867, forward nfe 8068, backward nfe 0, Train: 0.5857, Val: 0.5772, Test: 0.5756, Best time: 9.0000
Epoch: 029, Runtime 13.722026, Loss 2.005454, forward nfe 8364, backward nfe 0, Train: 0.5929, Val: 0.6176, Test: 0.6122, Best time: 7.0000
Epoch: 030, Runtime 13.709138, Loss 2.152575, forward nfe 8660, backward nfe 0, Train: 0.6000, Val: 0.6426, Test: 0.6376, Best time: 6.0000
Epoch: 031, Runtime 13.715050, Loss 2.010364, forward nfe 8956, backward nfe 0, Train: 0.6071, Val: 0.6574, Test: 0.6569, Best time: 6.0000
Epoch: 032, Runtime 13.693068, Loss 1.984793, forward nfe 9252, backward nfe 0, Train: 0.6357, Val: 0.6757, Test: 0.6802, Best time: 6.0000
Epoch: 033, Runtime 13.587527, Loss 1.828296, forward nfe 9548, backward nfe 0, Train: 0.6786, Val: 0.6882, Test: 0.6934, Best time: 7.0000
Epoch: 034, Runtime 13.535957, Loss 2.106921, forward nfe 9844, backward nfe 0, Train: 0.7214, Val: 0.7044, Test: 0.6944, Best time: 10.0000
Epoch: 035, Runtime 13.588469, Loss 1.797002, forward nfe 10140, backward nfe 0, Train: 0.7643, Val: 0.7088, Test: 0.7137, Best time: 9.0000
Epoch: 036, Runtime 13.453604, Loss 1.826955, forward nfe 10436, backward nfe 0, Train: 0.7643, Val: 0.7088, Test: 0.7137, Best time: 18.2948
Epoch: 037, Runtime 13.811059, Loss 1.856825, forward nfe 10732, backward nfe 0, Train: 0.7429, Val: 0.7096, Test: 0.7076, Best time: 12.0000
Epoch: 038, Runtime 13.590607, Loss 1.925116, forward nfe 11028, backward nfe 0, Train: 0.7429, Val: 0.7096, Test: 0.7076, Best time: 18.2948
Epoch: 039, Runtime 13.864228, Loss 1.967045, forward nfe 11324, backward nfe 0, Train: 0.7429, Val: 0.7096, Test: 0.7076, Best time: 18.2948
Epoch: 040, Runtime 14.085452, Loss 1.844786, forward nfe 11620, backward nfe 0, Train: 0.7714, Val: 0.7221, Test: 0.7421, Best time: 12.0000
Epoch: 041, Runtime 13.704826, Loss 1.850939, forward nfe 11916, backward nfe 0, Train: 0.7429, Val: 0.7287, Test: 0.7371, Best time: 18.0000
Epoch: 042, Runtime 13.797827, Loss 1.775691, forward nfe 12212, backward nfe 0, Train: 0.7714, Val: 0.7360, Test: 0.7421, Best time: 19.0000
Epoch: 043, Runtime 13.669204, Loss 1.738715, forward nfe 12508, backward nfe 0, Train: 0.7929, Val: 0.7419, Test: 0.7371, Best time: 16.0000
Epoch: 044, Runtime 13.604176, Loss 1.792805, forward nfe 12804, backward nfe 0, Train: 0.7786, Val: 0.7426, Test: 0.7279, Best time: 15.0000
Epoch: 045, Runtime 13.532061, Loss 1.845651, forward nfe 13100, backward nfe 0, Train: 0.7929, Val: 0.7456, Test: 0.7411, Best time: 11.0000
Epoch: 046, Runtime 13.454530, Loss 1.590288, forward nfe 13396, backward nfe 0, Train: 0.8071, Val: 0.7529, Test: 0.7594, Best time: 10.0000
Epoch: 047, Runtime 13.622836, Loss 1.839696, forward nfe 13692, backward nfe 0, Train: 0.8357, Val: 0.7581, Test: 0.7655, Best time: 10.0000
Epoch: 048, Runtime 13.895695, Loss 1.606636, forward nfe 13988, backward nfe 0, Train: 0.8786, Val: 0.7669, Test: 0.7766, Best time: 9.0000
Epoch: 049, Runtime 13.744771, Loss 1.740615, forward nfe 14284, backward nfe 0, Train: 0.8786, Val: 0.7669, Test: 0.7766, Best time: 18.2948
Epoch: 050, Runtime 13.972251, Loss 1.650947, forward nfe 14580, backward nfe 0, Train: 0.8786, Val: 0.7669, Test: 0.7766, Best time: 18.2948
Epoch: 051, Runtime 14.255348, Loss 1.637694, forward nfe 14876, backward nfe 0, Train: 0.8643, Val: 0.7728, Test: 0.7726, Best time: 13.0000
Epoch: 052, Runtime 13.738135, Loss 1.490680, forward nfe 15172, backward nfe 0, Train: 0.8929, Val: 0.7831, Test: 0.7919, Best time: 11.0000
Epoch: 053, Runtime 13.923683, Loss 1.738692, forward nfe 15468, backward nfe 0, Train: 0.9143, Val: 0.8044, Test: 0.8091, Best time: 12.0000
Epoch: 054, Runtime 13.823961, Loss 1.525524, forward nfe 15764, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 16.0000
Epoch: 055, Runtime 13.602962, Loss 1.426031, forward nfe 16060, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 056, Runtime 13.695256, Loss 1.487387, forward nfe 16356, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 057, Runtime 13.350181, Loss 1.543505, forward nfe 16652, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 058, Runtime 13.323638, Loss 1.431189, forward nfe 16948, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 059, Runtime 13.573277, Loss 1.280790, forward nfe 17244, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 060, Runtime 13.698034, Loss 1.502921, forward nfe 17540, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 061, Runtime 13.926825, Loss 1.554858, forward nfe 17836, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 062, Runtime 14.603122, Loss 1.436750, forward nfe 18132, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 063, Runtime 14.632235, Loss 1.444775, forward nfe 18428, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 064, Runtime 15.111495, Loss 1.534443, forward nfe 18724, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 065, Runtime 15.448046, Loss 1.339290, forward nfe 19020, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 066, Runtime 15.786071, Loss 1.251094, forward nfe 19316, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 067, Runtime 15.783462, Loss 1.305701, forward nfe 19612, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 068, Runtime 16.113970, Loss 1.239247, forward nfe 19908, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 069, Runtime 16.597963, Loss 1.189803, forward nfe 20204, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 070, Runtime 17.115665, Loss 1.257071, forward nfe 20500, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 071, Runtime 17.041456, Loss 1.139104, forward nfe 20796, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 072, Runtime 17.457457, Loss 1.048111, forward nfe 21092, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 073, Runtime 17.507822, Loss 1.287055, forward nfe 21388, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 074, Runtime 17.708267, Loss 1.061496, forward nfe 21684, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 075, Runtime 17.874120, Loss 1.018719, forward nfe 21980, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 076, Runtime 18.582737, Loss 1.200597, forward nfe 22276, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 077, Runtime 19.042948, Loss 0.941805, forward nfe 22572, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 078, Runtime 18.718241, Loss 1.243848, forward nfe 22868, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 079, Runtime 19.341107, Loss 1.024241, forward nfe 23164, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 080, Runtime 19.289973, Loss 1.207638, forward nfe 23460, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 081, Runtime 19.072470, Loss 1.178235, forward nfe 23756, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 082, Runtime 18.822063, Loss 1.163843, forward nfe 24052, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 083, Runtime 18.882324, Loss 1.183495, forward nfe 24348, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 084, Runtime 19.070977, Loss 1.147791, forward nfe 24644, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 085, Runtime 19.544886, Loss 1.034454, forward nfe 24940, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 086, Runtime 19.469566, Loss 1.164672, forward nfe 25236, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 087, Runtime 19.880097, Loss 0.829870, forward nfe 25532, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 088, Runtime 19.802601, Loss 1.084609, forward nfe 25828, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 089, Runtime 20.010396, Loss 1.191740, forward nfe 26124, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 090, Runtime 19.753307, Loss 0.955174, forward nfe 26420, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 091, Runtime 20.077177, Loss 0.966474, forward nfe 26716, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 092, Runtime 20.106146, Loss 1.061865, forward nfe 27012, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 093, Runtime 20.235068, Loss 1.208557, forward nfe 27308, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 094, Runtime 20.569522, Loss 0.915747, forward nfe 27604, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 095, Runtime 20.450286, Loss 0.822594, forward nfe 27900, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 096, Runtime 20.683853, Loss 0.912356, forward nfe 28196, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 097, Runtime 20.510190, Loss 0.874000, forward nfe 28492, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 098, Runtime 20.762431, Loss 1.120934, forward nfe 28788, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
Epoch: 099, Runtime 19.785044, Loss 0.863582, forward nfe 29084, backward nfe 0, Train: 0.9214, Val: 0.8132, Test: 0.8132, Best time: 18.2948
best val accuracy 0.813235 with test accuracy 0.813198 at epoch 54 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.7725888324873097
Entropy Threshold: 2 Test accuracy: 0.7685279187817259
Entropy Threshold: 1.6 Test accuracy: 0.8469945355191257
Entropy Threshold: 1.5 Test accuracy: 0.8443017656500803
Entropy Threshold: 1.4 Test accuracy: 0.8638941398865785
Entropy Threshold: 1.3 Test accuracy: 0.891832229580574
Entropy Threshold: 1.2 Test accuracy: 0.8984771573604061
Entropy Threshold: 1.1 Test accuracy: 0.9203539823008849
Entropy Threshold: 0.9 Test accuracy: 0.943089430894309
Entropy Threshold: 0.8 Test accuracy: 0.9458128078817734
Entropy Threshold: 0.7 Test accuracy: 0.9393939393939394
Entropy Threshold: 0.6 Test accuracy: 0.9436619718309859
Entropy Threshold: 0.5 Test accuracy: 0.9439252336448598
Entropy Threshold: 0.4 Test accuracy: 0.9545454545454546
Entropy Threshold: 0.3 Test accuracy: 0.9466666666666667
Entropy Threshold: 0.2 Test accuracy: 0.9423076923076923
Entropy Threshold: 0.1 Test accuracy: 0.9375
