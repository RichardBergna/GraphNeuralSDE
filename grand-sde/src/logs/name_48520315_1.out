[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 14.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 69.965851, Loss 19.764639, forward nfe 76, backward nfe 0, Train: 0.1429, Val: 0.1390, Test: 0.1371, Best time: 18.2948
Epoch: 002, Runtime 72.174822, Loss 75.643578, forward nfe 372, backward nfe 0, Train: 0.1429, Val: 0.1390, Test: 0.1371, Best time: 18.2948
Epoch: 003, Runtime 35.173105, Loss 5.203848, forward nfe 668, backward nfe 0, Train: 0.1429, Val: 0.1390, Test: 0.1371, Best time: 18.2948
Epoch: 004, Runtime 35.186627, Loss 5.318676, forward nfe 964, backward nfe 0, Train: 0.1071, Val: 0.1610, Test: 0.1513, Best time: 18.2948
Epoch: 005, Runtime 30.319580, Loss 4.679080, forward nfe 1260, backward nfe 0, Train: 0.1643, Val: 0.1640, Test: 0.1848, Best time: 18.2948
Epoch: 006, Runtime 29.652798, Loss 4.697814, forward nfe 1556, backward nfe 0, Train: 0.1357, Val: 0.1743, Test: 0.1848, Best time: 18.2948
Epoch: 007, Runtime 28.971216, Loss 4.623116, forward nfe 1852, backward nfe 0, Train: 0.1357, Val: 0.1743, Test: 0.1848, Best time: 18.2948
Epoch: 008, Runtime 28.813384, Loss 4.635309, forward nfe 2148, backward nfe 0, Train: 0.1357, Val: 0.1743, Test: 0.1848, Best time: 18.2948
Epoch: 009, Runtime 30.936505, Loss 4.785618, forward nfe 2444, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 010, Runtime 29.355267, Loss 4.527529, forward nfe 2740, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 011, Runtime 29.177558, Loss 4.568092, forward nfe 3036, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 012, Runtime 30.736761, Loss 4.728477, forward nfe 3332, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 013, Runtime 30.683523, Loss 4.314989, forward nfe 3628, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 014, Runtime 30.774395, Loss 4.641000, forward nfe 3924, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 015, Runtime 29.731244, Loss 4.581785, forward nfe 4220, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 016, Runtime 30.694277, Loss 4.702614, forward nfe 4516, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 017, Runtime 31.242662, Loss 4.084355, forward nfe 4812, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 018, Runtime 32.838908, Loss 4.157153, forward nfe 5108, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 019, Runtime 33.328877, Loss 3.961626, forward nfe 5404, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 020, Runtime 34.759563, Loss 4.097557, forward nfe 5700, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 021, Runtime 37.363181, Loss 4.281275, forward nfe 5996, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 022, Runtime 39.510899, Loss 4.013527, forward nfe 6292, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 023, Runtime 39.854645, Loss 3.743762, forward nfe 6588, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 024, Runtime 40.134670, Loss 3.719914, forward nfe 6884, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 025, Runtime 40.296636, Loss 3.971634, forward nfe 7180, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 026, Runtime 26.311023, Loss 3.965103, forward nfe 7476, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 027, Runtime 25.694811, Loss 4.115666, forward nfe 7772, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 028, Runtime 26.149105, Loss 3.890120, forward nfe 8068, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 029, Runtime 27.476504, Loss 3.660012, forward nfe 8364, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 030, Runtime 28.439598, Loss 3.637258, forward nfe 8660, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 031, Runtime 29.627730, Loss 3.847141, forward nfe 8956, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 032, Runtime 33.197029, Loss 4.021601, forward nfe 9252, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 033, Runtime 35.088446, Loss 3.500497, forward nfe 9548, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 034, Runtime 33.917008, Loss 3.551095, forward nfe 9844, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 035, Runtime 32.444941, Loss 3.514100, forward nfe 10140, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 036, Runtime 31.959146, Loss 3.989776, forward nfe 10436, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 037, Runtime 32.566661, Loss 3.544183, forward nfe 10732, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 038, Runtime 32.753131, Loss 3.820338, forward nfe 11028, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 039, Runtime 33.779651, Loss 3.550239, forward nfe 11324, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 040, Runtime 34.182032, Loss 3.687478, forward nfe 11620, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 041, Runtime 34.048419, Loss 3.288553, forward nfe 11916, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 042, Runtime 36.446161, Loss 3.724762, forward nfe 12212, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 043, Runtime 36.800904, Loss 3.461417, forward nfe 12508, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 044, Runtime 33.416698, Loss 3.835402, forward nfe 12804, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 045, Runtime 33.719838, Loss 3.766712, forward nfe 13100, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 046, Runtime 33.821965, Loss 3.431787, forward nfe 13396, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 047, Runtime 23.232409, Loss 3.943931, forward nfe 13692, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 048, Runtime 21.961355, Loss 3.356377, forward nfe 13988, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 049, Runtime 22.255331, Loss 3.729130, forward nfe 14284, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 050, Runtime 23.251033, Loss 3.573738, forward nfe 14580, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 051, Runtime 23.941823, Loss 3.721157, forward nfe 14876, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 052, Runtime 25.638463, Loss 3.502958, forward nfe 15172, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 053, Runtime 25.765449, Loss 3.348855, forward nfe 15468, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 054, Runtime 25.961353, Loss 3.621703, forward nfe 15764, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 055, Runtime 26.383700, Loss 3.321239, forward nfe 16060, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 056, Runtime 27.363170, Loss 3.617659, forward nfe 16356, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 057, Runtime 27.272026, Loss 3.544994, forward nfe 16652, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 058, Runtime 30.373218, Loss 3.461233, forward nfe 16948, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 059, Runtime 29.763949, Loss 3.420244, forward nfe 17244, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 060, Runtime 30.002588, Loss 3.120716, forward nfe 17540, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 061, Runtime 30.244112, Loss 3.334301, forward nfe 17836, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 062, Runtime 30.609366, Loss 3.580858, forward nfe 18132, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 063, Runtime 31.829389, Loss 3.116910, forward nfe 18428, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 064, Runtime 32.299385, Loss 3.457463, forward nfe 18724, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 065, Runtime 32.287023, Loss 3.481651, forward nfe 19020, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 066, Runtime 32.956603, Loss 3.394686, forward nfe 19316, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 067, Runtime 32.392660, Loss 3.216977, forward nfe 19612, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 068, Runtime 32.751654, Loss 3.435792, forward nfe 19908, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 069, Runtime 32.445835, Loss 2.988718, forward nfe 20204, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 070, Runtime 32.522570, Loss 3.392713, forward nfe 20500, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 071, Runtime 32.367709, Loss 3.276995, forward nfe 20796, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 072, Runtime 33.538193, Loss 3.208821, forward nfe 21092, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 073, Runtime 30.014356, Loss 3.286775, forward nfe 21388, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 074, Runtime 23.185109, Loss 3.187632, forward nfe 21684, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 075, Runtime 22.270893, Loss 2.990434, forward nfe 21980, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 076, Runtime 23.443195, Loss 3.224569, forward nfe 22276, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 077, Runtime 23.284669, Loss 3.062026, forward nfe 22572, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 078, Runtime 24.718410, Loss 3.338486, forward nfe 22868, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 079, Runtime 24.865929, Loss 2.994031, forward nfe 23164, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 080, Runtime 25.595387, Loss 3.214491, forward nfe 23460, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 081, Runtime 25.519897, Loss 3.268752, forward nfe 23756, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 082, Runtime 26.406162, Loss 3.097902, forward nfe 24052, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 083, Runtime 26.512642, Loss 3.357897, forward nfe 24348, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 084, Runtime 26.876815, Loss 3.302876, forward nfe 24644, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 085, Runtime 27.734270, Loss 3.164519, forward nfe 24940, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 086, Runtime 28.211199, Loss 3.102942, forward nfe 25236, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 087, Runtime 28.349343, Loss 3.306771, forward nfe 25532, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 088, Runtime 27.888006, Loss 3.158182, forward nfe 25828, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 089, Runtime 27.941959, Loss 3.330159, forward nfe 26124, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 090, Runtime 28.828679, Loss 3.348398, forward nfe 26420, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 091, Runtime 29.211870, Loss 3.282381, forward nfe 26716, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 092, Runtime 30.968691, Loss 3.008911, forward nfe 27012, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 093, Runtime 31.136782, Loss 2.811615, forward nfe 27308, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 094, Runtime 30.995466, Loss 3.082772, forward nfe 27604, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 095, Runtime 31.013024, Loss 3.386058, forward nfe 27900, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 096, Runtime 30.824127, Loss 3.169141, forward nfe 28196, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 097, Runtime 31.111814, Loss 2.864207, forward nfe 28492, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 098, Runtime 31.636025, Loss 3.067018, forward nfe 28788, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
Epoch: 099, Runtime 32.760351, Loss 3.109987, forward nfe 29084, backward nfe 0, Train: 0.1143, Val: 0.1824, Test: 0.1553, Best time: 18.2948
best val accuracy 0.182353 with test accuracy 0.155330 at epoch 9 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.16954314720812183
Entropy Threshold: 2 Test accuracy: 0.15228426395939088
Entropy Threshold: 1.6 Test accuracy: 0.17546174142480211
Entropy Threshold: 1.5 Test accuracy: 0.16752577319587628
Entropy Threshold: 1.4 Test accuracy: 0.07692307692307693
Entropy Threshold: 1.3 Test accuracy: 0.1891891891891892
Entropy Threshold: 1.2 Test accuracy: 0.1
Entropy Threshold: 1.1 Test accuracy: 0.5
Entropy Threshold: 0.9 Test accuracy: 0.0
Entropy Threshold: 0.8 Test accuracy: 0.0
Entropy Threshold: 0.7 Test accuracy: 0.0
Entropy Threshold: 0.6 Test accuracy: 0.5
Entropy Threshold: 0.5 Test accuracy: None
Entropy Threshold: 0.4 Test accuracy: None
Entropy Threshold: 0.3 Test accuracy: None
Entropy Threshold: 0.2 Test accuracy: None
Entropy Threshold: 0.1 Test accuracy: None
