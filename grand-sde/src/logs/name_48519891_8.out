[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 5.0
rtol 0.01
t1 1.0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 16.694695, Loss 4.522461, forward nfe 76, backward nfe 0, Train: 0.5429, Val: 0.3441, Test: 0.3462, Best time: 1.0000
Epoch: 002, Runtime 16.517915, Loss 4.434939, forward nfe 372, backward nfe 0, Train: 0.5429, Val: 0.4478, Test: 0.4345, Best time: 1.0000
Epoch: 003, Runtime 16.059854, Loss 3.371340, forward nfe 668, backward nfe 0, Train: 0.5429, Val: 0.4478, Test: 0.4345, Best time: 18.2948
Epoch: 004, Runtime 16.839322, Loss 3.390724, forward nfe 964, backward nfe 0, Train: 0.5571, Val: 0.4735, Test: 0.4406, Best time: 27.0000
Epoch: 005, Runtime 16.215650, Loss 3.240695, forward nfe 1260, backward nfe 0, Train: 0.6929, Val: 0.5706, Test: 0.5259, Best time: 29.0000
Epoch: 006, Runtime 15.997009, Loss 3.023403, forward nfe 1556, backward nfe 0, Train: 0.6929, Val: 0.5706, Test: 0.5259, Best time: 18.2948
Epoch: 007, Runtime 16.793562, Loss 2.757101, forward nfe 1852, backward nfe 0, Train: 0.7071, Val: 0.5750, Test: 0.5482, Best time: 40.0000
Epoch: 008, Runtime 15.958722, Loss 2.575559, forward nfe 2148, backward nfe 0, Train: 0.7143, Val: 0.5949, Test: 0.5716, Best time: 30.0000
Epoch: 009, Runtime 15.990909, Loss 2.391582, forward nfe 2444, backward nfe 0, Train: 0.7143, Val: 0.5949, Test: 0.5716, Best time: 18.2948
Epoch: 010, Runtime 16.080670, Loss 2.200173, forward nfe 2740, backward nfe 0, Train: 0.7143, Val: 0.5949, Test: 0.5716, Best time: 18.2948
Epoch: 011, Runtime 15.647177, Loss 2.199280, forward nfe 3036, backward nfe 0, Train: 0.7143, Val: 0.5949, Test: 0.5716, Best time: 18.2948
Epoch: 012, Runtime 16.161567, Loss 2.064244, forward nfe 3332, backward nfe 0, Train: 0.6786, Val: 0.6081, Test: 0.5838, Best time: 25.0000
Epoch: 013, Runtime 15.368371, Loss 2.033266, forward nfe 3628, backward nfe 0, Train: 0.7071, Val: 0.6235, Test: 0.5909, Best time: 21.0000
Epoch: 014, Runtime 15.442293, Loss 1.895128, forward nfe 3924, backward nfe 0, Train: 0.7357, Val: 0.6338, Test: 0.6081, Best time: 13.0000
Epoch: 015, Runtime 15.467380, Loss 1.914489, forward nfe 4220, backward nfe 0, Train: 0.7429, Val: 0.6449, Test: 0.6234, Best time: 14.0000
Epoch: 016, Runtime 15.284975, Loss 1.775969, forward nfe 4516, backward nfe 0, Train: 0.7786, Val: 0.6559, Test: 0.6406, Best time: 11.0000
Epoch: 017, Runtime 15.263347, Loss 1.825219, forward nfe 4812, backward nfe 0, Train: 0.8000, Val: 0.6801, Test: 0.6640, Best time: 9.0000
Epoch: 018, Runtime 15.262188, Loss 1.834269, forward nfe 5108, backward nfe 0, Train: 0.8286, Val: 0.7140, Test: 0.6954, Best time: 13.0000
Epoch: 019, Runtime 15.342113, Loss 1.808815, forward nfe 5404, backward nfe 0, Train: 0.8643, Val: 0.7625, Test: 0.7452, Best time: 26.0000
Epoch: 020, Runtime 15.216040, Loss 1.618769, forward nfe 5700, backward nfe 0, Train: 0.9000, Val: 0.7875, Test: 0.7817, Best time: 26.0000
Epoch: 021, Runtime 15.081501, Loss 1.559448, forward nfe 5996, backward nfe 0, Train: 0.9071, Val: 0.8096, Test: 0.7980, Best time: 36.0000
Epoch: 022, Runtime 15.161709, Loss 1.531892, forward nfe 6292, backward nfe 0, Train: 0.9214, Val: 0.8118, Test: 0.8030, Best time: 27.0000
Epoch: 023, Runtime 15.159152, Loss 1.488450, forward nfe 6588, backward nfe 0, Train: 0.9071, Val: 0.8125, Test: 0.7980, Best time: 32.0000
Epoch: 024, Runtime 15.464339, Loss 1.524750, forward nfe 6884, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 38.0000
Epoch: 025, Runtime 15.486088, Loss 1.487571, forward nfe 7180, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 026, Runtime 16.045942, Loss 1.486464, forward nfe 7476, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 027, Runtime 15.814120, Loss 1.417922, forward nfe 7772, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 028, Runtime 16.353359, Loss 1.467232, forward nfe 8068, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 029, Runtime 16.134006, Loss 1.362085, forward nfe 8364, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 030, Runtime 16.704922, Loss 1.194926, forward nfe 8660, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 031, Runtime 17.345914, Loss 1.099263, forward nfe 8956, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 032, Runtime 17.769572, Loss 1.080541, forward nfe 9252, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 033, Runtime 19.040286, Loss 1.162763, forward nfe 9548, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 034, Runtime 18.305689, Loss 1.237941, forward nfe 9844, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 035, Runtime 19.304531, Loss 1.193034, forward nfe 10140, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 036, Runtime 18.083633, Loss 1.141506, forward nfe 10436, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 037, Runtime 18.936499, Loss 1.129618, forward nfe 10732, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 038, Runtime 18.265493, Loss 1.045167, forward nfe 11028, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 039, Runtime 18.626000, Loss 1.040917, forward nfe 11324, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 040, Runtime 17.633794, Loss 1.101861, forward nfe 11620, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 041, Runtime 17.955244, Loss 1.009234, forward nfe 11916, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 042, Runtime 17.456786, Loss 0.971090, forward nfe 12212, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 043, Runtime 18.028819, Loss 0.880166, forward nfe 12508, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 044, Runtime 17.579253, Loss 0.945550, forward nfe 12804, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 045, Runtime 18.300313, Loss 1.026031, forward nfe 13100, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 046, Runtime 17.062029, Loss 0.985236, forward nfe 13396, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 047, Runtime 17.713120, Loss 0.826921, forward nfe 13692, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 048, Runtime 16.806083, Loss 0.691758, forward nfe 13988, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 049, Runtime 17.095776, Loss 0.863459, forward nfe 14284, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 050, Runtime 16.783543, Loss 0.937852, forward nfe 14580, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 051, Runtime 16.645526, Loss 0.926458, forward nfe 14876, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 052, Runtime 15.686543, Loss 0.804849, forward nfe 15172, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 053, Runtime 16.262609, Loss 0.776492, forward nfe 15468, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 054, Runtime 15.835137, Loss 0.761690, forward nfe 15764, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 055, Runtime 16.244939, Loss 0.867361, forward nfe 16060, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 056, Runtime 15.874913, Loss 0.665865, forward nfe 16356, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 057, Runtime 16.367153, Loss 0.756510, forward nfe 16652, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 058, Runtime 15.699359, Loss 0.948591, forward nfe 16948, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 059, Runtime 16.286543, Loss 0.687052, forward nfe 17244, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 060, Runtime 15.836808, Loss 0.854395, forward nfe 17540, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 061, Runtime 16.208405, Loss 0.820336, forward nfe 17836, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 062, Runtime 15.260894, Loss 0.909388, forward nfe 18132, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 063, Runtime 15.309684, Loss 0.931827, forward nfe 18428, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 064, Runtime 14.957862, Loss 0.734661, forward nfe 18724, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 065, Runtime 15.550895, Loss 0.716568, forward nfe 19020, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 066, Runtime 15.441299, Loss 0.759147, forward nfe 19316, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 067, Runtime 15.807468, Loss 0.775014, forward nfe 19612, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 068, Runtime 15.028608, Loss 0.799793, forward nfe 19908, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 069, Runtime 15.493014, Loss 0.768446, forward nfe 20204, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 070, Runtime 14.909938, Loss 0.750669, forward nfe 20500, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 071, Runtime 15.334872, Loss 0.644933, forward nfe 20796, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 072, Runtime 14.968237, Loss 0.686141, forward nfe 21092, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 073, Runtime 15.160404, Loss 0.661756, forward nfe 21388, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 074, Runtime 14.702212, Loss 0.561929, forward nfe 21684, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 075, Runtime 15.185001, Loss 0.754869, forward nfe 21980, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 076, Runtime 14.731936, Loss 0.710456, forward nfe 22276, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 077, Runtime 15.232252, Loss 0.639869, forward nfe 22572, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 078, Runtime 14.510496, Loss 0.677116, forward nfe 22868, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 079, Runtime 14.841232, Loss 0.845947, forward nfe 23164, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 080, Runtime 14.296822, Loss 0.727963, forward nfe 23460, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 081, Runtime 14.761805, Loss 0.669609, forward nfe 23756, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 082, Runtime 14.381834, Loss 0.675828, forward nfe 24052, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 083, Runtime 14.652499, Loss 0.647335, forward nfe 24348, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 084, Runtime 14.239003, Loss 0.684709, forward nfe 24644, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 085, Runtime 14.626308, Loss 0.862378, forward nfe 24940, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 086, Runtime 14.005439, Loss 0.594081, forward nfe 25236, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 087, Runtime 14.614092, Loss 0.530203, forward nfe 25532, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 088, Runtime 14.078701, Loss 0.677398, forward nfe 25828, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 089, Runtime 14.709730, Loss 0.523469, forward nfe 26124, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 090, Runtime 14.237185, Loss 0.577969, forward nfe 26420, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 091, Runtime 14.845293, Loss 0.611703, forward nfe 26716, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 092, Runtime 14.342764, Loss 0.610721, forward nfe 27012, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 093, Runtime 14.508593, Loss 0.651542, forward nfe 27308, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 094, Runtime 14.240793, Loss 0.609994, forward nfe 27604, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 095, Runtime 14.641161, Loss 0.657106, forward nfe 27900, backward nfe 0, Train: 0.9000, Val: 0.8140, Test: 0.7959, Best time: 18.2948
Epoch: 096, Runtime 14.380272, Loss 0.743636, forward nfe 28196, backward nfe 0, Train: 0.9071, Val: 0.8199, Test: 0.8030, Best time: 43.0000
Epoch: 097, Runtime 13.001781, Loss 0.636982, forward nfe 28492, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8132, Best time: 46.0000
Epoch: 098, Runtime 13.008263, Loss 0.726344, forward nfe 28788, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8132, Best time: 18.2948
Epoch: 099, Runtime 13.131416, Loss 0.558992, forward nfe 29084, backward nfe 0, Train: 0.9214, Val: 0.8265, Test: 0.8132, Best time: 18.2948
best val accuracy 0.826471 with test accuracy 0.813198 at epoch 97 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8101522842639594
Entropy Threshold: 2 Test accuracy: 0.7969543147208121
Entropy Threshold: 1.6 Test accuracy: 0.8132780082987552
Entropy Threshold: 1.5 Test accuracy: 0.8264984227129337
Entropy Threshold: 1.4 Test accuracy: 0.8317152103559871
Entropy Threshold: 1.3 Test accuracy: 0.8298800436205016
Entropy Threshold: 1.2 Test accuracy: 0.8488636363636364
Entropy Threshold: 1.1 Test accuracy: 0.8520710059171598
Entropy Threshold: 0.9 Test accuracy: 0.8784810126582279
Entropy Threshold: 0.8 Test accuracy: 0.8926174496644296
Entropy Threshold: 0.7 Test accuracy: 0.896551724137931
Entropy Threshold: 0.6 Test accuracy: 0.9162995594713657
Entropy Threshold: 0.5 Test accuracy: 0.9298245614035088
Entropy Threshold: 0.4 Test accuracy: 0.9362416107382551
Entropy Threshold: 0.3 Test accuracy: 0.945054945054945
Entropy Threshold: 0.2 Test accuracy: 0.9510763209393346
Entropy Threshold: 0.1 Test accuracy: 0.9584295612009238
