[KeOps] Warning : cuda was detected, but driver API could not be initialized. Switching to cpu only.
Folder already exists: results/cora
experiment: 0
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
sigma 1.0
rtol 0.01
t1 0.1
Dataset size (num_nodes): 2485, Intended development set size (num_development): 1500
Dataset size (num_nodes): 2485, Actual development set size (num_development): 1500
rations: train 140, val 1360, test 985
GNSDEEarly
qy0_mean
torch.Size([1, 80])
qy0_logvar
torch.Size([1, 80])
m1.weight
torch.Size([80, 1433])
m1.bias
torch.Size([80])
m2.weight
torch.Size([7, 80])
m2.bias
torch.Size([7])
gnsde_drift_net.0.layer.weight
torch.Size([80, 81])
gnsde_drift_net.0.layer.bias
torch.Size([80])
gnsde_drift_net.1.layer.weight
torch.Size([80, 80])
gnsde_drift_net.1.layer.bias
torch.Size([80])
odeblock.odefunc.alpha_train
torch.Size([])
odeblock.odefunc.beta_train
torch.Size([])
odeblock.odefunc.alpha_sc
torch.Size([1])
odeblock.odefunc.beta_sc
torch.Size([1])
odeblock.odefunc.w
torch.Size([80, 80])
odeblock.odefunc.d
torch.Size([80])
odeblock.reg_odefunc.odefunc.alpha_train
torch.Size([])
odeblock.reg_odefunc.odefunc.beta_train
torch.Size([])
odeblock.reg_odefunc.odefunc.alpha_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.beta_sc
torch.Size([1])
odeblock.reg_odefunc.odefunc.w
torch.Size([80, 80])
odeblock.reg_odefunc.odefunc.d
torch.Size([80])
Epoch: 001, Runtime 14.606941, Loss 1.953284, forward nfe 76, backward nfe 0, Train: 0.7643, Val: 0.6265, Test: 0.6234, Best time: 3.0000
Epoch: 002, Runtime 14.103026, Loss 1.911547, forward nfe 372, backward nfe 0, Train: 0.7643, Val: 0.6265, Test: 0.6234, Best time: 18.2948
Epoch: 003, Runtime 14.256409, Loss 1.823712, forward nfe 668, backward nfe 0, Train: 0.7643, Val: 0.6265, Test: 0.6234, Best time: 18.2948
Epoch: 004, Runtime 15.148483, Loss 1.646107, forward nfe 964, backward nfe 0, Train: 0.7857, Val: 0.6294, Test: 0.6467, Best time: 5.0000
Epoch: 005, Runtime 14.436114, Loss 1.451074, forward nfe 1260, backward nfe 0, Train: 0.8214, Val: 0.7059, Test: 0.7036, Best time: 4.0000
Epoch: 006, Runtime 14.484765, Loss 1.167564, forward nfe 1556, backward nfe 0, Train: 0.8643, Val: 0.7787, Test: 0.7827, Best time: 5.0000
Epoch: 007, Runtime 14.392757, Loss 0.961091, forward nfe 1852, backward nfe 0, Train: 0.9071, Val: 0.8176, Test: 0.8213, Best time: 5.0000
Epoch: 008, Runtime 14.262993, Loss 0.701688, forward nfe 2148, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8315, Best time: 8.0000
Epoch: 009, Runtime 13.957536, Loss 0.556287, forward nfe 2444, backward nfe 0, Train: 0.9357, Val: 0.8279, Test: 0.8315, Best time: 18.2948
Epoch: 010, Runtime 14.445467, Loss 0.432233, forward nfe 2740, backward nfe 0, Train: 0.9357, Val: 0.8368, Test: 0.8508, Best time: 11.0000
Epoch: 011, Runtime 14.070066, Loss 0.375409, forward nfe 3036, backward nfe 0, Train: 0.9286, Val: 0.8375, Test: 0.8497, Best time: 9.0000
Epoch: 012, Runtime 14.204965, Loss 0.265527, forward nfe 3332, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8457, Best time: 12.0000
Epoch: 013, Runtime 13.839712, Loss 0.245553, forward nfe 3628, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8457, Best time: 18.2948
Epoch: 014, Runtime 14.283383, Loss 0.247617, forward nfe 3924, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8457, Best time: 18.2948
Epoch: 015, Runtime 14.682148, Loss 0.239979, forward nfe 4220, backward nfe 0, Train: 0.9286, Val: 0.8404, Test: 0.8457, Best time: 18.2948
Epoch: 016, Runtime 14.849694, Loss 0.190938, forward nfe 4516, backward nfe 0, Train: 0.9929, Val: 0.8441, Test: 0.8437, Best time: 40.0000
Epoch: 017, Runtime 13.902773, Loss 0.246572, forward nfe 4812, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8447, Best time: 26.0000
Epoch: 018, Runtime 13.757642, Loss 0.232214, forward nfe 5108, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8447, Best time: 18.2948
Epoch: 019, Runtime 14.245364, Loss 0.233341, forward nfe 5404, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8447, Best time: 18.2948
Epoch: 020, Runtime 14.719665, Loss 0.247160, forward nfe 5700, backward nfe 0, Train: 0.9714, Val: 0.8456, Test: 0.8447, Best time: 18.2948
Epoch: 021, Runtime 14.348651, Loss 0.245672, forward nfe 5996, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8365, Best time: 27.0000
Epoch: 022, Runtime 13.727378, Loss 0.229092, forward nfe 6292, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8365, Best time: 18.2948
Epoch: 023, Runtime 14.114404, Loss 0.243950, forward nfe 6588, backward nfe 0, Train: 0.9857, Val: 0.8463, Test: 0.8365, Best time: 18.2948
Epoch: 024, Runtime 14.713875, Loss 0.218428, forward nfe 6884, backward nfe 0, Train: 0.9714, Val: 0.8507, Test: 0.8467, Best time: 35.0000
Epoch: 025, Runtime 13.628388, Loss 0.224425, forward nfe 7180, backward nfe 0, Train: 0.9714, Val: 0.8507, Test: 0.8467, Best time: 18.2948
Epoch: 026, Runtime 14.110299, Loss 0.160260, forward nfe 7476, backward nfe 0, Train: 0.9714, Val: 0.8507, Test: 0.8467, Best time: 18.2948
Epoch: 027, Runtime 14.562031, Loss 0.217005, forward nfe 7772, backward nfe 0, Train: 0.9714, Val: 0.8507, Test: 0.8467, Best time: 18.2948
Epoch: 028, Runtime 13.974027, Loss 0.183400, forward nfe 8068, backward nfe 0, Train: 0.9714, Val: 0.8507, Test: 0.8467, Best time: 18.2948
Epoch: 029, Runtime 14.228329, Loss 0.203552, forward nfe 8364, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8589, Best time: 25.0000
Epoch: 030, Runtime 13.587408, Loss 0.210563, forward nfe 8660, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8589, Best time: 18.2948
Epoch: 031, Runtime 14.110101, Loss 0.162600, forward nfe 8956, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8589, Best time: 18.2948
Epoch: 032, Runtime 14.498641, Loss 0.130038, forward nfe 9252, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8589, Best time: 18.2948
Epoch: 033, Runtime 13.956853, Loss 0.182452, forward nfe 9548, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8589, Best time: 18.2948
Epoch: 034, Runtime 13.915233, Loss 0.149134, forward nfe 9844, backward nfe 0, Train: 0.9714, Val: 0.8515, Test: 0.8589, Best time: 18.2948
Epoch: 035, Runtime 14.495525, Loss 0.147260, forward nfe 10140, backward nfe 0, Train: 0.9714, Val: 0.8537, Test: 0.8477, Best time: 36.0000
Epoch: 036, Runtime 13.576042, Loss 0.164333, forward nfe 10436, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 32.0000
Epoch: 037, Runtime 13.345108, Loss 0.191384, forward nfe 10732, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 038, Runtime 13.777439, Loss 0.188740, forward nfe 11028, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 039, Runtime 14.298818, Loss 0.168084, forward nfe 11324, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 040, Runtime 13.769248, Loss 0.155451, forward nfe 11620, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 041, Runtime 13.877726, Loss 0.152433, forward nfe 11916, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 042, Runtime 14.254617, Loss 0.167752, forward nfe 12212, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 043, Runtime 14.823711, Loss 0.176880, forward nfe 12508, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 044, Runtime 14.236834, Loss 0.187872, forward nfe 12804, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 045, Runtime 14.326375, Loss 0.151574, forward nfe 13100, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 046, Runtime 14.631674, Loss 0.141406, forward nfe 13396, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 047, Runtime 14.661183, Loss 0.129123, forward nfe 13692, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 048, Runtime 14.512737, Loss 0.167524, forward nfe 13988, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 049, Runtime 14.596567, Loss 0.154694, forward nfe 14284, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 050, Runtime 14.664883, Loss 0.137230, forward nfe 14580, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 051, Runtime 15.009485, Loss 0.156110, forward nfe 14876, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 052, Runtime 14.821094, Loss 0.196741, forward nfe 15172, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 053, Runtime 14.847168, Loss 0.124320, forward nfe 15468, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 054, Runtime 15.174428, Loss 0.163770, forward nfe 15764, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 055, Runtime 15.509783, Loss 0.124527, forward nfe 16060, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 056, Runtime 15.349540, Loss 0.147214, forward nfe 16356, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 057, Runtime 15.248772, Loss 0.139204, forward nfe 16652, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 058, Runtime 15.575140, Loss 0.138708, forward nfe 16948, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 059, Runtime 15.432257, Loss 0.122577, forward nfe 17244, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 060, Runtime 15.307526, Loss 0.133498, forward nfe 17540, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 061, Runtime 15.414792, Loss 0.158964, forward nfe 17836, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 062, Runtime 15.439612, Loss 0.133237, forward nfe 18132, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 063, Runtime 15.620298, Loss 0.119223, forward nfe 18428, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 064, Runtime 15.479788, Loss 0.132187, forward nfe 18724, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 065, Runtime 15.368487, Loss 0.110822, forward nfe 19020, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 066, Runtime 15.266231, Loss 0.103536, forward nfe 19316, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 067, Runtime 15.465898, Loss 0.131136, forward nfe 19612, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 068, Runtime 15.733280, Loss 0.104983, forward nfe 19908, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 069, Runtime 15.685255, Loss 0.167963, forward nfe 20204, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 070, Runtime 15.648582, Loss 0.126432, forward nfe 20500, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 071, Runtime 15.615787, Loss 0.110117, forward nfe 20796, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 072, Runtime 15.721325, Loss 0.155939, forward nfe 21092, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 073, Runtime 15.591303, Loss 0.142122, forward nfe 21388, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 074, Runtime 15.689935, Loss 0.138471, forward nfe 21684, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 075, Runtime 15.673683, Loss 0.177497, forward nfe 21980, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 076, Runtime 15.897054, Loss 0.125123, forward nfe 22276, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 077, Runtime 15.754120, Loss 0.133979, forward nfe 22572, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 078, Runtime 15.687152, Loss 0.120005, forward nfe 22868, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 079, Runtime 15.854658, Loss 0.115209, forward nfe 23164, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 080, Runtime 15.951976, Loss 0.132013, forward nfe 23460, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 081, Runtime 15.801120, Loss 0.109961, forward nfe 23756, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 082, Runtime 15.930200, Loss 0.106464, forward nfe 24052, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 083, Runtime 15.961589, Loss 0.135265, forward nfe 24348, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 084, Runtime 15.936471, Loss 0.119718, forward nfe 24644, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 085, Runtime 15.984509, Loss 0.118756, forward nfe 24940, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 086, Runtime 16.095735, Loss 0.100564, forward nfe 25236, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 087, Runtime 15.168387, Loss 0.105673, forward nfe 25532, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 088, Runtime 14.599698, Loss 0.122080, forward nfe 25828, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 089, Runtime 11.469452, Loss 0.124099, forward nfe 26124, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 090, Runtime 11.397918, Loss 0.080097, forward nfe 26420, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 091, Runtime 11.435230, Loss 0.132555, forward nfe 26716, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 092, Runtime 11.529920, Loss 0.092310, forward nfe 27012, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 093, Runtime 11.364394, Loss 0.131513, forward nfe 27308, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 094, Runtime 11.465450, Loss 0.078633, forward nfe 27604, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 095, Runtime 11.631959, Loss 0.106921, forward nfe 27900, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 096, Runtime 11.581691, Loss 0.095189, forward nfe 28196, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 097, Runtime 11.465681, Loss 0.087337, forward nfe 28492, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 098, Runtime 11.537367, Loss 0.112642, forward nfe 28788, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
Epoch: 099, Runtime 11.700807, Loss 0.113517, forward nfe 29084, backward nfe 0, Train: 0.9786, Val: 0.8551, Test: 0.8528, Best time: 18.2948
best val accuracy 0.855147 with test accuracy 0.852792 at epoch 36 and best time 18.294754
best_model.odeblock.t tensor([ 0.0000, 18.2948])
Entropy Threshold: inf Test accuracy: 0.8507614213197969
Entropy Threshold: 2 Test accuracy: 0.8538071065989847
Entropy Threshold: 1.6 Test accuracy: 0.8526422764227642
Entropy Threshold: 1.5 Test accuracy: 0.8540816326530613
Entropy Threshold: 1.4 Test accuracy: 0.8548057259713702
Entropy Threshold: 1.3 Test accuracy: 0.8564102564102564
Entropy Threshold: 1.2 Test accuracy: 0.856404958677686
Entropy Threshold: 1.1 Test accuracy: 0.8613138686131386
Entropy Threshold: 0.9 Test accuracy: 0.8744635193133047
Entropy Threshold: 0.8 Test accuracy: 0.8819672131147541
Entropy Threshold: 0.7 Test accuracy: 0.8887652947719689
Entropy Threshold: 0.6 Test accuracy: 0.9006849315068494
Entropy Threshold: 0.5 Test accuracy: 0.9084588644264194
Entropy Threshold: 0.4 Test accuracy: 0.9217809867629362
Entropy Threshold: 0.3 Test accuracy: 0.9353233830845771
Entropy Threshold: 0.2 Test accuracy: 0.9412532637075718
Entropy Threshold: 0.1 Test accuracy: 0.9495798319327731
